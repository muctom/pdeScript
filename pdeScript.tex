% chktex-file 11
% chktex-file 35
% chktex-file 2
% chktex-file 10
% chktex-file 40

\documentclass{report}

\usepackage{a4}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath, amssymb, mathtools, esint, bbold, mathabx}
\usepackage{graphicx}
\usepackage{color}
\usepackage{datetime}
\usepackage[hidelinks]{hyperref}
\usepackage{enumitem}
\usepackage{stmaryrd}

\setlength{\parindent}{0em} 

\usepackage{amsthm}
\newtheoremstyle{tommy}% ⟨name ⟩
{15pt}% ⟨Space above ⟩1
{15pt}% ⟨Space below ⟩1
{\normalfont}% ⟨Body font ⟩
{}% ⟨Indent amount ⟩2
{\bfseries}% ⟨Theorem head font⟩
{}% ⟨Punctuation after theorem head ⟩
{0.7em}% ⟨Space after theorem head ⟩3
{}% ⟨Theorem head spec (can be left empty, meaning ‘normal’)⟩

\theoremstyle{tommy}
\newtheorem{defn}{Definition}
\newtheorem{thm}[defn]{Theorem}
\newtheorem{lem}[defn]{Lemma}
\newtheorem{nota}[defn]{Notation}
\newtheorem{cor}[defn]{Corrolary}
\newtheorem{prop}[defn]{Proposition}
\newtheorem{eg}[defn]{Example}
\newtheorem{rem}[defn]{Remark}
\newtheorem{ex}[defn]{Exercise}

% Counter
\usepackage{chngcntr}
\counterwithin{defn}{chapter}

\renewcommand\div{\operatorname{div}}
\newcommand{\dist}{\operatorname{dist}}
\newcommand{\four}{\mathcal{F}}
\newcommand{\supp}{\operatorname{supp}}
\newcommand{\sgn}{\operatorname{sgn}}
\newcommand{\Rd}{\mathbb{R}^d}
\renewcommand\qedsymbol{\(\blacksquare\)}

\title{Partial Differerential Equations \\ Thành Nam Phan \\ Winter Semester 2021/2022}
\author{Lecture notes \TeX{}ed by Thomas Eingartner}
\date{\today, \currenttime}

\begin{document}

  \maketitle
  \tableofcontents
  \newpage
  Please note that I write this lecture notes for my personal use. I may write things differently than presented in the lecture. This script also contains solutions for exercises (which may be wrong). Of course, I don't push them to GitHub while the exercises can be handed in.
  \newpage

  \chapter{Introduction}

  A differential equation is an equation of a function and its derivatives. 

  \begin{eg}[Linear ODE]
    Let \(f: \mathbb{R} \to \mathbb{R}\),
    \begin{align*}
      \begin{cases}
        f(t) = a f(t) \text{ for all } t \ge 0, a \in \mathbb{R} \\
        f(0) = a_0
      \end{cases}
    \end{align*}
    is a linear ODE (Ordinary differential equation). The solution is: \(f(t) = a_0 e^{at}\) for all \(t \ge 0\).
  \end{eg}

  \begin{eg} (Non-Linear ODE) \(f: \mathbb{R} \to \mathbb{R}\)
    \begin{align*}
      \begin{cases}
        f'(t) = 1 + f^2(t) \\
        f(0) = 1
      \end{cases}
    \end{align*}
    Lets consider \(f(t) = \tan(t) = \frac{\sin(t)}{\cos(t)}\). Then we have \[f'(t) = \frac{1}{\cos(t)} = 1 + \tan^2(t) = 1 + f^2(t),\] but this solution only is \emph{good} in \((- \pi, \pi)\). It's a problem to extend this to \(\mathbb{R} \to \mathbb{R}\).
  \end{eg}

  A PDE (Partial Differential Equation) is an equation of a function of 2 or more variables and its derivatives.

  \begin{rem}
    Recall for \( \Omega \subseteq \mathbb{R}^d\) open and \(f: \Omega \to \{\mathbb{R}, \mathbb{C}\}\) the notation of partial derivatives:
    \begin{itemize}
      \item \(\partial_{x_i} f(x) = \lim_{h \to 0} \frac{f(x + he_i) - f(x)}{h}, \text{where } e_i = (0, 0, \dots, 1, \dots, 0, 0) \in \mathbb{R}^d\)
      \item \(D^\alpha f(x) = \partial_{x_1}^{\alpha_1} \cdots \partial_{x_d}^{\alpha_d} f(x), \text{where } \alpha \in \mathbb{N}^d\)
      \item \(Df = \nabla f = (\partial{x_1}, \ldots, \partial_{x_d})\)
      \item \(\Delta f = \partial_{x_1}^2 + \cdots + \partial^2_{x_d} f\)
      \item \(D^k f = (D^\alpha f)_{|\alpha| = k},  \text{where } |\alpha| = \sum_{i=1}^d |\alpha_i|\)
      \item \(D^2 f = (\partial_{x_i} \partial_{x_j} f)_{1 \le i, j \le d}\)
    \end{itemize}
  \end{rem}

  \begin{defn}
    Given a function \( F \). Then the equation of the form 
    \begin{align*}
      F(D^k u(x), D^{k-1} u(x), \dots, Du(x), u(x), x) = 0 
    \end{align*}
    with the unknown function \(u:\ \Omega \subseteq \mathbb{R}^d \longrightarrow \mathbb{R}\) is called a \emph{PDE of order \(k\)}.
    \begin{itemize}
      \item Equations \(\sum_d a_\alpha(x) D^\alpha u(x) = 0\), where \(a_\alpha\) and \(u\) are unknown functions are called \emph{Linear PDEs}. 
      \item Equations \(\sum_{|\alpha| = k} a_\alpha(x) D^\alpha u(x) + F(D^{k-1}u, D^{k-2}u, \dots, Du, u, x) = 0\) are called \emph{semi-linear PDEs}.
    \end{itemize}
  \end{defn}

  Goals: For \emph{solving a PDE} we want to
  \begin{itemize}
    \item Find an explizit solution! This is in many cases impossible.
    \item Prove a \emph{well-posted theory} (existence of solutions, uniqueness of solutions, continuous dependence of solutions on the data)
  \end{itemize}

  We have two notations of solutions:
  \begin{enumerate}
    \item Classical solution: The solution is continuous differentiable (e.g. \( \Delta u = f  \leadsto u \in C^2  \))
    \item Weak Solutions: The solution is not smooth/continuous
  \end{enumerate}

  \begin{defn} (Spaces of continous and differentiable functions)
    Let \(\Omega \subseteq R^d\) be open
    \begin{align*}
      C(\Omega) &= \left\{ f: \ \Omega \to \mathbb{R} \mid f \text{ continuous} \right\} \\
      C^k(\Omega) &= \left\{ f: \ \Omega \to \mathbb{R} \mid D^\alpha f \text{ is continuous for all } |\alpha| \le k \right\}
    \end{align*}
  \end{defn}

  Classical solution of a PDE of order \(k \leadsto C^k\) solutions!
  \begin{align*}
    L^p(\Omega) = \left\{ f: \ \Omega \to \mathbb{R} \text{ lebesgue measurable} \mid \int_\Omega |f|^p d\lambda < \infty, 1 \le p < \infty \right\}
  \end{align*}

  Sobolev Space:
  \begin{align*}
    W^{k,p}(\Omega)= \left \{ f \in L^p(\Omega) \mid \forall \alpha \in \mathbb{N}^n \text{ with } |\alpha| \leq k: D^{\alpha}f \in L^p(\Omega) \text{exists}  \right \}
  \end{align*}

  In this course we will investigate
  \begin{itemize}
    \item Laplace / Poisson Equation: \(-\Delta u = f\)
    \item Heat Equation: \(\partial_t u - \Delta u = f\)
    \item Wave Equation: \(\partial_t^2 - \Delta u = f\)
    \item Schrödinger Equation: \(i \partial_t u - \Delta u = f\)
  \end{itemize}


  \chapter{Laplace / Poisson Equation}

  \section{Laplace Equation}
  \(- \Delta u = 0\) (Laplace) or \(-\Delta u = f(x)\) (Poisson).

  \begin{defn} (Harmonic Function)
    Let \(\Omega\) be an open set in \(\mathbb{R}^d\). If \(u \in C^2(\Omega)\) and \(\Delta u = 0\) in \(\Omega\), then \(u\) is a harmonic function in \(\Omega\).
  \end{defn}

  \begin{thm} (Gauss-Green Theorem)\label{gauss-green}
    Let \(A \subseteq \mathbb{R}^d\) open, \(\vec{F} \in C^1(A, \mathbb{R}^d)\) and \(K \subseteq A\) compact with \(C^1\) boundary. Then
    \[ \int_{\partial K} \vec{F} \cdot \vec{\nu}\ dS(x) = \int_K \div(\vec{F})\ dx \]
    where \(\nu\) is the outward unit normal vector field on \(\partial K\).
  Thus
  \begin{align*}
    \int_{\partial V} \nabla u \cdot \vec{\nu}\ dS(x)
    = \int_V \div(\nabla u) \ dx
    = \int_V \Delta u(x) \ dx
  \end{align*}
  for any \(V \subseteq \Omega \) open.
  \end{thm}


  \begin{thm} (Green's Identities)\label{green-identities}
    Let \(A \subseteq \mathbb{R}^d\) open, \(K \subseteq A\) d-dim.\ compactum with \(C^1\) boundary and \(f, g \in C^2(A)\)
    \begin{enumerate}
      \item Green's first identity (Partial Integration): \begin{align*}
        \int_K \nabla f \cdot \nabla g \, dx = \int_{\partial K} f \frac{\partial g}{\partial \nu} \, dS - \int_K f \Delta g \, dx
      \end{align*}
      where \(\frac{\partial g}{\partial \nu} = \partial_\nu g = \nu \cdot \nabla g\)
      \item Green's second identity: \begin{align*}
        \int_K f \Delta g - (\Delta f) g \, dx = \int_{\partial K} \left(f \frac{\partial g}{\partial \nu} - g \frac{\partial f}{\partial \nu}\right) \, dS
      \end{align*}
    \end{enumerate}
  \end{thm}

  \begin{ex}
    Let \(\Omega \subseteq \mathbb{R}^d\) open, let \(f: \Omega \to \mathbb{R}\) be continuous. Prove that if \( \int_B f(x) \ dx = 0 \), then \( u \equiv 0 \) in \(\Omega\).
  \end{ex}

  \begin{thm} (Fundamential Lemma of Calculus of Variations)
    Let \(\Omega \subseteq \mathbb{R}^d\) open, let \(f \in L^1(\Omega)\). If 
    \(\int_B f(x) \ dx = 0\) for all \(x \in B_r(x) \subseteq \Omega\), then \(f(x) = 0\) a.e. (almost everywhere) \(x \in \Omega\).
  \end{thm}

  \begin{rem} (Solving Laplace Equation)
    \(-\Delta u = 0\) in \(\mathbb{R}^d\). Consider the case when \(u\) is radial, i.e. \(u(x) = v(|x|)\), \(v: \mathbb{R} \to \mathbb{R}\). Denote \(r = |x|\), then 
    \[
      \frac{\partial r}{\partial x} 
      = \frac{\partial}{\partial x_i}  \left(\sqrt{x_1^2 + \dots + x_d^2}\right) \\
      = \frac{2 x_i}{2{\sqrt{x_1^2 + \dots + x_d^2}}} \\
      = \frac{x_i}{r}
    \]
    Then
    \begin{align*}
      \partial_{x_i} u &= \partial_{x_i} v = (\partial_r v) \frac{\partial r}{\partial {x_i}} 
      = v'(r) \frac{x_i}{r} \\
      \partial^2_{x_i} u 
      &= \partial_{x_i} \left(v(r)' \frac{x_i}{r}\right) 
      = (\partial_{x_i}v(r)') \frac{x_i}{r} + v'(r) \partial_{x_i} \left(\frac{x_i}{r}\right) \\
      &= (\partial_r v'(r))\left(\frac{dr}{\partial_{x_i}}\right) \frac{x_i}{r} + v'(r)\left( \frac{1}{r} - \frac{x_i}{r^2}(\partial_{x_i} r) \right) 
      = v'(r) \frac{x_i^2}{r^2} + v'r(r)\left(\frac{1}{r} - \frac{x_i^2}{r^3}\right)
    \end{align*}

    So we have \(\Delta u = \left( \sum_{i=1}^d d_{x_i}^2 \right) u = v''(r) + v'(r) (\frac{d}{r} - \frac{1}{r})\)

    Thus \(\Delta u = v'(r) + v(r) \frac{d-1}{r}\). We consider \(d \ge 2\). Laplace operator \(\Delta u = 0\) now becomes \(v''(r) + v'(r) \frac{d-1}{r} = 0\) \\
    \(\Rightarrow\) \(\log(v(r))' = \frac{v'(r)}{v(r)} = - \frac{d-1}{r} = -(d-1)(\log r)'\) (recall \(log(f)' = \frac{f'}{f}\)) \\
    \(\Rightarrow v'(r) = \frac{1}{v^{d-2} + \text{ const.}}\) \\
    \(\begin{cases}
      \frac{const}{r^{d-2}} + const xx + const &,d \ge 3 \\
      const \log(r) + const xx r + const &,d = 2
    \end{cases}\)
  \end{rem}

  \begin{defn} 
    (Fundamential Solution of Laplace Equation)
    \begin{align*}
      \Phi(x) = \begin{cases}
        - \frac{1}{2 \pi} \log(|x|), & d = 2 \\
        \frac{1}{(d-2) d |B_1|} \frac{1}{|x|^{d-2}}, & d \ge 3
      \end{cases}
    \end{align*}
    
    Where \( |B_1| \) is the Volume of the ball \(B_1(0) = B(0, 1) \subseteq \mathbb{R}^d\).

  \end{defn}

  \begin{rem}
    \(\Delta \Phi(x) = 0\) for all \(x \in \mathbb{R}^d\) and \(x \ne 0\). 
  \end{rem}


  \section{Poisson-Equation}
  The Poisson-Equation is \(-\Delta u(x) = f(x)\) in \(\mathbb{R}^d\). The explicit solution is given by
  \begin{align*}
    u(x) &= (\Phi \star f)(x)
    = \int_{\mathbb{R}^d} \Phi(x-y)f(y) \ dy 
    = \int_{\mathbb{R}^d} \Phi(y)f(x-y) \ dy
  \end{align*}
  This can be heuristically justifyfied with \[-\Delta (\Phi \star f) = (-\Delta \Phi) \star f = \delta_0 \star f = f\]


  \begin{thm} \label{solution-for-poisson}
    Assume \(f \in C_c^2(\mathbb{R}^d)\). Then \(u = \Phi \star f\) satisfies that \(u \in C^2(\mathbb{R}^d)\) and \(- \Delta u(x) = f(x)\) for all \(x \in \mathbb{R}^d\)
  \end{thm}


  \begin{proof}
    By definition we have
    \begin{align*}
      u(x) &= \int_{\mathbb{R}^d} \Phi(y) f(x-y) \, dy.
    \end{align*}
    First we check that \(u\) is continuous: Take \(x_k \to x_0\) in \(\mathbb{R}^d\). We prove that \(u(x_n) \xrightarrow{n} u_0\), i.e.
    \begin{align*}
      \lim_{n \to \infty} \int_{\mathbb{R}^d} \Phi(y) f(x_n - y) \ dy = \int_{\mathbb{R}^d} \Phi(y) f(x_0 - y) \ dy
    \end{align*}
    This follows from the Dominated Convergence Theorem. More precisely:
    \begin{align*}
      \lim_{n \to \infty} \Phi(y) f(x_n -y) = \Phi(y) f(x_0 - y) \quad \text{ for all } y \in \mathbb{R}^d \setminus \{0\}
    \end{align*}
    and 
    \begin{align*}
      |\Phi(y) f(x-y)| &\le \| f ||_{L^\infty} \cdot \mathbb{1}(|y| \le R) \cdot |\Phi(y)| \in L^1(\mathbb{R}^d, dy)
    \end{align*}
    where \(R > 0\) depends on \(\{x_n\}\) and \(\operatorname{supp}(f)\) but independent of \(y\). Now we compute the derivatives:
    \begin{align*}
      \partial_{x_i} u(x) 
      &= \partial_{x_i} \int_{\mathbb{R}^d} \Phi(y) f(x-y) \ dy
      = \lim_{h \to 0} \int_{\mathbb{R}^d} \Phi(y) \frac{f(x + h e_i - y) - f(x-y)}{h} \ dy \\
      \text{(dom.\ conv.)} \quad &= \int \Phi(y) \partial_{x_i} f(x-y) \ dy \\
      \Rightarrow \quad D^\alpha u(x) &= \int_{\mathbb{R}^d} \Phi(y) D_x^\alpha f(x-y) \ dy \quad \text{for all } |\alpha| \le 2
    \end{align*}
    \(D^\alpha u(x)\)  is continuous, thus \(u \in C^2(\mathbb{R}^d)\).
    Now we check if this solves the Poisson-Equation:
    \begin{align*}
      - \Delta u(x) 
      &= \int_{\mathbb{R}^d} \Phi(y) (-\Delta_x) f(x-y) \, dy
      = \int_{\mathbb{R}^d} \Phi(y) (-\Delta_y) f(x-y) \, dy \\
      &= \int_{\mathbb{R}^d \setminus B(0, \epsilon)} \Phi(y) (-\Delta_x) f(x-y) \, dy + \int_{B(0, \epsilon)} \Phi(y) (-\Delta_x) f(x-y) \, dy \quad (\epsilon > 0 \text{ small})
    \end{align*}
    Now we come to the main part. We apply integration by parts (\ref{green-identities}):
    \begin{align*}
      &\int_{\mathbb{R}^d \setminus B(0, \epsilon)} \Phi(y)(- \Delta_y) f(x-y) \, dy \\
      &\quad = \int_{\mathbb{R}^d \setminus B(0, \epsilon)} (\nabla_y \Phi(y)) \cdot \nabla_y f(x-y) \, dy - \int_{\partial B(0, \epsilon)} \Phi(y) \cdot  \frac{\partial f}{\partial \vec{n}}(x-y) \, dS(y) \\
      &\quad = \int_{\mathbb{R}^d \setminus B(0, \epsilon)} \underbrace{(-\Delta_y \Phi(y))}_{=0} f(x-y) \, dy \\ &\qquad + \int_{\partial B(0, \epsilon)} \frac{\partial \Phi}{\partial \vec{n}}(y) f(x-y) \, dS(y) - \int_{\partial B(0, \epsilon)} \Phi(y) \frac{\partial f}{\partial \vec{n}}(x-y) \, dS(y)
    \end{align*}

    We have that \(\nabla_y \Phi(y) = -\frac{1}{d |B_1|} \frac{y}{|y|^d}\) and \( \vec{n} = \frac{y}{|y|} \text{ in } \partial B(0, \epsilon)\). This leads to
      \begin{align*}
        \frac{\partial \Phi}{\partial \vec{n}} &= \frac{1}{d |B_1|} \frac{1}{|y|^{d-1}} = \frac{1}{d |B_1| \epsilon^{d-1}} \quad \text{ for } y \in \partial B(0, \epsilon)
      \end{align*}

      Hence:
      \begin{align*}
        \int_{\partial B(0, \epsilon)} \frac{\partial \Phi}{\partial \vec{n}}(y) f(x-y) \ dS(y) 
        &= \frac{1}{d |B_1| \epsilon^{d-1}} \int_{\partial B(0, \epsilon)} f(x-y) \ dS(y) \\
        = \fint_{\partial B(0, \epsilon)} f(x-y) \ dS(y)
        &= \fint_{\partial B(x, \epsilon)} f(y) \ dS(y) 
        \xrightarrow{\epsilon \to 0} f(x)
      \end{align*}

        \begin{samepage}
          We have to regard the following error terms:
          \begin{itemize}
            \item \( 
                \begin{aligned}[t]
                  \left| \int_{B(0, \epsilon)} \Phi(y) (- \Delta_y) f(x-y) \ dy\right| 
                  &\le \int_{B(0, \epsilon)}|\Phi(y)| \underbrace{|-\Delta_y f(x-y)|}_{\le \|\Delta f\|_{L^\infty} \mathbb{1}(|y| \le R)} \ dy \\
                  &\le \| \Delta f\|_{L^\infty} \int_{\mathbb{R}^d} \underbrace{|\Phi(y)| \mathbb{1}(|y| \le R)}_{L^1(\mathbb{R}^d)} \mathbb{1}(|y| \le \epsilon) 
                  \xrightarrow{\epsilon \to 0} 0
                \end{aligned}
              \)
            Where \(R > 0\) depends on \(x\) and the support of \(f\) but is independent of \(y\).
          \item \( 
              \begin{aligned}[t]
                \left|\int_{\partial B(0, \epsilon)} \Phi(y) \frac{\partial f}{\partial \vec{n}}(x-y) \ dS(y)\right|
                &\le \|\nabla f\|_{L^\infty} \int_{\partial B(0, \epsilon)} |\Phi(y)| \ dy \\
                &\le \begin{cases}
                  const \cdot \epsilon | \log \epsilon| \to 0, & d = 2 \\
                  const \cdot \epsilon \to 0, & d \ge 3
                \end{cases}
              \end{aligned}
            \)
          \end{itemize}
        \end{samepage}
        Conclusion: \(-\Delta u(x) = f(x)\) for all \(x \in \mathbb{R}^d\) proved that \(u = \Phi \star f\) and \(f \in C_c^2(\mathbb{R}^d)\).
    \end{proof}

    Thus, if \(f \in C_c^2(\mathbb{R})\), then \(u = \Phi \star f\) satisfies \(u \in C^2(\mathbb{R}^2)\) and \(-\Delta u(x) = f(x)\) for all \(x \in \mathbb{R}^d\).


  \begin{rem}
    The result holds for a much bigger class of functions \(f\). For example if \(f \in C_c^1(\mathbb{R})\) we can easily extend the previous proof:
    \begin{align*}
      \partial_{x_i} u = \int_{\mathbb{R}^d} \Phi(y) \partial_{x_i} f(x-y) \, dy \in C(\mathbb{R}^d) \Rightarrow u \in C^1(\mathbb{R}^d)
    \end{align*}
    Consequently: 
    \begin{align*}
      \partial_{x_i} \partial_{x_j} u 
      &= \partial_{x_i} \int_{\mathbb{R}^d} \Phi(y) \partial_{x_j} f(x-y) \, dy
      = \int_{\mathbb{R}^d} \partial_{x_i} \Phi(y) \partial_{x_j} f(x-y) \, dy \in C(\mathbb{R}^d)
    \end{align*}
    So we have \(u \in C^2(\mathbb{R}^d)\). Now we can compute
    \begin{align*}
      \Delta u = \sum_{i=1}^d \int_{\mathbb{R}^d} \partial_{x_i} \Phi(y) \partial_{x_i} f(x-y) \, dy \overset{(IBP)}{=} f(x).
    \end{align*}
  \end{rem}

  \begin{ex}
    Extend this to more general functions!
  \end{ex}

  \section{Equations in general domains}
  \begin{thm} (Mean Value Theorem for Harmonic Functions)\label{mean-value-theorem} 
    Let \(\Omega \subseteq \mathbb{R}\) be open, let \( u \in C^2(\Omega)\) and \(\Delta u = 0\) in \(\Omega\). Then
    \begin{align*}
      u(x) 
      &= \fint_{B(x, r)} u
      = \fint_{\partial B(x, r)} u \quad \text{for all } x \in \Omega, B(x,r) \subseteq \Omega
    \end{align*}
  \end{thm}

  \begin{proof}
    Consider all \(r > 0\) s.t. \(B(x,r) \subseteq \Omega\),
    \begin{align*}
      f(r) &= \fint_{\partial B(x,r)} u
    \end{align*}
    We need to prove that \(f(r)\) is independent of \(r\). When it is done, then we immediately obtain
    \begin{align*}
      f(r) = \lim_{t \to 0} f(t) = u(x)
    \end{align*}
    as \(u\) is continuous. To prove that, consider
    \begin{align*}
      f'(r) 
      &= \frac{d}{dr} \left(\fint_{\partial B(0, r)} u(x+y) \, dS(y) \right) \\
      &= \frac{d}{dr} \left(\fint_{\partial B(0, 1)} u(x + rz) \, dS(z) \right) \\
      \text{(dom.\ convergence)} \quad & = \fint_{\partial B(0, 1)} \frac{d}{dr} [u(x + rz)] \, dS(z) \\
      &= \fint_{\partial B(0, 1)} \nabla u(x + rz) z \, dS(z) \\
      &= \fint_{\partial B(x, r)} \nabla u(y) \frac{y-x}{r} \, dS(y) \\
      &= \frac{1}{|B(x, r)|_{\mathbb{R}^d}} \int_{\partial B(x, r)} \nabla \cdot u(y) \cdot \vec{n_y} \, dS(y) \\
      \text{(Gauss-Green \ref{gauss-green})} \quad &= \frac{1}{|B(x, r)|_{\mathbb{R}^d}} \int_{B(x, r)} \underbrace{(\Delta u)(y)}_{= 0} \, dy = 0 \qedhere
    \end{align*}
  \end{proof}

  \begin{ex}
    In 1D\@: \(\Delta u = 0 \Leftrightarrow u'' = 0 \Leftrightarrow u(x) = ax + b\) (Linear Equation)
  \end{ex}

  \begin{rem}
    Recall the polar decomposition. Let \(x \in \mathbb{R}^d, x = (r,w), r = |x| > 0, \omega \in S^{d-1}\), then
    \begin{align*}
      \int_{B(0, r)} g(y) \, dy = \int_0^r \left(\int_{B(0, r)} g(y) \, dS(y) \right) dr
    \end{align*}
  \end{rem}


  \begin{rem}
    We already proved that for \(u\) harmonic we have \( u(x) = \fint_{\partial B(x,r)} u \, dy \). Now we have 
    \begin{align*}
      \int_{B(x, r)} u(y) \, dy 
      &= \int_{B(0, r)} u(x+y) \, dy \\
      \text{(Pol.\ decomposition)} \quad &= \int_0^r \left(\int_{\partial B(0, s)} u(x+y) \, dS(y)\right) ds \\
      &= \int_0^r \left(\int_{\partial B(x, s)} u(y) \, dS(y) \right) ds \\
      \text{(Mean value property)} \quad &= \int_0^r \left(|\partial B(x, s)| \, u(x) \right) ds
      = |B(x,r)| \, u(x)
    \end{align*}
    This implies
    \begin{align*}
      \fint_{B(x,r)} u(y) \, dy = u(x)
      \quad \text{for any \(B(x,r) \subseteq \Omega\).}
    \end{align*}
  \end{rem}

  \begin{rem}
    The reverse direction is also correct, namely if \(u \in C^2(\Omega)\) and
    \begin{align*}
      u(x) 
      &= \fint_{B(x, r)} u(y) \, dy
      = \fint_{\partial B(x,r)} u(y) \, dy
      \quad \text{for all } B(x,r) \subseteq \Omega,
    \end{align*}
    then \(u\) is harmonic, i.e. \(\Delta u = 0\) in \(\Omega\). (The proof is exactly like before)
  \end{rem}

  \begin{thm}[Maximum Principle]\label{maximum-principle}
    Let \(\Omega \subseteq \mathbb{R}^d\) be open, let \(u \in C^2(\Omega) \cap C(\bar \Omega)\), \(\Delta u = 0\) in \(\Omega\). Then
    \begin{enumerate}[label=\alph*)]
      \item \(\max_{x \in \bar \Omega} u(x) = \max_{x \in \partial \Omega} u(x)\)
      \item Assume that \(\Omega\) is connected. Then if there is a \(x_0 \in \Omega\) s.t. \( u(x_0) = \max_{x \in \bar \Omega} u(x)\), then \( u \equiv const.\) in \(\Omega\).
    \end{enumerate}
  \end{thm}

  \begin{proof}
    Given \(U \subseteq \mathbb{R}^d\) open, we can write \(U = \bigcup_i U_i\), where \(U_i\) is open and connected.
    \begin{enumerate}
      \item[b)] Assume that \(\Omega\) is connected and there is a \(x_0 \in \Omega\) s.t. \(u(x_0) = \sup_{y \in \Omega} u(x)\). Define \(U = \{ x \in \Omega \mid u(x) = u(x_0)\} = u^{-1}(u(x_0))\). \(U\) is closed since \(u\) is continuous.
      Moreover, \(U\) is open by the mean-value theorem. I.e.~for all \(x \in U\) there is a \(r > 0\) s.t. \(B(x,r) \subseteq U \subseteq \Omega\).
      Since \(U\) is connected we get \(U = \Omega\), so \(u\) is constant in \(\Omega\). On the other hand, if there is no \(x_0 \in \Omega\) s.t. \(u(x_0) = \sup_{x \in \Omega}\) we have \(\forall x_0 \in \Omega: \quad u(x) < \sup_{x \in \bar \Omega} u(x) = \sup_{x \in \partial \Omega} u(x)\)
      \item[a)] Given \(\Omega \subseteq \mathbb{R}^d\) open, we can write \(\Omega = \bigcup_i \Omega_i\), where \(\Omega_i\) is open and connected. By b) we have
        \[\sup_{x \in \bar \Omega_i} u(x) = \sup_{x \in \partial \Omega_i} u(x), \quad \forall i\]
        So we can conclude
        \[\quad \sup_{x \in \bar \Omega} u(x) = \sup_{x \in \partial \Omega} u(x). \qedhere\]
    \end{enumerate}
  \end{proof}

  \begin{defn}
    \begin{itemize}
      \item If \(\Omega \subseteq \mathbb{R}^d\) is open, \(u \in C^2(\Omega)\), then \(u\) is called \emph{sub-harmonic} if \(\Delta u \ge 0\) in \(\Omega\).
      \item If \(\Delta u \le 0\), then \(u\) is called \emph{super-harmonic}.
    \end{itemize}
  \end{defn}

  \begin{ex}[E 1.4]
    Let \(\Omega \subseteq \mathbb{R}^d\) be open and \(u \in C^2(\Omega)\) be subharmonic.
    \begin{enumerate}[label=\alph*)]
      \item Prove that \(u\) satisfies the Mean Value Inequality
      \begin{align*}
        \fint_{\partial B(x, r)} u(y) \, dS(y)
        \ge \fint_{B(x, r)} u(y) \, dy
        \ge u(x)
      \end{align*}
      for all \(B(x,r) \subseteq \mathbb{R}^d\).
      \item Assume further that \(\Omega\) is connected and \(u \in C(\bar \Omega)\). Prove that \(u\) satisfies the strong maximum principle, namely either
      \begin{itemize}
        \item \(u\) is constant in \(\Omega\), or 
        \item \(\sup_{y \in \partial \Omega} u(y) > u(x)\) for all \(x \in \Omega\).
      \end{itemize}
    \end{enumerate}
  \end{ex}

  \begin{proof}[My Solution]
    \begin{enumerate}[label=\alph*)]
      \item Let \(f(r) = \fint_{\partial B(x, r)} u(y) \, dS(y)\), then we have
        \begin{align*}
          \partial_r f(r)
          &= \partial_r \fint_{\partial B(x,r)} u(y) \, dS(y) \\
          \text{(Dom. Convergence)} \quad &= \fint_{\partial B(x, r)} \partial_r u(y) \, dS(y) \\
          &= \fint_{\partial B(0,1)} \partial_r u(x+yr) \, dS(y) \\
          &= \fint_{\partial B(0,1)} \nabla u(x+yr) \cdot y \, dS(y) \\
          &= \fint_{\partial B(x, r)} \nabla u(y) \cdot \frac{y-x}{r} \, dS(y) \\
          &= \fint_{\partial B(x,r)} \nabla u(y) \cdot \vec{n}_y \, dS(y) \\
          \text{(Gauss-Green)} \quad &= \fint_{B(x, r)} \div(\nabla u(y)) \, dS(y) \\
          &= \fint_{B(x,r)} \underbrace{\Delta u(y)}_{\ge 0} \, dS(y) \ge 0
        \end{align*}
        So we can conclude that
        \[\fint_{\partial B(x, r)} u(y) \, dS(y) = f(r) \ge \lim_{r \to 0} f(r) = u(x).\]

        Now regard
        \begin{align*}
          \int_{B(x,r)} u(y) \, dy 
          &= \int_0^r \left(\int_{\partial B(x, r)} u(y) \, dS(y)\right) \, ds \\
          &= \int_0^r \left(|\partial B(x, r)| \fint_{\partial B(x,r)} u(y) \, dS(y)\right) \, ds \\
          &\ge \int_0^r |\partial B(x, r)| \cdot  u(x) \, dS(y) \\
          &= u(x) \int_0^r |\partial B(x, r)| \, dS(y)
          = u(x) |B(x,r)|.
        \end{align*}

        Thus we have
        \begin{align*}
          u(x) \le \fint_{B(x,r)} u(y) dy.
        \end{align*}

        Finally, lets regard
        \begin{align*}
          \int_{B(x, r)} u(y) \, dy
          &= \int_0^r \left(|\partial B(x,s)| \fint_{\partial B(x, s)} u(y) \, dS(y)\right) \, ds \\
          (\partial_r f(r) \ge 0) \quad &\le \int_0^r \left(|\partial B(x,s)| \fint_{\partial B(x, r)} u(y) \, dS(y)\right) \, ds \\
          &= \fint_{\partial B(x, r)} u(y)  \, dS(y) \int_0^r |\partial B(x,s)| \, ds \\
          &= \fint_{\partial B(x, r)} u(y)  \, dS(y) \cdot |B(x,s)|
        \end{align*}
        and we conclude
        \[\fint_{B(x, r)} u(y) \, dy \le \fint_{\partial B(x,r)} u(y) \, dS(y).\]
      \item Let \(x_0 \in \Omega\) s.t. \(u(x_0) = \sup_{x \in \Omega} u(x)\). Now, \begin{align*}
        \sup_{x \in \Omega} u(x) 
        &= u(x_0) 
        \le \fint_{\partial B(x_0, r)} u(y) \, dy \\
        &\le \fint_{\partial B(x_0, r)} \sup_{x \in \Omega} u(x) \, dy 
        = \sup_{x \in \Omega} u(x)
      \end{align*}
      Since \(u\) is continous we get \(u(y) = u(x_0)\) for all \(y \in B(x_0, r)\), so \(u\) is constant. \qedhere
    \end{enumerate}
  \end{proof}

  \begin{defn}
    The \emph{Poisson Equation} for given \(f, g\) on a bounded set is:
    \begin{align*}
      \begin{cases}
        - \Delta u = f, &\text{in } \Omega \\
        u = g, &\text{on } \partial \Omega
      \end{cases}
    \end{align*} 
  \end{defn}

  \begin{thm}(Uniqueness)
    Let \(\Omega \subseteq \mathbb{R}^d\) be bounded, open  and connected. Let \(f \in C(\Omega), g \in C(\partial \Omega)\). Then there exists \emph{at most} one solution \(u \in C^2(\Omega) \cap C(\bar \Omega)\), s.t. \begin{align*}
      \begin{cases}
        - \Delta u = f, &\text{in } \Omega \\
        u = g, &\text{on } \partial \Omega
      \end{cases}
    \end{align*}
  \end{thm}

  \begin{proof}
    Assume that we have two solutions \(u_1\) and \(u_2\). Then \(u \coloneqq u_1 - u_2\) is a solution to 
    \begin{align*}
      \begin{cases}
        - \Delta u = 0, &\text{in } \Omega \\
        u = 0 &\text{on } \partial \Omega
      \end{cases}
    \end{align*}
    By the maximum principle, we know that \(u = 0\) in \(\Omega\). More precisely, by the maximum principle we have \(\forall x \in \Omega\)
    \begin{align*}
      \sup_{x \in \Omega} u(x) \le \sup_{x \in \partial \Omega} u(x) = 0
      \quad \Rightarrow \quad
      u(x) \le 0
    \end{align*}
    Since \(-u\) satisfies the same property we have \(\forall x \in \Omega\):
    \begin{align*}
      \sup_{x \in \Omega}(-u(x)) \le \sup_{x \in \partial \Omega} (-u(x)) = 0
      \quad \Rightarrow \quad
      - u(x) \le 0
      \quad \Rightarrow \quad
      u(x) \ge 0
    \end{align*}
    So we geht \(u(x)  = 0\) in \(\Omega\).
  \end{proof}

  \begin{ex}[Bonus 1]\label{bonus-1}
    Let \(\Omega\) be open, connected and bounded in \(\mathbb{R}^d\). Let \(u \in C^2(\Omega) \cap C(\bar \Omega)\) s.t. 
    \begin{align*}
      \begin{cases}
        \Delta u = 0, &\text{in } \Omega \\
        u = g, &\text{on } \partial \Omega
      \end{cases}
    \end{align*}
    Prove that \begin{enumerate}[label=\alph*)]
      \item If \(g \ge 0\) on \(\partial \Omega\), then \(u \ge 0\) in \(\Omega\). 
      \item If \(g \ge 0\) on \(\partial \Omega\) and \(g \ne 0\), then \(u > 0\) in \(\Omega\).
    \end{enumerate}
  \end{ex}

  \begin{proof}[My Solution]
    \begin{enumerate}[label=\alph*)]
      \item We have that \(\Delta (-u) = 0\), so \(-u\) is harmonic in \(\Omega\). Since \(\Omega\) is open and bounded we can apply the Maximum Principle (\ref{maximum-principle}) and get that
      \[\sup_{x \in \bar \Omega} -u(x) \le \sup_{x \in \partial \Omega} -g(x) \le 0.\]
      This implies \(\inf_{x \in \Omega} u(x) \ge 0\), so \(u \ge 0\) in \(\Omega\).
      \item We prove this by contraposition. Assume there is a \(x_0 \in \Omega\) s.t. \(u(x_0) = 0\). Since we have \(u \ge 0\) on \(\Omega\) by a), it follows that
      \[0 = -u(x_0) = \sup_{x \in \bar \Omega} -u(x) \le \sup_{x \in \partial \Omega} -g(x) \le 0,\]
      so \(-u\) attains its maximum on \(\Omega\). Hence \(-u = 0 = u\) is constant by the strong maximum principle because \(\Omega\) is connected, in fact \(0 = u|_{\partial \Omega} = g\). \qedhere
    \end{enumerate}
  \end{proof}

  \begin{lem}[Estimates for derivatives]\label{estimates-of-derivatives}
    If \(u\) is harmonic in \(\Omega \subseteq \mathbb{R}^d\), \(\alpha \in \mathbb{N}_0^d\), \(|\alpha| = N\) and \(B(x_0, r) \subseteq \Omega\), then 
    \[|D^\alpha u(x)| \le \frac{(c_dN)^N}{r^{d+N}} \int_{B(x, r)} |u| \, dy\]
  \end{lem}

  \begin{proof}
    Induction: Assume \(|\alpha| = N-1\), Take \(|\alpha| = N\)
    \begin{align*}
      |D^\alpha u(x_0)| 
      &\le \frac{|S_1|}{|B_1|\frac{r}{N}} \| D^\beta u \|_{L^\infty (B(x_0, \frac{r}{n}))}, \quad D^\alpha u = \partial_{x_i}(D^\beta u)_{|\beta| = N-1}
    \end{align*}
    Note: \(x \in B(x_0, \frac{r}{N})\), so \(B(x, \frac{r(N-1)}{N}) \subseteq B(x_0, r)\). By the induction hypothesis:
    \begin{align*}
      \|D^\beta u\|_{L^\infty(B(x_0, \frac{r}{N}))} 
      &\le \frac{[c_d (N-1)]^{N-1}}{[r \frac{(N-1)}{N}]^{d+N-1}} \int_{B(x_0, r)} |u| \, dy
    \end{align*}
    The conclusion is:
    \begin{align*}
      |D^\alpha u (x_0)|
      &\le \frac{|S_1|}{|B_1| \frac{r}{N}} \frac{[c_d(N-1)]^{N-1}}{\left(r \frac{N-1}{N^d}\right)^{d + N - 1}} \int_{B(x_0, r)} |u| \, dy \\
      &= \frac{|S_1|}{|\beta_1|} \frac{c_d^{N-1}}{\left(\frac{r}{N}\right)^{d+N} (N-1)^d} \int_{B(x_0, r)} |u| \, dy \\
      &= \frac{|S_1|}{|\beta_1|} \frac{c_d^{N-1}}{\left(\frac{r}{N}\right)^{d+N} N^d} \left(\frac{N}{N-1}\right)^d \int_{B(x_0, r)} |u| \, dy \\
      &\le \frac{2^d |S_1|}{|B_1|} \frac{c_d^{N-1} N^N}{r^{d+N}} \int_{B(x_0, r)} |u| \, dy \qquad \text{if } c_d \ge \frac{2^d |S_1|}{|B_1|}
    \end{align*}
  \end{proof}

  \begin{thm}[Regularity]
    Let \(\Omega\) be open in \(\mathbb{R}^d\). Let \(u \in C(\Omega)\) satisfy \(u(x) = \fint_{\partial B} u \, dy\) for any \(x \in B(x, r) \subseteq \Omega\). Then \(u\) is a harmonic function in \(\Omega\). Moreover, \(u \in C^\infty(\Omega)\) and \(u\) is analytic in \(\Omega\).
  \end{thm}

  % \begin{proof}
  %   We use the convolution. For simlicity consider the case \(\Omega = \mathbb{R}^d\) first. Take \(\eta \in C_c^\infty(\mathbb{R}^d)\) with \(0 \le \eta \le 1\), \(\eta(x) = 0\) if \(|x| \ge 1\), \(\eta\) radial and \(\int \eta = 1\). Define \(\eta_\epsilon (x) = \epsilon^{-d} \eta(\epsilon^{-1} x)\) for all \(\epsilon > 0\). Then
  %   \begin{align*}
  %     \int_{\mathbb{R}^d} \eta_\epsilon = \int_{\mathbb{R}^d} \eta = 1
  %   \end{align*}
  %   We prove \(u_\epsilon \coloneqq \eta_\epsilon \star u = u\) for all \(\epsilon > 0\). By definition:
  %   \begin{align*}
  %     u_\epsilon(x) 
  %     &= \int_{\mathbb{R}^d} \eta_\epsilon(x-y)u(y) \, dy \\
  %     &= \int_0^\infty \left[\int_{\partial B(x, r)} \eta_\epsilon(x-y) u(y) \, dS(y)\right] dr \\
  %     (\eta \text{ radial}) \quad &= \int_0^\infty \left[\eta_\epsilon(r) \int_{\partial B(x, r)} u(y) \, dS(y)\right] dr \\
  %     \text{(Assumption)} \quad &= \int_0^\infty \eta_\epsilon(r)\, |\partial B(x, r)|\, u(x) \, dr \\
  %     &= u(x) \int_0^\infty \eta_\epsilon(r) |\partial B(0, r)| \, dr \\
  %     &= u(x) \int_{\mathbb{R}^d} \eta_\epsilon(y) \, dy = u(x)
  %   \end{align*}

  %   On the other hand, \(u_\epsilon = \eta_\epsilon \star u\) is \(C^\infty(\mathbb{R}^d)\). In fact \(D^\alpha(\eta_\epsilon \star u) = (D^\alpha \eta_\epsilon) \star u\) is continuous for any \(\alpha\) (Exercise). Then \(u \in C^\infty(\mathbb{R}^d)\), so \(u\) is harmonic in \(\mathbb{R}^d\), i.e. \(\Delta u = 0\) in \(\mathbb{R}^d\). \\

  %   Consider now the general case where \(\Omega \subseteq \mathbb{R}^d\) is open. Take \(\epsilon > 0\) small and define \(\Omega_\epsilon = \{x \in \Omega \mid \dist(x, \partial \Omega) > \epsilon\}\). 
  %   Define \[u_\epsilon(x) = \int_{\mathbb{R}^d} \eta_\epsilon(x-y) u(y) \, dy \quad \text{ for all } x \in \Omega_\epsilon\]
  %   Recall that \(\eta_\epsilon(y) = 0\) if \(|y| \ge \epsilon\), then:
  %   \[u_\epsilon(x) = \int_{B(x, \epsilon)} \eta_\epsilon(x-y)u(y) \, dy\]
  %   is well-defined since \(B(x,\epsilon) \subseteq \Omega\) for all \(x \in \Omega_\epsilon\).
  %   Then by the same computation using the polar-decomposition, we find that \(u_\epsilon(x) = u(x)\) for all \(x \in \Omega\). Note that \(u_\epsilon \in C^\infty(\Omega_\epsilon)\). Taking \(\epsilon \to 0\), we get \(u \in C^\infty(\Omega)\). Then we conclude that \(u\) is harmonic (We need to reverse the proof of the mean-value theorem).\\
  %   To proof that \(u\) is analytic, we need to show that for all \(x_0 \in \Omega\), there is a \(r > 0\) s.t. \(B(x_0, r) \subseteq \Omega\) and \[u(x) = u(x_0) + \sum_{\alpha \ne 0} c_\alpha(x-x_0)^\alpha \quad \text{for  all } x \in B(x_0, r)\]
  %   Here \(\alpha = (\alpha_1, \dots, \alpha_d), \alpha_i \in \{0, 1, 2, \dots\}\) and \(y^\alpha = y_1^{\alpha_1}y_2^{\alpha_2} \dots y_d^{\alpha_d}\). 
  %   We want to prove that the series converges uniformly in \(B(x_0, r)\). Recall the Taylor expansion:
  %   \[u(x) = u(x_0) + \sum_{0 < |\alpha| < N} D^\alpha u(x_0) \frac{(x-x_0)^\alpha}{\alpha!} + R_N(x)\]
  %   where \(|\alpha| = \alpha_1 + \alpha_2 + \dots + \alpha_d\), \(\alpha! = \alpha_1! \cdots \alpha_d!\) and \[R_N(x) = \sum_{|\alpha| = N} \int_0^1 D^\alpha u(x_0 + t(x-x_0)) \frac{(x-x_0)^\alpha}{\alpha!} \, dt\]
  %   New: Let \(x_0 \in \Omega\), take \(r > 0\), \(r < \frac{1}{L+1} \dist(x_0, \Omega^c)\) s.t. if \(x \in B(x_0, r)\), then \[B(x, Lr) \subseteq B(x_0, (L+1)r) \subseteq \Omega\]. With Lemma~\ref{estimates-of-derivatives} we get:
  %   \begin{align*}
  %     |D^\alpha u(x_0 + t(x-x_0))
  %     &\le \frac{(c_d N)^N}{(Lr)^{d+N}} \int_{B(x, Lr)} |u|
  %   \end{align*}
  %   With \((x_0, r) \leadsto (x, Lr)\)
  %   \begin{align*}
  %     |R_N(x)| \le \sum_{|\alpha| = N} \frac{(c_d N)^N}{(Lr)^{d+N}} \frac{1}{\alpha!} \frac{1}{\alpha!} \tau^N \int_{B(x_0, (L+1)r) |u|}
  %   \end{align*}

  %   Thus 
  %   \begin{align*}
  %     \left(\frac{\tilde c_d N}{L}\right) \frac{1}{N!}
  %     &\le \left(\frac{\tilde c_d N}{L}\right) \left(\frac{e}{N}\right)^N \quad \text{ if \(N\) large} \\
  %     &= \left(\frac{\tilde c_d e}{L}\right)^N \xrightarrow{N \to \infty} 0 \quad \text{if } L > \tilde c_d e (L = L_d)
  %   \end{align*}
  %   We conclude that \[u(x) = u(x_0) + \sum_{\alpha \ne 0} \frac{D^\alpha u(x_0)}{\alpha!}(x-x_0)^\alpha\]
  %   The series converges uniformly \(x \in B(x_0, r)\).
  %   Now we proof the bound on derivatives. For \(\alpha = 0\)
  %   \begin{align*}
  %     |u(x_0)| = \left| \fint_{B(x_0, r)} u \right| \le \frac{1}{|B_1|r^d} \int_{B(x_0, r)} |u|
  %   \end{align*}
  %   For \(\alpha = 1:\) \(\Delta u = 0\) in \(\Omega\) \(\Rightarrow\) \(0 = \partial_{x_i} (\Delta u) = \Delta (\partial_{x_i} u)\), so \(\partial_{x_i} u\) is harmonic in \(\Omega\). Hence, by the mean-varlue theorem again:
  %   \begin{align*}
  %     \partial_{x_i} u(x_0) &= \fint_{B(x_0, \frac{r}{2})} \partial_{x_i} u = \frac{1}{|B_1| \frac{\frac{r}{2}}{2}^d} \int_{B(x_0, \frac{r}{2})} \partial_{x_i} u = \frac{1}{|B_1| \frac{r}{2}^d} \int_{\partial B(x_0, \frac{r}{2})}u n_i \, dS
  %   \end{align*}
  %   So we get:
  %   \begin{align*}
  %     |\partial_{x_i} u(x_0)| 
  %     &= \frac{1}{|B_1| r^d} \int_{\partial B(x, r)} \, dS \|u\|_{L^\infty(\partial B(x_0, \frac{r}{2}))}  \\
  %     &= \frac{|S_1|}{|B_1|\frac{r}{2}} \|u\|_{L^\infty(\partial B(x_0, \frac{r}{2}))}
  %   \end{align*}
  %   For any \(y \in \partial B(x_0, \frac{r}{2})\) by the mean value theorem, we get:
  %   \begin{align*}
  %     |u(y)| 
  %     &= \left| \fint_{B(y, \frac{r}{2})} u\right|
  %     &\le \frac{1}{|B_1| \left(\frac{r}{2}\right)^d} \int_{B(y, \frac{r}{2})} |u|
  %     &\le \frac{1}{|B_1| \left(\frac{r}{2}\right)^d} \int_{B(x_0, r)} |u|
  %   \end{align*}
  %   Thus,
  %   \begin{align*}
  %     |\partial_{x_i} u(x_0)| 
  %     &\le \frac{|S_1|}{|B_1| \left(\frac{r}{2}\right)} \frac{1}{|B_1|  \left(\frac{r}{2}\right)^d} \int_{B(x_0, r)} |u|
  %     \le \frac{c_d}{r^{d+1}} \int_{B(x_0, r)} |u|
  %   \end{align*}
  %   Induction: Assume that we already proved the bound when \(|\alpha| = N-1\). Then:
  %   \begin{align*}
  %     \partial_{x_i} D^\alpha u 
  %     &= D^\alpha(\underbrace{\partial_{x_i} u}_{\text{harmonic}})
  %     = 0
  %     \quad \Rightarrow \quad
  %     D^\alpha u \text{ is harmonic}
  %   \end{align*}
  %   So we get
  %   \begin{align*}
  %     \partial_{x_i} (D^\alpha u) &= \fint_{B(x_0, \frac{r}{4})} \partial_{x_i} (D^\alpha u) \\
  %     \Rightarrow \quad |\partial_{x_i} (D^\alpha u)| &\le  \frac{C_d}{r^{d+1}} \int_{B(x_0, \frac{r}{2})} |D^\alpha u|
  %   \end{align*}
  %   and by the induction hypothesis:
    
  %   \begin{align*}
  %     |D^\alpha u(x_0)| &\le \frac{c_d}{r} \|D^\alpha u\|_{L^\infty B(x_0, \frac{r}{2})} \\
  %     &\le \frac{c_d}{r^{d+N-1}} \int_{B(x_0, r)} |u| \quad \forall x \in B\left(x_0, \frac{r}{2}\right)
  %   \end{align*}
  %   Then: \(|\partial_{x_i} D^\alpha u(x_0)| \le \frac{c_d}{r^{d+N}} \int_{B(x_0, r)} |u|\)
  % \end{proof}

  \begin{ex}[E 1.1: Proof the Gauss–Green formula]
    Let \(f \coloneqq (f_i)_1^d \in C^1(\mathbb{R}^d, \mathbb{R}^d)\). Prove that for every open ball \(B(y, r) \subseteq \mathbb{R}^d\) we have \[\int_{\partial B(y, r)} f(y) \cdot \nu_y \, dS(y) = \int_{B(y, r)}\div f \, dx.\]
    Here \(\nu_y\) is the outward unit normal vector and \(dS\) is the surface measure on the sphere.
  \end{ex}

  \begin{proof}[Solution]
    We proof this in d=3. Let \(f \in C^1(\mathbb{R}^3)\)
    \begin{align*}
      \int_{B(0, 1)} \partial_{x_3} f \, dx = \int_{\partial B(0, 1)} f x_3 \, dS(x), \quad x = (x_1, x_2, x_3) \in \mathbb{R}^3, \vec{n} = \frac{x}{|x|} \text{ on } \partial B(0,1)
    \end{align*}
    \begin{align*}
      B(0,1) &
      = \{x_1^2 + x_2^2 + x_3^2 \le 1 \} \\
      &= \{ x_1^2+ x_2^2 \le 1 - \sqrt{1 - x_1^2 - x_2^2} \le x_3 \le \sqrt{1 - x_1^2 - x_2^2}\}
    \end{align*}
    Then: 
    \begin{align*}
      \int_{B(0,1)} \partial_{x_3} f \, dx 
      &= \int_{x_1^2 + x_2^2 \le 1} \left(\int_{-\sqrt{1 - x_1^2 - x_2^2} \le x_3 \le \sqrt{1 - x_1^2 -x_2^2}} \partial_{x_3} f \, dx_3\right) \, dx_1 \, dx_2 \\
      &= \int_{x_1^2 + x_2^2 \le 1} \left[f(x_1, x_2, \sqrt{1 - x_1^2 - x_2^2})\right. \\
      &\qquad \left. - f(x_1, x_2, - \sqrt{1 - x_1^2 - x_2^2})\right] \, dx_1 \, dx_2
    \end{align*}
    Lets take polar coordinates in 2D:\begin{align*}
      x_1 &= r \cos \phi & r > 0, \phi \in [0, 2 \pi)\\
      x_2 &= r \sin \phi & \det \frac{\partial(x_1, x_2)}{\partial(r, \phi)} = r
    \end{align*}
    \begin{align*}
      (\star) &= \int_0^1 \int_0^{2 \pi} [f(r \cos \phi, r \sin \phi, r) - f(r \cos \theta, r \sin \phi, -r)] r \, dr \, d\phi
    \end{align*}
    On the other hand:
    \begin{align*}
      \int_{\partial B(0, 1)} f x_3 \, dS
    \end{align*}
    The polar coordinates in 3D are:
    \begin{align*}
      x_1 &= r \cos \phi sin \theta& r > 0, \phi \in (0, 2 \pi), \theta \in (0, \pi) \\
      x_2 &= r \sin \phi \sin \theta & \det \frac{\partial{x_1, x_2, x_3}}{\partial(r, \phi, t)} = r^2 \sin \theta\\
      x_3 &= \cos \theta
    \end{align*}
    Then: 
    \begin{align*}
      (\star \star) 
      &= \int_0^{2 \pi} \int_0^\pi f(\cos \phi \sin \theta, \sin \phi \sin \theta, \cos \theta) \sin \theta \cos \theta \, d \theta \, d \phi \\
      &= \int_0^{2 \pi} \left(\int_0^{\frac{\pi}{2}} + \int_{\frac{\pi}{2}}^\pi \, d \theta\right) \, d \phi \\
      (r = \sin \theta) \quad &= \int_0^{2 \pi} \int_0^1 f(r \cos \phi, r \sin \phi, \sqrt{1 - r^2}) r \, dr \, d \phi \\
      &\qquad - f(r \cos \phi, r \sin \phi, -\sqrt{1 - r^2}) r \, dr \, d\phi \qedhere
    \end{align*}
  \end{proof}

  \begin{ex}[E 1.2]
    Let \(u \in C(\mathbb{R}^d)\) and \(\int_{B(x, r)} u \, dy = 0\) for every open ball \(B(x, r) \subseteq \mathbb{R}^d\). Show that \(u(x) = 0\) for all \(x \in \mathbb{R}^d\).
  \end{ex}

  \begin{proof}[My Solution]
    Assume there is a \(x_0 \in \mathbb{R}^d\) s.t. w.l.o.g. \(u(x_0) > 0\). Since \(u\) is continous there is a ball \(B(x_0, r)\) s.t. \(u(y) > \frac{u(x_0)}{2}\) for all \(y \in B(x_0, r)\). But then we get
    \begin{align*}
      \int_{B(x_0, r)} u(y) \, dy
      &\ge \int_{B(x_0, r)} \frac{u(x_0)}{2} \, dy
      = \frac{u(x_0)}{2} \, |B(x_0, r)| > 0. \qedhere
    \end{align*}
  \end{proof}

  \begin{ex}[E 1.3]
    Let \(f \in C_c^1(\mathbb{R}^d)\) with \(d \ge 2\) and \(u(x) \coloneqq (\Phi \star f)(x)\). Prove that \(u \in C^2(\mathbb{R}^2)\) and \(- \Delta u(x) = f(x)\) for all \(x \in \mathbb{R}^d\) (\ref{solution-for-poisson} was the same for \(f \in C_1(\mathbb{R})\))
  \end{ex}

  % \begin{proof}[Solution]
  %   We regard d=3. 
    
  %   \begin{lem}
  %     If \(f \in C_c(\mathbb{R}^3)\), then \(\frac{1}{|x|} \star f \in C^1(\mathbb{R}^3)\) and \(\partial_{x_1} \left(\frac{1}{|x|} \star f\right) = \partial_{x_1} \left(\frac{1}{|x|}\right) \star f  = \left( \frac{- x_1}{|x|^3}\right) \star f\)
  %   \end{lem}

  %   \begin{proof}
  %     \begin{align*}
  %       \partial_{x_i} \left(\frac{1}{|x|} \star f\right) 
  %       &= \lim_{h \to 0} \frac{1}{h} \left[\int_{\mathbb{R}^3} \frac{1}{|x-y-he_i|} f(y) \, dy - \int_{\mathbb{R}^3} \frac{1}{|x-y|}f(y) \, dy\right] \\
  %       &= \lim_{h \to 0} \int_{\mathbb{R}^3} \frac{1}{h} \left[ \frac{1}{|x-y-he_i|} - \frac{1}{|x-y|}\right] f(y) \, dy \\
  %       &= \lim_{h \to 0} \int_{|x-y-he_i| \ge 2h} \frac{1}{h} \left[ \frac{1}{|x-y-he_i|} - \frac{1}{|x-y|}\right] f(y) \, dy \\
  %       &\qquad + \lim_{h \to 0} \int_{|x-y-he_i| < 2h} \frac{1}{h} \left[ \frac{1}{|x-y-he_i|} - \frac{1}{|x-y|}\right] f(y) \, dy
  %     \end{align*}
  %     \begin{align*}
  %       (I) \quad \lim_{h \to 0} \int_{\mathbb{R}^3} \frac{\mathbb{1}(|x-y-he_i| \ge 2H)}{h} \left[\frac{1}{|x-y-he_i|} - \frac{1}{|x-y|}\right] f(y) \, dy
  %     \end{align*}
  %     Dominated Convergence:
  %     \begin{align*}
  %       \lim_{h \to 0} (...) = \frac{\partial}{\partial x_i} \left(\frac{1}{|x-y|}\right) f(y) = \frac{-(x_i - y_i)}{|x-y|^3}f(y)
  %     \end{align*}
  %     and
  %     \begin{align*}
  %       \left| \frac{\mathbb{1}(|x-y-he_i| \ge 2h)}{h}\right| \left| \frac{1}{|x-y-he_i|} - \frac{1}{|x-y|}\right| |f(y)|
  %     \end{align*}
  %     Here:
  %     \begin{align*}
  %       \left| \frac{1}{|a|} - \frac{1}{|b|}\right| = \frac{||a|-|b||}{|a||b|} \le \frac{|a-b|}{|a||b|} \quad \forall a,b \in \mathbb{R}^3
  %     \end{align*}
  %     So we get
  %     \begin{align*}
  %       &\mathbb{1}(|x_3 - he_i) \ge 4h) \left|\frac{1}{|x-y-he_i|} - \frac{1}{|x-y|} \right| \\
  %       &\qquad \le \frac{|he_i|}{|x-y-he_i||x-y|} \mathbb{1}(|x-y-he_i| \ge 4h) \\
  %       &\qquad \le \frac{h}{\left(\frac{2}{3}\right)|x-y|}
  %     \end{align*}
  %     \begin{align*}
  %       (II) &= \left[ \int_{|x-y-he_i| < 4h} \frac{1}{h}\left[\frac{1}{|x-y-he_i|}-\frac{1}{|x-y|}\right]f(y) \, dy\right| \\
  %       &\le \int_{|x-y-he_i| < 4h} \frac{1}{h} \left| \frac{1}{|x-y-he_i|}-\frac{1}{|x-y|}\right| |f(y)| \, dy \\
  %       &\le \int_{|x-y-he_i| < 4h} \frac{1}{|x-y-he_i||x-y|}|f(y)| \, dy \\
  %       &\le \|f\|_{L^\infty} \int_{|x-y-he_i| < 4h} \left[\frac{1}{|x-y-he_i|^2}+\frac{1}{|x-y|^2}\right]\, dy
  %     \end{align*}
  %     Here:
  %     \begin{align*}
  %       \int_{|x-y-he_i| < 4h} \frac{1}{|x-y-he_i|^2} \, dy 
  %       &= \int_{|y| < 4h} \frac{1}{|y|^2} \, dy = const.\ h \xrightarrow{h \to 0} 0
  %     \end{align*}
  %     \begin{align*}
  %       \int_{|x-y-he_i| < 4h} \frac{1}{|x-y|^2} \, dy \\
  %       &\le \int_{|x-y| \le 5h} \frac{1}{|x-y|^2} \, dy \\
  %       &= \int_{|y| \le 5h} \frac{1}{|y|^2} \, dy ...
  %     \end{align*}
  %   \end{proof}
  %   To conclude: \(f \in C_c^1(\mathbb{R}^3)\). From the Lemma:
  %   \begin{align*}
  %     \frac{1}{|x|} \star f \in C^1
  %   \end{align*}
  %   and
  %   \begin{align*}
  %     \partial_{x_1} \left(\frac{1}{|x|} \star f\right)
  %     &= \frac{1}{|x|}\star\left(\partial_{x_i} f\right)
  %   \end{align*}
  %   \begin{align*}
  %     \frac{1}{|x|} \star \underbrace{(\partial_{x_i}f)} \in C^1
  %   \end{align*}
  %   and
  %   \begin{align*}
  %     \partial_{x_j} \frac{1}{|x|} \star \partial_{x_i}f =  ...
  %   \end{align*}
  % \end{proof}

  \begin{thm}[Liouville's Theorem] 
    If \(u \in C^2(\mathbb{R}^d)\) is harmonic and bounded, then \(u = const.\)
  \end{thm}

  \begin{proof}
    By the bound of the derivative \ref{estimates-of-derivatives} we have
    \begin{align*}
      |\partial_{x_i} u(x_0)| 
      &\le \frac{c_d}{r^{d+1}} \int_{B(x_0, r)} |u| \, dy \quad \forall x_0 \in \mathbb{R}^d\ \forall r > 0 \\
      &\le \|u\|_{L^\infty} \frac{c_d}{r^{d+1}} |B(x_0, r)| \\
      &\le \|u\|_{L^\infty} \frac{c_d}{r} \xrightarrow{r \to \infty} 0
    \end{align*}
    Thus \(\partial_{x_i} u = 0\) for all \(i = 1, 2, \dots d\) and \(u = const.\) in \(\mathbb{R}^d\)
  \end{proof}

  \begin{thm}[Uniqueness of solutions to Poisson Equation in \(\mathbb{R}^d\)]
    If \(u \in C^2(\mathbb{R}^d)\) is a bounded function and satisfies \(- \Delta u = f\) in \(\mathbb{R}^d\) where \(f \in C_c^2(\mathbb{R}^d)\), then we have
    \begin{align*}
      u(x) = \Phi \star f(x) + C = \int_{\mathbb{R}^d} \Phi(x-y)f(y) \, dy + C \quad \forall x \in \mathbb{R}^d
    \end{align*}
    where \(C\) is a constant and \(\Phi\) is the fundamental solution of the Laplace equation in \(\mathbb{R}^d\).
  \end{thm}

  \begin{proof}
    If we can prove that \(v\) is bounded, then \(v = const.\). We first need to show that \(\Phi \star f\) is bounded.
    \begin{align*}
      \Phi = \Phi_1 + \Phi_2 = \Phi \mathbb{1}(|x| \le 1) + \Phi(|x| \ge 1) \\
      \Phi \star f = \Phi_1 \star f + \Phi_2 \star f
    \end{align*}
    We have \(\Phi_1 \star f \in L^1(\mathbb{R}^d)\) and \(\Phi_2 \star f\) is bounded since \(\Phi \to 0\)  as \(|x| \to \infty\)  in \(d \ge 3\).
  \end{proof}

  \begin{ex} (Hanack's inequality)
    Let \(u \in C^2(\mathbb{R}^d)\) be harmonic and non-negative. Prove that for all open, bounded and connected \(\Omega \subseteq \mathbb{R}^d\), we have
    \begin{align*}
      \sup_{x \in \Omega} u(x) \le C_\Omega \inf_{x \in \Omega} u(x),
    \end{align*}
    where \(C_\infty\) is a finite constant depending only on \(\Omega\).
  \end{ex}

  \begin{proof} (Exercise)
    Hint: \(\Omega = B(x,r)\). General case cover \(\Omega\) by finitely many balls, one ball is inside \(\Omega\).
  \end{proof}


  \chapter{Convolution, Fourier Transform and Distributions}

  \section{Convolutions}
  \begin{defn}[Convolution]
    Let \(f, g: \mathbb{{R}^d \to \mathbb{R}}\) or \(\mathbb{C}\).
    \begin{align*}
      (f \star g)(x)
      &= \int_{\mathbb{R}^d} f(x-y) g(y) \, dy
      = \int_{\mathbb{R}^d} f(y) g(x-y) \, dy 
      = (g \star f)(x)
    \end{align*}
  \end{defn}

  \begin{rem}[Properties of the Convolution]
    \begin{itemize}
      \item \((f \star g)(x) = f \star (g \star h)\)
      \item \(\hat{f \star g} = \hat f \star \hat g\)
    \end{itemize}
  \end{rem}


  \begin{thm}[Young Inequality]
    If \(f \in L^1(\mathbb{R}^d)\) and \(g \in L^p(\mathbb{R}^d)\), where \(1 \le p \le \infty\), then \(f \star g \in L^p(\mathbb{R}^d)\) and \(\|f \star g \|_{L^p} \le \|f\|_{L^1} \|g\|_{L^p}\). More generally, if \(f \in L^p(\mathbb{R}^d), g \in L^q(\mathbb{R}^d)\), then \(f \star g \in L^1(\mathbb{R}^d)\), \(\| f \star g\|_{L^1} \le \|f\|_{L^p} \|g\|_{L^q}\), where \(1 \le p, q, r, \le \infty\), \(\frac{1}{p} + \frac{1}{q} = 1 + \frac{1}{r}\)
  \end{thm}

  \begin{proof}
    Let \(f \in L^1, g \in L^p\). With the Hölder Inequality \ref{hölder-inequality}, we have:
    % \begin{align*}
    %   \left|(f \star g)(x)| 
    %   &= \left| \int_{\mathbb{R}^d} f(x-y)g(y) \, dy \right| \\
    %   &\le \left(\int_{\mathbb{R}^d} |f(x-y)| \, dy\right)^{\frac{1}{q}} \left(\int_{\mathbb{R}^d} |f(x-x)| |g(y)|^p \, dy \right)^{\frac{1}{p}} \\
    %   &= \| f \|_{L^1}^{\frac{1}{q}} \left(\int_{\mathbb{R}^d} \dots \right)^{\frac{1}{p}}
    % \end{align*}
    \begin{align*}
      \|f \star g\|_{L^p}^p
      &= \int_{\mathbb{R}^d} |f \star g(x)|^p \, dx \\
      &\le \|f\|_{L^1}^{\frac{p}{q}} \int_{\mathbb{R}^d} \int_{\mathbb{R}^d} |f(x-y)||g(y)|^p \, dy \, dx \\
      &= \| f \|_{L^1}^{\frac{p}{q} + 1} \|g\|_{L^p}^p
    \end{align*}
    So we have \(\| f \star g \|_{L^p} \le \|f\|_{L^1} \|g\|_{L^p}\)
  \end{proof}

  \begin{thm}[Smoothness of the Convolution]
    If \(f \in C_c^\infty(\mathbb{R}^d),\ g \in L^p(\mathbb{R}^d),\ 1 \le p \le \infty\). Then \(f \star g \in C^\infty(\mathbb{R})\) and 
    \[D^\alpha (f\star g) = (D^\alpha f) \star g\]
    for all \(\alpha = (\alpha_1, \dots, \alpha_d), \alpha_i \in \{0, 1, 2, \dots\}\)
  \end{thm}

  \begin{proof}
    First we note that \(x \mapsto (f \star g)\) is continous as \(x_n \to x\) in \(\mathbb{R}^d\) since
    \begin{align*}
      (f \star g)(x_n) 
      &= \int_{\mathbb{R}^d} f(x_n - y) g(y) \, dy \xrightarrow{\text{dom. conv.}} \int_{\mathbb{R}^d} f(x-y) g(y) \, dy = (f \star g)(x)
    \end{align*}
    We can apply Dominated convergence because 
      \[f(x_n - y)g(y) \to f(x-y)g(y)\quad  \forall y \text{ as \(f\) is continuous and } x_n \to x\]
      and
      \[|f(x_n -y)\ g(y)| \le \|f\|_{L^\infty} |g(y)| \ \mathbb{1}(|y| \le R) \in L^1(\mathbb{R}^d).\]
      Where \(R > 0\) satisfies \(B(0, R) \supseteq \supp f + \sup_n |x_n|\).
      Now we can compute the derivatives:
      \begin{align*}
        \partial_{x_i} (f \star g)(x)
        &= \lim_{h \to 0} \frac{(f \star g)(x + he_i) - (f \star g)(x)}{h} \\
        &= \lim_{h \to 0} \int_{\mathbb{R}^d} \frac{f(x + he_i - y) - f(x-y)}{h} g(y) \, dy \\
        \text{(Dominated Convergence)} \quad &= \int_{\mathbb{R}^d}\lim_{h \to 0} \frac{f(x + he_i - y) - f(x-y)}{h} g(y) \, dy \\
        &= \int_{\mathbb{R}^d} (\partial_{x_i} f)(x-y) g(y) \, dy
      \end{align*}
      We could apply Dominated Convergence since
      \begin{align*}
        \frac{f(x + he_i -y) - f(x-y)}{h} g(y) \xrightarrow{h \to 0} (\partial_{x_i} f) (x-y) g(y) \quad \text{as \(f \in C^1\)} \\
        \left| \frac{f(x + h e_i -y) - f(x-y)}{h} g(y) \right| \le \| \partial_{x_i} f \|_{L^\infty} |g(y)| \ \mathbb{1}(|y| \le R) \in L^1(\mathbb{R}^d)
      \end{align*}
      where \(B(0, R) \supseteq \supp(f) + B(0, |x| + 1)\)
      and \(\partial_{x_i} (f \star g) = (\partial_{x_i} f) \star g \in C(\mathbb{R}^d)\) since \(\partial_{x_i} f \in C_c^\infty(\mathbb{R}^d)\).
      By induction we get \(D^\alpha (f \star g) = (D^\alpha f \star g) \in C(\mathbb{R}^d)\).
  \end{proof}


  \begin{rem}
      Question: Is there a \(f\) s.t. \(f \star g = g\) for all \(g\). In fact there is no regular function \(f\) that solves this formally:
      \[f \star g = g \Rightarrow \widehat{f \star g} = \hat g \Rightarrow \hat f \hat g = \hat g\ \Rightarrow \hat f = 1 \Rightarrow f \text{ is not a regular function!}\]

      However, if \(f\) is the Dirac-Delta Distribution, \(f = \delta_0\) then \(\delta_0 \star g = g\) for all \(g\). Formally:
      \begin{align*}
        \delta_0(x) &= \begin{cases}
          0 &x \ne 0 \\
          \infty &x = 0 \\
          \int \delta_0 = 1
        \end{cases}
      \end{align*}
      In fact, if \(f \in L^1(\mathbb{R}^d)\), \(\int f = 1\), \(f_\epsilon(x) = \epsilon^{-d} f(\epsilon^{-1} x)\), then \(f_\epsilon \to \delta_0\) in an appropriate sense and \(f_\epsilon \star g \to g\) for all \(g\) nice enough.
  \end{rem}
  
  \begin{thm}[Approximation by convolution]
    Let \(f \in L^1(\mathbb{R}^d)\), \(\int f = 1\), \(f_\epsilon(x) = \epsilon^{-d} f(\frac{x}{\epsilon})\). Then for all \(g \in L^p(\mathbb{R}^d)\), where \(1 \le p < \infty\), then
    \[f_\epsilon \star g \to g \quad \text{in } L^p(\mathbb{{R}^d})\]
  \end{thm}

  \begin{proof}\
    \begin{enumerate}[label=Step \arabic*:]
      \item Let \(f, g \in C_c(\mathbb{R}^d)\). Then
      \begin{align*}
        (f_\epsilon \star g)(x) - g(x) 
        &= \int_{\mathbb{R}^d} f_\epsilon(y) g(x-y) \, dy - \int_{\mathbb{R}^d} f_\epsilon(y) g(x) \, dy \\
        &= \int_{\mathbb{R}^d} f_\epsilon(y) (g(x-y) - g(x)) \, dy \\
        |(f_\epsilon \star g)(x) - g(x)| 
        &= \left| \int_{\mathbb{R}^d} f_\epsilon(y) (g(x-y) - g(x)) \, dy \right| \\
        &\le \int_{\mathbb{R}^d} |f_\epsilon(y)| |g(x-y) - g(x)| \, dy \\
        &\le \int_{|y| \le R_\epsilon} |f_\epsilon(y)||g(x-y) - g(x)| \, dy \\
        &\le \underbrace{\int_{|y| \le R_\epsilon} |f_\epsilon(y)| \, dy}_{\le \|f_\epsilon\|_{L^1} = \|f\|_{L^1}} \left[\sup_{|z| \le R} |g(x-z) - g(x)| \right] 
        \xrightarrow{\epsilon \to 0} 0
      \end{align*}
      We have Dominated Convergence since:
      \[(f_\epsilon \star g)(x) - g(x) \to 0 \quad \text{as } \epsilon \to 0\]
      and
      \[|f_\epsilon \star g(x) - g(x)| \le \|f\|_{L^1} \sup_{|z| \le R_\epsilon} |g(x-z) - g(x)| \le 2 \|f\|_1 \|g\|_{L^\infty} \mathbb{1}(|x| \le R_1).\]
      Where \(B(0, R_1) \supseteq \supp(g) + B(0, R_\epsilon)\), thus
      \(f_\epsilon \star g \to g\) in \(L^p(\mathbb{R}^d)\). To remove the technical assumptions \(f, g \in C_c(\mathbb{R}^d)\), then we use a density argument. We use the fact that \(C_c(\mathbb{R}^d)\) is dense in \(L^p(\mathbb{R}^d)\), \(1 \le p < \infty\).
      \item Let \(g \in C_c(\mathbb{R}^d), g \in L^p(\mathbb{R}^d)\). Then there is \(\{g_m\} \subseteq L^p(\mathbb{R}^d), g_m \to g\) in \(L^p(\mathbb{R}^d)\). Then 
      \begin{align*}
        \|f_\epsilon \star g - g\|_{L^p} 
        &\le \|f_\epsilon \star (g - g_m)\|_{L^p}  + \|f_\epsilon \star g_m - g_m \|_{L^p}+ \|g_m - g\|_{L^p} \\
        \text{(Young)} \quad &\le \|f_\epsilon\|_{L^1}\|g-g_m\|_{L^p}  + \|f_\epsilon \star g_m - g_m \|_{L^p}+ \|g_m - g\|_{L^p} \\
        &\le \|f\|_{L^1}\|g-g_m\|_{L^p}  + \|f_\epsilon \star g_m - g_m \|_{L^p}+ \|g_m - g\|_{L^p} \\
        &\le (\|f\|_{L^1} + 1) \|g - g_m\|_{L^p} + \|f \star g_m - g_m\|_{L^p}
      \end{align*}
      
      So we get:
      \begin{align*}
        \limsup_{\epsilon \to 0} \|f_\epsilon \star g - g\|_{L^p} 
        &\le (\|f\|_{L^p} + 1) \|g - g_m\|_{L^p} + \underbrace{\limsup_{\epsilon \to 0} \|f_\epsilon \star g_m - g_m\|_{L^p}}_{0 \text{by step 1.}} \\
        \xrightarrow{m \to \infty} 0
      \end{align*}
      \item Let \(f \in L^1(\mathbb{R}^d)\) and \(g \in L^p(\mathbb{R}^d)\). Take \(\{f_m\} \subseteq C_c(\mathbb{R}^d)\), s.t. 
      \begin{align*}
        \begin{cases}
          F_m \to g in L^1(\mathbb{R}) \text{ as } m \to \infty \\
          \int_{\mathbb{R}^d} F_m = 1 (\text{it is possible since } \int_{\mathbb{R}^d}) f = 1)
        \end{cases}
      \end{align*} 
      Define \(F_{m, \epsilon}(x) = \epsilon^{-d} F_m(\epsilon^{-1} x)\) (recall \(f_\epsilon(x) = \epsilon^{-d} f(\epsilon^{-1} x)\)). Then:
      \begin{align*}
        f_\epsilon \star g - g &= (f_\epsilon - F_{m, \epsilon}) \star g + F_{m, \epsilon} \star g -g \\
        \Rightarrow \|f_\epsilon - g \|_{L^p} &\le \underbrace{\|f_\epsilon - F_{m, \epsilon} \star g\|_{L^p}}_{\mathclap{\overset{\text{Young}}{\le} \|f_\epsilon - F_{m, \epsilon}\|_{L^1} \|g\|_{L^p} = \|f - F_m\|_{L^1} \|g\|_{L^p}}} + \|F_{m, \epsilon} \star g - g\|_{L^p} \\
        \Rightarrow \limsup_{\epsilon \to 0} \|f_\epsilon \star g - g\|_{L^p} &\le \|f - F_m\|_{L^1} \|g\|_{L^p} = \|f - F_m\|_{L^1} \|g \|_{L^p} \qedhere
      \end{align*}
    \end{enumerate}
  \end{proof}

  
  \begin{lem}
    \(C_c(\mathbb{{R}^d})\) is dense in \(L^p(\mathbb{R}^d)\), \(1 \le p < \infty\)
  \end{lem}

  \begin{proof}
    For all \(g \in L^p(\mathbb{R}^d)\) there are \(g_m\) step functions and \(g_m \to m\) in \(L^p(\mathbb{R}^d)\),
    % \[g_m(x) = \sum_{\substack{\Omega \\ \text{{finite sum} \\ \Omega \subseteq \mathbb{R}^d \text{measurable}}}} \chi_\Omega(x) a_\Omega\]
    We can assume that \(\Omega\) is open and bounded and we want to approximate \(\chi_\Omega\) by \(C_c(\mathbb{R}^d)\). 
  \end{proof}

  \begin{lem}[Urnson]
    Define 
    \[\Omega_\epsilon = \{x \in \Omega \mid \dist(x, \partial \Omega) > \epsilon\}\]
    Then there is a \(\eta_\epsilon \in C_c(\mathbb{R}^d)\) s.t.
    \begin{align*}
      \begin{cases}
        0 \le \eta(x) \le 1 & \forall x \in \mathbb{R}^d \\
        \eta_\epsilon(x) = 1 & \text{if } x \in \Omega_\epsilon \\
        \eta_\epsilon(x) = 0 & \text{if } x \notin \Omega
      \end{cases}
    \end{align*}
  \end{lem}

  \begin{lem}[Gernal Version of Urnson]
    If \(A, B \subseteq \mathbb{R}^d\), \(A\) closed, \(B\) closed, \(A \cap B = \emptyset\). Then
    \[\eta(x) = \frac{\dist(x, A)}{\dist(x, A) + \dist(x, B)}\]
    Then \(\eta \in C(\mathbb{R}^d)\), \(0 \le \eta \le 1\) and \(\eta = 0\)if \(x \in B\), \(\eta = 1\) if \(x \in A\). App to \(A = \overline{\Omega_\epsilon} \subset \subset \Omega\) and \(B = \mathbb{R}^d \setminus \Omega\).
  \end{lem}

  
  \begin{thm}[Appendix C4 in Evans]
    Let \(\Omega\) be open in \(\mathbb{R}^d\) and for \(\epsilon > 0\) define
    \[\Omega_\epsilon = \{x \in \Omega \mid \dist(x, \mathbb{R}^d \setminus \Omega) > \epsilon\}\]
    Let \(f \in C_c^\infty(\mathbb{R}^d), \int_{\mathbb{R}^d} f = 1, \supp f \subseteq B(0, 1), f_\epsilon(x) = \epsilon^{-d} f(\epsilon^{-1} x) \supp\) is \(B(0, \epsilon)\). Then for all \(g \in L_{loc}^p(\Omega)\) (i.e. \(\mathbb{1}_K g \in L^p(\Omega) \forall K\) compakt set in \(\Omega\)), then:
    \begin{enumerate}[label=\alph*)]
      \item \(g_\epsilon(x) = (f_\epsilon \star g)(x) = \int_{\mathbb{R}^d} f_\epsilon(x-y) g(y) \, dy - \int_\Omega f_\epsilon(x-y) g(y) \, dy\) is well-defined in \(\Omega_\epsilon\) and \(g_\epsilon \in C^\infty(\Omega_\epsilon)\).
      \item \(g_\epsilon \to g\) in \(L_{loc}^p(\Omega)\) if \(1 \le p < \infty\) and \(g_\epsilon(x) \to g(x)\) almost everywhere \(x \in \Omega\).
      \item If \(g \in C(\Omega)\), then \(g_\epsilon(x) \to g(x)\) uniformly in any compact subset of \(\Omega\).
    \end{enumerate}
  \end{thm}

  \begin{proof}
    \begin{enumerate}[label=\alph*)]
      \item \(D^\alpha(g_\epsilon) = (D^\alpha f_\epsilon) \star g \in C(\Omega_\epsilon)\)
      % \item Replace \(g \mapsto \mathbb{1}_K g\) where \(K\) is a compact set \(\subbseteq \Omega\). Then \(\mathbb{1}_K g \in L^p\). Then our theorem \(f_\epsilon \star (\mathbb{1}_K g) \to \mathbb{1}_K g\) in \(L^p(\Omega)\). On the other hand \(\mathbb{1}_K[(f_\epsilon \star \mathbb{1}_K g) - (f_\epsilon \star g)] \to 0\) as \(\epsilon \to 0\) (exercise)
      \item Already proved in \(\mathbb{R}^d\) space.
    \end{enumerate}
  \end{proof}

  
  \begin{cor}[Lebesgue differentation theorem]
    If \(f \in L_{loc}^P(\mathbb{R}^d)\), then
    \begin{align*}
      \fint_{B(x, \epsilon)} |f(y) - f(x)|^p \, dy \to 0 \quad \text{ as } \epsilon \to 0
    \end{align*}
  \end{cor}


  \begin{ex}[E 2.1]
    Let \(u \in C^2(\mathbb{R}^2)\) be convex. I.e.
    \begin{align*}
      t u(x) + u(y) (1-t) \ge u(tx + (1-t)y) \forall x,y \in \mathbb{R}^d \forall t \in [0,1]
    \end{align*}
    \begin{enumerate}[label=\alph*)]
      \item Prove for all \(x \in \mathbb{R}^d\) that \(H(x) =  \) ...
    \end{enumerate}
  \end{ex}
  
  \begin{proof}[Solution]\
    \begin{enumerate}[label=\alph*]
      \item In 1D: If \(u\) is convex \(\Leftrightarrow\) \(u''(x) \ge 0\) for all \(x \in \mathbb{R}\). In general: Taylor expansion for all \(x,z \in \mathbb{R}^d\):
      \begin{align*}
        u(x) &= u(z) + \nabla u(z)(x-y) + \int_0^1 \sum_{|\alpha| = 2} D^\alpha u(z + s(x-z)) \frac{(x-z)^\alpha}{\alpha!} \, ds
      \end{align*}
      \(x = z + s(x-z), s= 1\)
      Use \(z = tx + (t-1)y\) \(\Rightarrow\) \(x-z = (1-t)(x-y)\)
      \begin{align*}
        t u(x) &= tu(z) + t\nabla u(z) (1-t)(x-y) + t\int_0^1 \sum_{|\alpha| = 2} D^\alpha u(z + s(x-z)) \frac{\left[(1-t)(x-y)\right]^\alpha}{\alpha!} \, ds \\
        (1-t) u(y) &= (1-t)u(z) + (1-t)\nabla u(z) t (y-x) + (1-t)\int_0^r \sum_{|\alpha| = 2} D^\alpha u(z + s(y-z)) \frac{[t(y-x)]^\alpha}{\alpha!} \, ds
      \end{align*}
      \begin{align*}
        \Rightarrow t u(x) + (1-t) u(y) = u(z) + t \int_0^1 ... + (1-t) \int_0^1 ... \\
        \Rightarrow t \int_0^1 ... + (1-t) \int_0^1 ... \ge 0 \forall x,y,t,z = tx + (1-t)y
      \end{align*}
      
      \begin{align*}
        t(1-t)^2 \int_0^1 \sum_{|\alpha| = 2} D^\alpha u(z + s(x-z)) \frac{(x-y)}{\alpha!} \, ds + (1-t) t^2 \int_0^1 \sum_{|\alpha| = 2} D^\alpha u(z + s(y-z)) \frac{(y-z)^\alpha}{\alpha!} \,ds \ge 0
      \end{align*}
      for all \(x,y \in \mathbb{R}^d, t \in [0,1], z = tx+ (1-t)y\). Divides for \(t(1-t)\)
      \begin{align*}
        (1-t) \int_0^1 \dots + + \int_0^1 \dots \ge 0
      \end{align*}
      Take \(t \to 0\)
      \begin{align*}
        \int_0^1 \sum_{|\alpha| = 2} D^\alpha u(y + s(x-y)) \frac{(x-y)^\alpha}{\alpha!} \, ds \ge 0 \forall x,y \in \mathbb{R}^d
      \end{align*}
      Take \(y = x +a, a \in \mathbb{R}^d\)
      \begin{align*}
        \int_0^1 \sum_{|\alpha| = 2} D^\alpha u(x +a+sa) \frac{a^\alpha}{\alpha!} \, ds \ge 0 \forall \epsilon > 0, \forall x,a \in \mathbb{R}^d
      \end{align*}
      Take \(\epsilon \to 0\)
      \begin{align*}
        \int_0^1 \sum_{|\alpha| = 2} D^\alpha u(x) \frac{a^\alpha}{\alpha!} \ge 0 \Rightarrow \sum_{i,j = 1, i \ne j}\partial_{x_i} \partial_{x_j} u(x) a_i a_j + \sum_{i=j=1}^d \partial_{x_i}^2 u(x) \frac{a_i^2}{2}
      \end{align*}
      We get
      \begin{align*}
        \frac{1}{2} a^T Ha \ge 0 \forall a(a_i)_{i=1}^d \in \mathbb{R}^d
      \end{align*}
      \item \(H(x) \ge 0 \Rightarrow \left(\partial_i \partial_j u\right) \ge 0 \Rightarrow Tr H(x) \ge 0 \Rightarrow \sum_{i=1}^d \partial_{x_i}^2 u(x) \ge 0 \Rightarrow \Delta u(x) \ge 0 \forall x \in \mathbb{R}^d\)
    \end{enumerate}
  \end{proof}

  
  \begin{ex}[E 2.2]
    
  \end{ex}

  \begin{proof}[Solution]
    Regard \(d = 3\). The function \(\frac{1}{|x|}\) is harmonic in \(\mathbb{R}^3 \setminus \{0\}\). We prove 
    \begin{align*}
      \fint_{\partial B(x, r)} \frac{dS(y)}{|y|} = \frac{1}{\max(|x|, r)}
    \end{align*}
    If \(|x| > r\), then \(0 \notin B(x,r + \epsilon)\). Then
    \[y \mapsto \frac{1}{|y|}\] is harmonic in \(B(x, r  + \epsilon)\). Then by the Mean Value Property:
    \[\fint_{\partial B(x,r)} \frac{dS(y)}{|y|} = \frac{1}{|x|}\]
    If \(|x| < r\): Then \(\frac{1}{|y|}\) is not harmonic in \(B(x,r)\) since \(0 \in B(x,r)\). Note
    \begin{align*}
      \fint_{\partial B(x,r)} \frac{d S(y)}{|y|} 
      &= \fint_{\partial B(0, r)} \frac{dS(y)}{|x-y|}
    \end{align*}
    This function depends on \(x\) only via \(|x|\). 
    \begin{align*}
      ... &= \fint_{\partial B(0,r)} \frac{dS(y)}{|Rx-Ry|}
    \end{align*}
    for all \(R\) rotation \(SO(3)\), \(dS(R_y) = dS(y)\)
    \begin{align*}
      &= \fint_{\partial B(0, r)} \frac{dS(y)}{|Rx - y|} \\
      &= \fint_{\partial B(0, r)} \frac{dS(y)}{|z - y|} \\
      \text{(Radial in z)} \quad &= \fint_{\partial B(0, |x|)} \left(\fint_{\partial B(0, r)} \frac{dS(y)}{|z-y|}\right) \, dS(z) \\
      (\text{Fubini}) \quad &= \fint_{\partial B(0,r)} \left(\fint_{\partial B(0, |x|)} \frac{dS(z)}{|z-y|}\right) \, dS(y) \\
      (\text{case 1 since \(|y| = r > |x|\))} \quad &= \fint_{\partial B(0,r)} \frac{1}{|y|} \, dS(y)
      = \frac{1}{r}
    \end{align*}
    If \(|x| = r\): Continuity: \(x \mapsto \fint_{\partial B(0, r)} \frac{dS(y)}{|x-y|}\)
  \end{proof}

  \begin{rem}
    For \(f \in C^{|\alpha|}, g \in C^{|\beta|}\):
    \begin{align*}
      D^{\alpha + \beta}(f \star g) = (D^\alpha f)\star(D^\beta g)
    \end{align*}
  \end{rem}

  
  \begin{lem}
    If \(d \ge 3\) and \(f: \mathbb{R}^d \to \mathbb{R}\) radial. Then:
    \begin{align*}
      \left(\frac{1}{|x|^{d-2}} \star f \right)(x) 
      = \int_{\mathbb{R}^d} \frac{f(y)}{|x-y|^{d-2}} \, dy \\
      = \int_{\mathbb{R}^d} \frac{f(y)}{\max(|x|^{d-2}, |y|^{d-2})}\, dy
    \end{align*}
  \end{lem}
  \begin{proof}
    (d=3) Polar coordinates:
    \begin{align*}
      \int_{\mathbb{R}^3} \frac{f(y)}{|x-y|}\, dy 
      &= \int_0^{\infty} \left[\int_{\partial B(0,1)} \frac{1}{|x-rw|} \, d\omega \right] \, f(r) \, dr \\
      (a) \quad &= \int_0^\infty \left[\int_{\partial B(0,1)} \frac{d \omega}{\max(|x|, r)}\right] f(r) \, dr \\
      &= \int_{\mathbb{R}^3} \frac{f(y)}{\max(|x|, |y|)} \, dy
    \end{align*}
    (b) (d=3) If \(f\) radial and non-negative
    \begin{align*}
      \int_{\mathbb{R}^3} \frac{f(y))}{|x-y|} &= \int_{\mathbb{R}^3} \frac{f(y)}{|x|} \, dy = \frac{(Sf?)}{|x|}
    \end{align*}
    Then
    \begin{align*}
      \int_{\mathbb{R}^3}\int_{\mathbb{R}^3} \frac{f_1(x-z_1)f_2(y-z_2)}{|x-y|} \, dx \, dy &= \int_{\mathbb{R}^3}\int_{\mathbb{R}^3} \frac{f_1(x) f_2(y)}{|x+ z_1 - y - z_2} \, dx \, dy \\
      &= \int_{\mathbb{R}^3} \left(\int_{\mathbb{R}^3} f_1(x) \, dx \right) f_2(y) \, dy \le \int_{\mathbb{R}^3} \frac{\left(\int_{\mathbb{R}^3} f_1\right)}{|y + z_2 - z_1|} f_2(y) \, dy \\
      &\le \frac{(\int_{\mathbb{R}^3} f_1)(\int_{\mathbb{R}^3} f_2)}{|z_1 - z_2|}
    \end{align*}
  \end{proof}

  
  \begin{ex}[Bonus 2]
    \begin{enumerate}[label=\alph*)]
      \item Prove that \(u(x) = \frac{1}{|x|}\) is sub-harmonic in \(\mathbb{R}^2 \setminus \{0\}\). 
      \item Prove that if \(f: \mathbb{R}^2 \to \mathbb{R}\) radial, non-negative, measurable:
      \begin{align*}
        \int_{\mathbb{R}^2} \frac{f(y)}{|x-y|} \, dy \ge \int_{\mathbb{R}^2} \frac{f(y)}{\max(|x|, |y|)} \, dy
      \end{align*}
    \end{enumerate}
  \end{ex}

  \section{Fourier Transformation}
  \begin{defn}[Fourier Transform]
    For \(f \in L^1(\mathbb{R}^d)\) define
    \[\four f(k) = \hat f(k) = \int_{\mathbb{R}^d} f(x) e^{- 2 \pi i k \cdot x} \, dx, \quad k\cdot x = \sum_{i=1}^d k_i x_i\]
  \end{defn}

  
  \begin{thm}[Basic Properties]
    \begin{enumerate}
      \item If \(f \in L^1(\mathbb{R}^d)\), then \(\hat f \in L^\infty(\mathbb{R}^d)\) and \(\| \hat f \|_{L^\infty} \le \|f\|_{L^1}\)
      \item For all \(f \in L^1(\mathbb{R}^d) \cap L^2(\mathbb{R}^d)\), \(\|\hat f\|_{L^2} = \|f\|_{L^2}\). Moreover, \(\four\) can be extended to be a unitary transforamtion \(L^2(\mathbb{R}^d) \to L^2(\mathbb{R}^d)\) s.t.
      \[\|\four g\|_{L^2} = \|f\|_{L^2} \quad \forall f \in L^2(\mathbb{R}^d)\]
      \item The inverse of \(F\) can be defined as
      \[(F^{-1}f)(x) = \check f (x) = \int_{\mathbb{R}^d} f(x) e^{2 \pi ik x} \, dk\] for all \(f \in L^1(\mathbb{R}^d) \cap L^2(\mathbb{R}^d)\)
      \item \(\widehat{D^\alpha f}(k) = (2 \pi i k)^\alpha \hat f(k)\) as \((2 \pi ik)^\alpha f(k) \in L^2(\mathbb{R}^d)\) (\(k^\alpha = k_1^{\alpha_1} \cdots k_\alpha^{\alpha_k}\))
      \item \(\widehat{f \star g}(k) = \hat f(k) \hat g (k)\) if \(f,g\) are nice enough.
    \end{enumerate}
  \end{thm}

  \begin{thm}[Hausdorff-Young-Inequality]\label{hausdorff-young}
    If \(1 \le p \le 2\), \(\frac{1}{p} + \frac{1}{p'} = 1\) and \(f \in L^p(\mathbb{R}^d) \cap L^1(\mathbb{R}^n)\) then
    \[\| \hat f \|_{L^{p'}} \le \|f\|_{L^p}\]
    and 
    \[\|\hat f\|_{L^p} \le \|f\|_{L^p} \quad \forall f \in L^p(\mathbb{R}^d)\]
  \end{thm}
  
  % \begin{rem}
  %   If \(1 \le p \le 2\) and \(f \in L^p(\mathbb{R}^d)\) we can write \(f = f_1 + f_2\) when \(f_1 \in L^1\), \(f_2 \in L^2\), e.g.
  %   \begin{align*}
  %     f = \underbrace{f \mathbb{1}(|f| \ge 1)}_{f_1} + \underbrace{f \mathbb{1}(|f| < 1)}_{f_2}
  %   \end{align*}
  %   \begin{align*}
  %     \int_{\mathbb{R}^d} |f_2|^2 \, dy &= \int_{\mathbb{R}^d}|f|^2 \mathbb{1}(|f| < 1) \le \int_{\mathbb{R}^d} |f|^p \, dy < \infty \\
  %     \int_{\mathbb{R}^d} |f_1| \, dy &= \int_{\mathbb{R}^d} |f| \mathbb{1}(|f| \ge 1) \le \int_{\mathbb{R}^d} |f|^p < \infty
  %   \end{align*}
  %   thus we can define \(\hat f = \hat f_1 + \hat f_2\) well defined in \(L^\infty(\mathbb{R}^d) + L^2(\mathbb{R}^d)\) what it in unclear why \(\hat f \in L^q\)?
  %   Proof of HY inequality. Weee nedd Riez-Theorem interpolation theorem. If \(1 \le p_0, p_1, q_0, q_1 \le \infty\), and \(\Omega \subseteq \mathbb{R}^d\) open and 
    % \[T: L^{p_0}(\Omega} + L^{p_1})(\Omega) \longrightarrow L^{q_0}(\Omega} + L^{q_1})(\Omega)\]
    % is a linear operator and
    % \begin{align*}
    %   T: \ L^{p_0} \to L^{q_0} \text{ and } \|T\|_{L^{p_1} \to L^{q_1}} \le 1, \quad \text{ for } i = 0, 1.
    %   \text{ Then } T: \ L^{p_0} \to L^{q_0} \text{ and } \|T\|_{L^{p_1} \to L^{q_1}} \le 1, \quad \text{ for any } 0 < \theta < 1, where \begin{cases}
    %     \frac{1}{p_0} = \frac{\theta}{p_0} + \frac{1 - \theta}{p_2} \\
    %     \frac{1}{q_0} = \frac{\theta}{q_0} + \frac{1 - \theta}{q_1}
    %   \end{cases}
    % \end{align*}
    % Consider the Foureir Transform:
    % \begin{align*}
    %   F: L^1 + L^1 \to L^2 + L^\infty 
    % \end{align*}
    % and
    % \begin{align*}
    %   \|F\|_{L^1 \to L^\infty} \le 1 \text{ as } \|\hat f\|_{L^\infty} \le \|f\|_{L^1} \forall f p \in L^1 \\
    %   \|F\|_{L^2 \to L^2} = 1 \text{ as } \| \hat f \|_{L^2} = \|f\|_{L^2} \forall f \in L^2 \\
    %   \Rightarrow \|F\|_{L^{p_0} \to L^{p_t}} \le 1 \forall \theta \in (0,1)
    % \end{align*}
    % \(p_0 = 1, p_1 = 2, q_0 = \infty, q_1 = 2\)
    % \begin{align*}
    %   \frac{1}{p_0} = \frac{\theta}{p_0} + \frac{1 - \theta}{p_2} = \theta + \frac{1 - \theta}{2} = \frac{1 + \theta}{2} \\
    %   \frac{1}{q_\theta} = \frac{\theta}{q_0} + \frac{1 - \theta}{q_1} = \frac{1 - \theta}{2} \\
    %   \Rightarrow \frac{1}{p_0} + \frac{1}{q_\theta}} = \frac{1 + \theta}{2} + \frac{1 - \theta}{2} = 1
    % \end{align*}
    % Thus: Let \(1 \le p,q,r \le 2\) s.t. \(\frac{1}{p} + \frac{1}{a} = 1 + \frac{1}{r}}\)
    % Let \(f \in L^p(\mathbb{R}^d)\), \(g \in L^q(\mathbb{R}^d)\). Recall \(f \star g \in L^r(\mathbb{R}^d)\) by Young. We have
    % \[\widehat{f \star g}(k) = \hat f(k) \hat g(k) \text{ a.e. k \in \mathbb{R}^d}\]
  
    
    % \begin{ex}
    %   Hint: first \(f,g \in C_c(\mathbb{R}^d)\) then use a density arugment)
    % \end{ex}

    % \begin{align*}
    %   \widehat{f \star g}(k) &= \int_{\mathbb{R}^d} (f \star g)(x) e^{-2 \pi i k x} \, dx = \int_{\mathbb{R}^d}\int_{\mathbb{R}^d} f(x-y) g(y) e^{-2 \pi i kx} \, dx \, dy \\
    %   = \int_{\mathbb{R}^d}\int_{\mathbb{R}^d} \left(f(x-y) e^{- 2 \pi i k(x-y)}\right) (g(y)) e^{- 2 \pi i k y}) \, dx \, dy \\
    %   &= \int_{\mathbb{R}^d} \left(\int_{\mathbb{R}^d} (f(x-y) e^{- 2 \pi i k (x-y)} \, dy)\right) (g(y) e^{ - 2 \pi i k y}) \, dy = \hat f(k) \hat g(k)
    % \end{align*}
    \begin{rem}
      We want to apply the Fourier transform to find the solution of a PDE, e.g. the Poisson-Equation:
      \begin{align*}
        - \Delta u = f \text{ in } \mathbb{R}^d
        \Rightarrow | 2 \pi k|^2 \hat u (k) = \hat f(k)
        \Rightarrow \hat u(k) = \frac{1}{|2 \pi k|^2} \hat f(k) 
      \end{align*}
      If we can find \(G\) s.t. \(\hat G(k)  = \frac{1}{|2 \pi k|^2}\), then
      \begin{align*}
        \hat u(k) &= \hat G(k) \hat f(k) = \widehat{G \star f} \\
        \Rightarrow u(x) &= (G \star f) (x) = \int_{\Rd} G(x-y)f(y)\, dy
      \end{align*}
      In fact \(G\) is the fundamential solution of laplace quation.
  \end{rem}

  
  \begin{thm}[Fourier Transform of \(\frac{1}{|x|^\alpha}\) for \(0 < \alpha < d\)] We have formally
    \begin{align*}
      \widehat{\frac{c_\alpha}{|x|^\alpha}} = \frac{c_{d-\alpha}}{|k|^{d - \alpha}} \quad \forall\ 0 < \alpha < d
    \end{align*}
    Here
    \begin{align*}
      c_\alpha = \pi^{- \frac{d}{2}} \Gamma \left(\frac{\alpha}{2} \right) = \pi^{- \frac{\alpha}{2}} \int_0^\infty e^{-\lambda} \lambda^{\frac{\alpha}{2}-1} \, d\lambda
    \end{align*}
    More precisely, for all \(f \in C_c^\infty(\mathbb{R}^d)\), 
    \begin{align*}
      \frac{c_\alpha}{|x|^\alpha}\star f = \left(\frac{c_{d-\alpha}}{|k|^{d - \alpha}} \hat f (k)\right)^\lor
    \end{align*}
    Moreover if \(\alpha > \frac{d}{2}\), then we also have
    \begin{align*}
      \left(\frac{c_\alpha}{|x|^\alpha} \star f\right)^\land = \frac{c_{d - \alpha}}{|f|^{d-\alpha}} \hat f (k)
    \end{align*}
  \end{thm}

  % \begin{rem}
  %   If \(f \in L^p\), \(1 \le p \le 2\) \(\Rightarrow\) \(f = \underbrace{f_1}_{\in L^1} + \underbrace{f_2}_{\in L^2} \Rightarrow \hat f = \hat f_1 + \hat f_2\) \\
  %   Question: If \(f = \tilde f_1 + \tilde f_2\), where \(\tilde f_1 \in L^1\) and \(\tilde f_2 \in L^2\), do we have that \(\hat f_1 + \hat f_2 = \widehat{\tilde{f_1}} + \widehat{\tilde{f_2}} \in L^1 \cap \L^2\)?
  %   In fact:
  %   \begin{align*}
  %     f_1 + f_2 &= \tilde f_1 + \tilde f_2  \\
  %     \Rightarrow \underbrace{f_1 - \tilde f_1}_{\in L^1} = \Rightarrow \underbrace{\tilde f_2 - f_2}_{\in L^2} \in L^1 \cap L^2 \\
  %     \Rightarrow \hat f_1 - \hat{\tilde f_1} = \widehat{\tilde f_2}- \hat f_2 \Rightarrow \hat f_1 + \hat f_2 = \widehat{\tilde f_1} + \widehat{\tilde f_2}.
  %   \end{align*}
  % \end{rem}
  
  \begin{lem}[Fourier Transform of Gaussians] In \(\Rd\),
    \[\widehat{e^{- \pi |x|^2}} = e^{- \pi |k|^2}\]
    More generally for all \(\lambda > 0\):
    \[\widehat{e^{- \pi \lambda^2 |x|^2}} = \lambda^{-d} e^{-\pi \frac{|k|^2}{\lambda^2}}\]
    (exercise)
  \end{lem}

  \begin{proof}[Proof of Theorem]
    Formally:
    \begin{align*}
      \frac{c_\alpha}{|x|^\alpha} &= \frac{1}{|x|^\alpha} \pi^{- \frac{\alpha}{2}} \int_0^\infty e^{-\lambda} \lambda^{\frac{\alpha}{2} -1} \, d \lambda = \int_0^\infty e^{- \pi \lambda |x|^2} \lambda^{\frac{\alpha}{2}-1} \, d \lambda \\
      \Rightarrow \frac{\hat c_\alpha}{|x|^\alpha}(k) &= \int_0^\infty \widehat{e^{- \pi \lambda |x|^2}}(k) \lambda^{\frac{\alpha}{2}-1} \, d \lambda = \int_0^\infty \lambda^{-\frac{d}{2}} e^{- \pi \frac{|k|^2}{\lambda}} \lambda^{\frac{\alpha}{2}-1} \, d \lambda \\
      (\lambda \to \frac{1}{\lambda}) \quad &= \int_0^\infty \lambda^{\frac{d}{2} e^{- \pi |k|^2 \lambda}} \lambda^{- \frac{\alpha}{2} + 1} \lambda^{-2} \, d\lambda \\
      &= \frac{c_{d-\alpha}}{|k|^{d-\alpha}}
    \end{align*}

    Let \(f \in C_c(\Rd)\). Then \(\left(\frac{1}{|x|^\alpha} \star f\right)(x) = \int_{\Rd} \frac{1}{|x-y|^\alpha} f(y) \, dy\) is well defined as \(\frac{1}{|x-y|} \in L_{loc}^1(\mathbb{R}^d, dy)\). It is bounded
    \begin{align*}
      \frac{1}{|x|^\alpha} \star f = \frac{1}{|x|^\alpha} \underbrace{\mathbb{1}(|x| \le 1)}_{\in L^\infty(\Rd)} \star \underbrace{f}_{L^\infty} + \underbrace{\frac{1}{|x|} \mathbb{1}(|x| > 1)}_{\in L^\infty} \star \underbrace{f}_{\in L^1} \in L^\infty(\Rd)
    \end{align*}
    When \(|x| \to \infty\):
    \begin{align*}
      \left(\frac{1}{|x|^\alpha} \star f\right)(x) &= \int_{\Rd} \frac{f(y)}{|x-y|^\alpha} \, dy = \int_{|y| \le R} \frac{f(y)}{|x-y|^\alpha} \, dy \sim \frac{\int_{\Rd} f(y) \, dy}{|x|^\alpha}
    \end{align*}

    Note that \(\frac{c_{d-\alpha}}{|k|^{d-\alpha}} \underbrace{\hat f(k)}_{\text{bounded}} \in L^1(\Rd)\).
    \begin{align*}
      (...) \mathbb{1}(|k| \le 1) + (...) \mathbb{1}(|k|> 1)
      \frac{1}{|k|^{d - \alpha}}|\hat f(k)| \mathbb{1}(|k| \le 1) \le \|f\|_{L^1} \frac{\mathbb{1}(|k| \le 1)}{|k|^{d-\alpha}} \in L^1(\Rd, dk) \\
      \frac{1}{|k|^{d-\alpha}} |\hat f(k)| \mathbb{1}(k >1) \le |\hat f(k)| \in L^2(\Rd, dK) \text{ as } f \in L^2(\Rd)
    \end{align*}

    \begin{lem}
      If \(f \in C_c^\infty(\Rd)\), then \(\hat f \in L^1(\mathbb{R}^d)\)
    \end{lem}

    \begin{proof}(Exercise)
      Hint: \(|\widehat{D^\alpha f}| = |2 \pi k|^{|\alpha|} |\hat f(k)| \leadsto |\hat f(k)| \le \frac{1}{|k|^{|k|}}\) as \(|k| \to \infty\).
    \end{proof}

    Compute:
    \begin{align*}
      \left(\frac{c_{d-\alpha}}{|k|^{d-\alpha}} \hat f(k)\right)^\lor (x) 
      &= \int_{\Rd} \frac{c_{d-\alpha}}{|k|^{d-\alpha}} \hat f(k) e^{2 \pi i k x} \, dk \\
      &= \int_{\Rd} \left(\int_0^\infty e^{-\pi |k|^2 \lambda} \lambda^{\frac{d-\alpha}{2}-1} \, d \lambda \right) \hat f (k) e^{2 \pi i k x} \, dk \\
      &= \int_0^\infty \left(\int_{\Rd} e^{-\pi |k|^2 \lambda} \hat f (k) e^{2 \pi i k x} \, dk \right) \lambda^{\frac{d-\alpha}{2}-1} \, d \lambda \\
      &= \int_0^\infty \left(e^{- \pi k^2 \lambda} \hat f(x)\right)^\lor \lambda^{\frac{d-\alpha}{2} - 1} \, d \lambda \\
      &= \int_0^\infty \left(\widehat{\lambda^{-\frac{d}{2}} e^{- \pi \frac{x^2}{\lambda}}}(k) \hat f(k)\right)^\lor \lambda^{\frac{d-\alpha}{2} - 1} \, d \lambda \\
      &= \int_0^\infty \left(\lambda^{- \frac{d}{2}} e^{- \pi \frac{x^2}{\lambda}} \star f \right) \lambda^{\frac{d-\alpha}{2} - 1} \, d \lambda \\
      &= \left(\int_0^\infty \lambda^{- \frac{d}{2}} e^{- \pi \frac{x^2}{\lambda}}\lambda^{\frac{d-\alpha}{2} - 1} \, d \lambda \right) \star f
    \end{align*}
    Assume \(d > \alpha > \frac{d}{2}\). Then \(\frac{c_\alpha}{|x|^\alpha} \star f \in L^\infty\) and behaves \(\frac{c_\alpha(\int f)}{|x|^\alpha}\) as \(|x| \to \infty\). This implies:
    \begin{align*}
      \int_{\mathbb{R}^d} \left| \frac{c_\alpha}{|x|^\alpha} \star f \right|^2 \le c + \int_{|x| \ge R} \frac{c}{|x|^{2d}} \, dx < \infty 
    \end{align*}
    Thus the Fourier Transform \(\widehat{\frac{c_\alpha}{|x|^\alpha}} \star f\) exists. Combining with 
    \begin{align*}
      \frac{c_\alpha}{|x|^\alpha} \star f = \left(\frac{c_{d-\alpha}}{|f|^{d-\alpha}} \hat f(k) \right)^\lor \\
      \Rightarrow \widehat{\frac{c_\alpha}{|x|^\alpha} \star f} = \frac{c_{d-\alpha}}{|k|^{d-\alpha}} \hat f (k)
    \end{align*}
  \end{proof}
  
  \begin{rem}
    If \(d \ge 3\)
    \begin{align*}
      \hat G(k) 
      &= \frac{1}{|2 \pi k|^2}  \\
      \Rightarrow G(x) 
      &= \left(\frac{1}{|2 \pi k|^2}\right)^\lor
      = \frac{1}{d(d-2(k) |x|^{d-2})} 
      = \Phi(x)
    \end{align*}
  \end{rem}

  \section{Theory of Distribution}
  Let \(\Omega \subseteq \mathbb{R}^d\) be open.
  \begin{itemize}
    \item \(D(\Omega) = C_c^\infty(\Omega)\) the space of test functions.
    \item \(\phi_n \to \phi\) in \(D(\Omega)\) if \(\exists K \subseteq \Omega\), \(\supp(\phi_n), \supp(\phi) \subseteq K\) and \(\|D^\alpha(\phi_n - \phi)\|_{L^\infty} \to 0\) for all \(\alpha = (\alpha_1, \dots, \alpha_d)\), \(d_i \in \{0, 1, 2, \dots\}\).
    \[D'(\Omega) = \{T: D(\Omega) \to \mathbb{R} \text{ or } \mathbb{C} \text{ linear and continuous}\}\] the space of distributions.
  \end{itemize}

  Motivation: \(L^2(\Omega)' = L^2(\Omega)\), \((L^p(\Omega))' = (L^q(\Omega))\), \(\frac{1}{p} + \frac{1}{q} = 1\).


  \begin{eg}["normal functions" are distributions]
    If \(f \in L_{loc}^1(\Omega)\), then \(T = T_f\) defined by:
    \[T(\phi) = \int_{\Omega} f(x) \phi(x) \, dx\]
    is a distribution for all \(\phi \in D(\Omega)\), i.e. \(T \in D'(\Omega)\). Indeed, it is clear that \(T(\phi)\) is well-defined for all \(\phi \in D(\Omega)\) and \(\phi \mapsto T(\phi)\) is linear. Let us check that \(\phi \mapsto T(\phi)\) is continuous. Take \(\phi_n \to \phi\) in \(D(\Omega)\) and prove that \(T(\phi_n) \to T(\phi)\). Since \(\phi_n \to \phi\) in \(D(\Omega)\), there is a compact \(K\) s.t. \(\supp(\phi_n), \supp(\phi) \subseteq K \subseteq \Omega\).
  \end{eg}

  Question: Why is \(f \mapsto T_f\) injective?

  \begin{lem}[Fundamental lemma of calculus of variants]
    Let \(\Omega \subseteq \mathbb{R}^d\) be open. If \(f, g \in L_{loc}^1(\Omega)\) and 
    \(\int_\Omega f \phi \, dy = \int_{\Omega} g \phi \, dy\) for all \(\phi \in D(\Omega) \), then \(f = g\) in \(L_{loc}^1(\Omega)\)
  \end{lem}

  % \begin{proof}
  %   By the linearity, it suffices to show that if \(f \in L_{loc}^1(\Omega)\) and \(\int_\Omega f \phi = 0\) for all \(\phi \in D(\Omega)\), then \(f = 0\).
  %   \begin{enumerate}[label=Step \arabic*)]
  %     \item (\(\Omega = \mathbb{R}^d\) and \(f \in L^1(\mathbb{R}^d)\))Take \(h \in C_c^\infty(\mathbb{R}^d)\), \(\int_{\mathbb{R}^d} h = 1\), \(h_\epsilon(x) = \epsilon^{-d}h(\epsilon^{-1}x)\) for all \(\epsilon > 0\). Then \(h_\epsilon \star f \to f\) in \(L^1(\mathbb{R}^d)\) as \(\epsilon \to 0\). On the other hand: \[h_\epsilon \star f(x) = \int_{\mathbb{R}^d} f(y) \underbrace{h_\epsilon(x-y)}_{\phi_{\epsilon, x}(y)} \, dy = 0\] as \(\phi_{\epsilon, x} \in C_c^\infty\).
  %     \item (\(\Omega \subseteq \mathbb{R}^d, f \in L_{loc}^1(\Omega)\)) For any \(\epsilon > 0\), 
  %     \[\Omega_\epsilon = \{x \in \Omega \mid \dist(x, \Omega^\complement) > \epsilon\}\]
  %     Take \(h \in C_c^\infty(\mathbb{R}^d)\), \(\supp f \subseteq \{|x| \le 1\}\) and \(\int_{\mathbb{R}^d} h = 1\), \(h_\epsilon(x) = \epsilon^{-d}h(\epsilon^{-1}x)\). Then for all \(g \in C_c^\infty(\Omega_\epsilon)\) for all \(\epsilon > 0\) small we have 
  %     \begin{align*}
  %       h_\epsilon \star (gf)(x) 
  %       &= \int_{\mathbb{R}^d} \underbrace{h_\epsilon(x-y) g(y)}_{\phi_{\epsilon, x}(y)}f(y) \, dy = 0 \quad \text{as } \phi_{\epsilon, x} \in C_c^\infty(\Omega)
  %     \end{align*}
  %     but ...
  %   \end{enumerate}
  % \end{proof}
  
  \begin{eg}[Dirac delta function]
    Let \(\Omega \subseteq \mathbb{R}^d\) open. Define \(T: D(\Omega) \to \mathbb{R}\) or \(\mathbb{C}\) by \(T(\phi) = \phi(x_0)\). Let \(x_0 \in \Omega\). Then \(T \in D'(\Omega)\) and we denote it by \(\delta_{x_0}\). It is clear that \(\phi \mapsto T(\phi) = \phi(x_0)\) is well-defined and linear for all \(\phi \in D(\Omega)\). Take \(\phi_n \to \phi\) in \(D(\Omega)\) and prove \(T(\phi_n) \to T(\phi)\), i.e. \(\phi_n(x_0) \to \phi(x_0)\) (obvious.)
  \end{eg}

  \begin{eg}[Principle Value]
    The function \(f(x) = \frac{1}{x}\) is not in \(L_{loc}^1(\mathbb{R})\), but we can still define
    \[\int_{\mathbb{R}} f(x) \phi(x) \, dx = \int_{\mathbb{R}} \frac{\phi(x)}{x} \, dx\] for all \(\phi \in D(\mathbb{R})\) s.t. \(\phi(0) = 0\). In fact, \[\phi(x) = |\phi(x)-\phi(0)| \le (\sup |\phi'|)(x),\] so \(\frac{|\phi(x)|}{|x|} \in L^\infty(\mathbb{R})\) and compactly supported. So \(\frac{\phi(x)}{x} \in L^1(\mathbb{R})\).
    Define \(T: D(\mathbb{R}) \to \mathbb{R}\) or \(\mathbb{C}\) by \begin{align*}
      T(\phi) 
      &= \lim_{\epsilon \to 0} \int_{|x| \ge \epsilon} \frac{\phi(x)}{x} \, dx \quad \forall \phi \in D(\mathbb{R}) \text{ s.t. } \phi(0) = 0
    \end{align*}
    We denote \(T = p.v. \left(\frac{1}{x}\right)\). We check that \(T \in D'(\mathbb{R})\): For all \(\epsilon > 0\) we have  \[\left|\frac{\phi(x)}{x}\right| \le \frac{\|\phi\|_{L^\infty}}{\epsilon}\] for all \(|x| \ge \epsilon\) and \(\phi\) is compactly supported. So we get for all \(\epsilon > 0\):
    \begin{align*}
      \mathbb{1}(|x| \ge \epsilon)\frac{\phi(x)}{x} \in L^1(\mathbb{R}) \leadsto \int_{|x| \ge \epsilon} \frac{\phi(x)}{x} \, dx < \infty
    \end{align*}
    We can write:
    \begin{align*}
      \int_{|x| \ge \epsilon} \frac{\phi(x)}{x} \, dx 
      = \int_{|x|\ge 1} \frac{\phi(x)}{x} \, dx + \int_{\epsilon \le |x|\le 1} \frac{\phi(x)}{x}\, dx
    \end{align*}
    The second part can be written as:
    \begin{align*}
      \int_{\epsilon \le |x| \le 1} \frac{\phi(x)}{x} \, dx
      &= \int_{\epsilon}^1 \frac{\phi(x)}{x} \, dx + \int_{-1}^{-\epsilon} \frac{\phi(x)}{x} \, dx 
      = \int_\epsilon^1 \frac{\phi(x) - \phi(-x)}{x}\, dx
    \end{align*}
    Since \(\phi \in C_c^\infty(\mathbb{R})\) it holds that \(|\phi(x) - \phi(-x)|  \le 2 \|\phi'\|_{L^\infty}(x)\).
    \begin{align*}
      \Rightarrow \frac{\phi(x) - \phi(-x)}{x} \in L^\infty(\mathbb{R})
      \Rightarrow \frac{\phi(x) - \phi(-x)}{x} \in L^1(0, 1) \\
      \Rightarrow \int_0^1 \frac{\phi(x) - \phi(-x)}{x} \, dx = \lim_{\epsilon \to 0} \int_\epsilon^1 \frac{\phi(x) - \phi(-x)}{x} \, dx
    \end{align*}
  \end{eg}

  \begin{rem}
    The function \(\frac{1}{|x|^d}\) is not in \(L_{loc}^1(\mathbb{R}^d)\) but \(\exists T \in D'(\mathbb{R}^d)\) s.t. \(T(\phi) = \int_{\mathbb{R}^d} \frac{\phi(x)}{|x|^d} \, dx\) for all \(\phi \in C_c^\infty(\mathbb{R}^d)\) s.t. \(\phi(0) = 0\)
  \end{rem}

  Let in the following \(\mathbb{K} \in \{\mathbb{R}, \mathbb{C}\}\).

  \begin{defn}[Derivatives of distributions] 
    Let \(\Omega \subseteq \mathbb{R}^d\) and \(T \in D'(\Omega)\). Define for \(\alpha \in \mathbb{N}^d\): 
    \begin{align*}
      D^\alpha T: \ D(\Omega) &\longrightarrow \mathbb{K} \\
      \phi &\longmapsto (-1)^{|\alpha|}T(D^\alpha \phi)
    \end{align*}
    
  \end{defn}
  Motivation: \(f \in C_c^\infty(\Omega)\)
  \begin{align*}
    \int_\Omega(D^\alpha f) \phi = (-1)^{|\alpha|} \int_\Omega f(D^\alpha \phi)
  \end{align*}
  \glqq{}If the classical derivative exists, then it is the same as the distributional derivative.\grqq{} We write
  \[(D^\alpha T)(\phi) = T_{D^\alpha f} (\phi) = (-1)^{|\alpha|}T_f(D^\alpha \phi).\]
  
  \begin{rem}
    For all \(T \in D'(\Omega)\) it holds \(D^\alpha T \in D'(\Omega)\) for all \(\alpha \in \mathbb{N}^d\). Clearly
    \[\phi \longmapsto (D^\alpha T)(\phi) = (-1)^{|\alpha|}T(D^\alpha \phi)\] is linear. Moreover, if \(\phi_n \to \phi\) in \(D(\Omega)\), then \(D^\alpha \phi_n \to D^\alpha \phi \text{ in } D(\Omega)\), so
    \begin{align*}
      (D^\alpha T)(\phi_n) = (-1)^{|\alpha|} T(D^\alpha \phi_n) \xrightarrow{n \to \infty} (-1)^{|\alpha|} T(D^\alpha \phi) = (D^\alpha T)(\phi)
    \end{align*}
  \end{rem}

  \begin{eg}
    Consider \(f: x \mapsto |x|\), then \(f \in C(\mathbb{R})\) but \(f \notin C^1(\mathbb{R})\). However, 
    \[f'(x) = g(x) = \begin{cases}
      1 & x \ge 0 \\ -1 &x < 0
    \end{cases} \in L_{loc}^1\]
    Lets check \(f' = g\), i.e. \(-f(\phi') = f'(\phi) = g(\phi)\) for all \(\phi \in D(\mathbb{R})\). Thus we need to prove:
    \begin{align*}
      - \int_{\mathbb{R}} f(x) \phi'(x) \, dx = \int_{\mathbb{R}} g(x) \phi(x) \, dx \quad \forall \phi \in D(\mathbb{R})
    \end{align*}
    namely:
    \begin{align*}
      \underbrace{- \int_{\mathbb{R}} |x| \phi'(x) \, dx}_{\coloneqq (\star)} &= \int_0^\infty \phi(x) \, dx - \int_{-\infty}^0 \phi(x) \, dx
    \end{align*}
    Now we have
    \begin{align*}
      (\star) = - \int_0^\infty x \phi'(x) \, dx + \int_{-\infty}^0 x \phi'(x) \, dx.
    \end{align*}
    By integration by parts:
    \begin{align*}
      \int_0^\infty x \phi'(x) \, dx = \underbrace{[x \phi(x)]_0^\infty}_{= 0} - \int_0^\infty \phi(x) \, dx = - \int_0^\infty \phi(x) \, dx
    \end{align*}
    and similary:
    \begin{align*}
      \int_{-\infty}^0 x \phi'(x) \, dx = - \int_{-\infty}^0 \phi(x) \, dx
    \end{align*}
    Thus \(f' = g\) in \(D'(\Omega)\). We claim that \(g' = 2 \delta_0\) in \(D'(\mathbb{R})\). In fact, for all \(\phi \in D(\mathbb{R})\), then:
    \begin{align*}
      g'(\phi) 
      &= - g(\phi') 
      = - \int_{\mathbb{R}} g\phi' \, dx
      = - \int_{-\infty}^0 (-1) \phi'  \, dx - \int_0^\infty (1) \phi'  \, dx\\
      &= - \int_0^\infty \phi'  \, dx + \int_{-\infty}^0 \phi' \, dx
      = [\phi(0) - \underbrace{\phi(\infty)}_{= 0}] + [\phi(0) - \underbrace{\phi(-\infty)}_{= 0}]
      = 2 \phi(0) = 2 \delta_0 (\phi)
    \end{align*}
    So \(g' = 2 \delta_0\) in \(D'(\mathbb{R})\).
  \end{eg}

  \begin{ex}
    Prove that \((D^\alpha \delta_x)(\phi) = (-1)^{|\alpha|}(D^\alpha \phi)(x)\) for all \(\phi \in D(\mathbb{R})\) for all \(x \in \mathbb{R}\).
  \end{ex}

  \begin{defn}[Convergence of distributions]
    Let \(\Omega \subseteq \mathbb{R}^d\) be open, then
    \[T_n \xrightarrow{n \to \infty} T\] in \(D'(\Omega)\) if \(T_n(\phi) \xrightarrow{n \to \infty} T(\phi)\) for all \(\phi \in D(\Omega)\).
  \end{defn}

  \begin{ex}
    Let \(f \in L^1(\mathbb{R}^d)\), \(\int f = 1\) For \(\epsilon > 0\), define \(f_\epsilon(x) = \epsilon^{-d}f(\epsilon^{-1} x)\). Then: \(f_\epsilon \to \delta_0\) in \(D'(\Omega)\).
  \end{ex}
  
  \begin{ex}
    Let \(\Omega \subseteq \mathbb{R}^d\) be open and \(T_n \to T\) in \(D'(\Omega)\). Then:
    \(D^\alpha T_n \to D^\alpha T\) in \(D'(\Omega)\) for all \(\alpha = (\alpha_1, \dots, \alpha_d)\)
  \end{ex}
  
  \begin{defn}[Convolution of distributions]
    Let \(T \in D'(\mathbb{R})\) and \(f \in L_c^\infty(\mathbb{R}^d)\). Define \[(T \star f)(y) = T(f_y)\]
    We write \(f_y(x) = f(x-y)\) and \(\tilde f(x) = f(-x)\).
  \end{defn}
  
  \begin{thm}
    Let \(T \in D'(\mathbb{R})\). Then for all \(f \in D(\mathbb{R})\):
    \begin{enumerate}
      \item \(y \mapsto T(f_y)\) is \(C^\infty(\mathbb{R}^d)\) and 
      \[D_y^\alpha(T(f_y)) = (D^\alpha T)(f_y) = (-1)^{|\alpha|}T(D^\alpha f_y)\]
      \item For all \(g \in L^1(\mathbb{R}^d)\) and compactly supported, then
      \[\int_{\mathbb{R}^d} g(y) T(f_y) \, dy = T(\underbrace{f \star g}_{\in C_c^\infty(\mathbb{R})})\]
    \end{enumerate}
  \end{thm}

  \begin{proof}
    \begin{enumerate}
      \item We prove that \(y \mapsto T(f_y)\) is continuous. Take \(y_n \to y\) in \(\mathbb{R}^d\), then:\[T(f_{y_n}) \to T(f_y)\] since \(f_{y_n} \to f_y\) in \(D(\mathbb{R}^d)\). We check this: Since \(f \subseteq C_c^\infty(\mathbb{R}^d)\), it holds that \(\supp f \subseteq B(0, R) \subseteq \mathbb{R}^d\). Since \(y_n \to y\) in \(\mathbb{R}^d\). We have \(\sup_n |y_n| < \infty\). Thus \(f_{y_n}, f_y\) are supported in \(\overline{B(0, R + \sup_n |y_n|)} = K\) compact. Moreover
      \begin{align*}
        |f_{y_n}(x) - f_y(x)|
        &= |f(x-y_n) - f(x-y))|
        \le \| \nabla f \|_{L^\infty} \|y_n - y\| \to 0
      \end{align*}
      So we get \(\| f_{y_n} - f_y\|_{L^\infty} \to 0\)
      Similary:
      \[\|D^\alpha f_{y_n} - D^\alpha f_n \|_{L^\infty} \to 0\] \qedhere
    \end{enumerate}
  \end{proof}


  \begin{ex}[E 3.1 Lebesgue Differentiation Theorem]
    Let \(f \in L_{loc}^1(\mathbb{R}^d)\). Prove that that for almost every \(x \in \mathbb{R}^d\):
    \[\fint_{B(x,r)} |f(x) - f(y)| \, dy \xrightarrow{r \to 0} 0\]
  \end{ex}

  \begin{proof}
    Clearly the same result holds with \(\mathbb{R}^d \leadsto \Omega \subseteq \mathbb{R}^d\) open. Also it suffices to consider \(f \in L^1(\mathbb{R}^d)\). From the last time discussion, by a density argument there exists \(r_n \to 0\) s.t.
    \[\fint_{B(x, r_n)} |f(y) - f(x)| \, dy = 0\]
    for a.e. \(x \in \mathbb{R}^d\). We prove that for all \(\epsilon > 0\), te set \(A_\epsilon = \{x \in \mathbb{R}^d \mid \limsup_{r \to 0} \fint_{B(x,r)} |f(y) - f(x)| \, dy > \epsilon\}\) has measure \(0\). This will imply that 
    \[\bigcup_{n = 1}^\infty A_{\frac{1}{n}} = \left\{x \in \mathbb{R}^d \mid \limsup_{r \to 0} \int_{B(x,r)} |f(y) - f(x)| \, dy > 0\right\}\] has measure \(0\), which is what wie want to show. First, we show that \(|A_\epsilon| = 0\): Take \(\{f_n\} \subseteq C_c^\infty\), \(f_n \to f\) in \(L^1(\mathbb{R}^d)\). By the triangle inequality:
    \begin{align*}
      |f(y) - f(x)| \le |f(y) - f_n(y)| + |f_n(y) - f_n(x)| + |f_n(x) - f(x)|
    \end{align*}
    So we get 
    \begin{align*}
      &\fint_{B(x,r)} |f(y) - f(x)| \, dy \\
      \quad &\le \fint_{B(x,r)}|f(y) - f_n(y)| \, dy + \fint_{B(x, r)} |f_n(y) - f_n(x)| + |f_n(x) - f(x)| \\
      \Rightarrow \quad \limsup_{r \to 0} ... &\le \limsup_{r \to 0} (\dots) +0 + |f_n(x) - f(x)|
    \end{align*}
    Thus, for all \(x \in A_\epsilon\), then:
    \begin{align*}
      \limsup_{r \to 0} \fint_{B(x, r)} |f_n(y) - f(y)| \, dy + |f_n(x) - f(x)| > 2 \epsilon
    \end{align*}
    Observation: If \(a, b \ge 0\), \(a + b > 2 \epsilon\) then either \(a > \epsilon\) or \(b > \epsilon\). Therefore \(A_\epsilon \subseteq \left(S_{n, \epsilon} \bigcup \tilde S_{n, \epsilon}\right)\), where
    \begin{align*}
      S_{n, \epsilon} &= \{x \mid |f_n(x) - f(x)| > \epsilon\} \\
      \tilde S_{n, \epsilon} &= \{x \mid \limsup_{r \to 0} \fint_{B(x,r)} |f_n(y) - f(y)| \, dy > \epsilon\}
    \end{align*}
    Consequently: \(|A_\epsilon| \le |S_{n, \epsilon}| + |\tilde S_{n, \epsilon}|\) for all \(n \ge 1\). By the Markov / Chebyshev inequality:
    \begin{align*}
      |S_{n, \epsilon}| 
      &\le \int_{S_{n, \epsilon}} \frac{|f_n(x) - f(x)|}{\epsilon} \, dx
      = \int_{\mathbb{R}^d} \frac{|f_n(x) - f(x)|}{\epsilon} \, dx
      = \frac{\|f_n - f\|_{L^1}}{\epsilon}
    \end{align*}
    We want to prove a simpler bound for \(\tilde S_{n \epsilon}\). For all \(x \in \tilde S_{n \epsilon}\): 
    \begin{align*}
      \limsup_{r \to 0} \fint_{B(x, r)} |f_n(x) - f(y)| \, dy > \epsilon
    \end{align*}
    So there is a \(r_x \in (0,1)\) s.t.
    \[\fint_{B(x,r_x) = B_x} |f_n(y) - f(y)| \, dy > \epsilon\]
    Thus \(\tilde S_{n \epsilon} \subseteq \left(\bigcup_{x \in \tilde S_{n, \epsilon}} B_x\right)\). 
    
    \begin{lem}[Vitali Covering]
      If \(F\) is a collection of balls in \(\mathbb{R}^d\) with bounded radius, then there exists a sub-collection \(G \subseteq F\) s.t.
      \begin{itemize}
        \item \(G\) has disjoint balls
        \item \(\bigcup_{B \in F} B \subseteq \bigcup_{B \in G} 5B, 5B(x,r) = B(x, 5r)\)
      \end{itemize}
    \end{lem}

    \begin{rem}
      The condition of the boundedness of the radius is necessary. Otherwise, consider \(\{B(0,n)\}_{n=1}^\infty\)
    \end{rem}

    Here consider \(F = \{B_x\}_{x \in \tilde S_{n \epsilon}}\). With the vitali covering leamm there is a \(G \subseteq F\) s.t. \(G \) contains disjoint balls and:
    \[\tilde S_{n, \epsilon} \subseteq \bigcup_{B \in F} B \subseteq \bigcup_{B \in G} 5 B\]
    So we get
    \[|\tilde S_{n, \epsilon}| \le |\bigcup_{B \in G} 5B| \le \sum_{B \in G} |5B| = \sum_{B \in G} 5^d|B|\]
    On the other hand, for all \(B \in G \subseteq F\): 
    \begin{align*}
      \fint_B |f_n(y) - f(y)| \, dy > \epsilon \Rightarrow \int_B |f_n - f| > \epsilon|B|
    \end{align*}
    This implies:
    \begin{align*}
      \sup_{B \in G} \int_B |f_n - f| > \epsilon \sum_{B \in G} |B|
    \end{align*}
    Since balls in \(G\) are disjoint:
    \begin{align*}
      \int_{\mathbb{R}^d} \ge \int_{\bigcup_{B \in G}} |f_n - f| \, dy 
      > \epsilon \sum_{B \in G} |B|
      \ge \frac{\epsilon}{5^d} |\tilde S_{n, \epsilon}|
    \end{align*}
    So 
    \[|\tilde S_{n \epsilon}| \le \frac{5^d}{\epsilon} \|f_n - f\|_{L^1}\]
    In summary: 
    \[|A_\epsilon| \le |S_{n, \epsilon}| + |\tilde S_{n, \epsilon}| \le \frac{5^d + 1}{\epsilon} \|f_n - f\|_{L^1} \to 0\]
    as \(n \to \infty\). So \(|A_\epsilon| = 0\) for all \(\epsilon > 0\)
  \end{proof}
  
  \begin{rem}
    \begin{enumerate}
      \item The proof can be done by using the Besicovitch covering lemma: For all \(E \subseteq \mathbb{R}^d\) s.t. \(E\) is bounded. Let \(F = \) collection of balls s.t. for all \(x \in E\) there is a \(B_x \in F\) s.t. \(x\) is the center of \(B_x\). There is a sub-collection \(G \subseteq F\) s.t.
      \begin{itemize}
        \item \(E \subseteq \bigcup_{B \in G} B\)
        \item Any point in \(E\) belongs to at most \(C_d\) balls in \(C_T\) (\(C_d\) depends only on \(\mathbb{R}^d\)), i.e. 
        \begin{align*}
          \mathbb{1}_E(x) \le \sum_{B \in G} \mathbb{1}_B(x) \le C_d \mathbb{1}_E(x) \forall x
        \end{align*}
      \end{itemize}
      \item By a simpler argument we can prove the weak \(L^1\)-estimate:
      \[\{x \mid f^\star(x) > \epsilon\} \le \frac{c_d}{\epsilon} \|f\|_{L^1(\mathbb{R}^d)}\] (Hardy-Littlewood maximal function)
    \end{enumerate}
  \end{rem}

  \begin{ex}[E 3.2]
    Let \(1 \le p, q, r \le 2\), \(\frac{1}{p} + \frac{1}{q} = 1 + \frac{1}{r}\). Recall that if \(f \in L^p(\mathbb{R}^d)\), \(g \in L^q(\mathbb{R}^d)\), then \(f \star g \in L^r(\mathbb{R}^d)\) by Young's Inequality, and its Fourier transform is well-defined by the Hausdorff-Young inequality. Prove that 
    \[\widehat{f \star g}(k) = \hat f(k) \hat g(k) \quad \forall k \in \mathbb{R}^d\]

    Hint: In the lecture we already discussed the case \(f, g \in C_c(\mathbb{R}^d)\).
  \end{ex}

  \begin{proof}[Solution] \
    \begin{enumerate}[label=Step \arabic*)]
      \item \(f, g \in C_c^\infty(\mathbb{R}^d)\) (Fubini)
      \item \(f \in L^p, g \in L^q\), find \(f_n, g_n \in C_c^\infty\) s.t. \(f_n \to f\) in \(L^p\), \(g_n \to g\) in \(L^q\). \(\widehat{f_n \star g_n} = \hat f_n \hat g_n\) pointwise a.e. we have
      \begin{align*}
        \text{(Hausdorff-Young)} \quad &\|\widehat{f \star g} - \widehat{f_n \star g_n}\|_{L^{r'}} \\
        &\le \|\widehat{f \star g} - \widehat{f_n \star g_n}\|_{L^r} \\
        &= \|(f - f_n) \star g_n + f_n \star (g_n - g) \|_{L^r} \\
        &\le \| (f-f_n) \star g_n \|_{L^r} + \| f_n \star (g_n - g)\|_{L^r} \\
        \text{(Young)} &\le \|f - f_n\|_{L^p} \|g_n\| + \|f_n\|_{L^p} \|g_n - g\|_{L^p} \xrightarrow{n \to \infty} 0
      \end{align*}
      Moreover:
      \begin{align*}
        \|\hat f_n \hat g_n - \hat f \hat g \|_{L^{r'}} 
        &= \|(\hat f_n \hat f)\hat g_n + \hat f (\hat g_n - \hat g) \|_{L^{r'}} \\
        \text{(Hölder)} \quad &\le \|\hat f_n - \hat f \|_{L^{p'}} \| \hat g_n \|_{L^{q'}} + \| \hat f \|_{L^{q'}} \\
        \text{(Hausdorff-Young (\ref{hausdorff-young}))} \quad &\le \| f_n - f \|_{L^p}\|g_n\|_{L^q} + \|f\|_{L^p} \|g_n - g\|_{L^p} \xrightarrow{n \to \infty} 0
      \end{align*}
      So \(\hat f_n \hat g_n \to \hat f \hat g \text{ in } L^{r'}\)
      \(\widehat{f \star g} = \hat f \hat g\) in \(L^{r'}\)
      \(\frac{1}{r'} = \frac{1}{p'} + \frac{1}{q'}\) \qedhere
    \end{enumerate}
  \end{proof}

  
  \begin{ex}[E 3.3]
    \(f \in C_c^\infty(\mathbb{R}^d)\). Prove \(|\hat f(k)| \le \frac{C_N}{(1 + |k|)^N}\)
  \end{ex}

  \begin{proof}[Solution]
    Since \(f \in C_c^\infty\) we have that \(D^\alpha f \in C_c^\infty\).
    Recall
    \begin{align*}
      \widehat{D^\alpha f}(k) &= (-2 \pi ik)^\alpha \hat f (k)
    \end{align*}
    For example
    \begin{align*}
      \widehat{- \Delta f}(k) &= |2 \pi i k|^2 \hat f (k) \\
      (\text{Induction}) \leadsto \widehat{(-\Delta)^N f}(k) &= |2 \pi k|^{2N} \hat f (k)
    \end{align*}
    So we can conclude
    \[ \hat f(k) = \frac{\widehat{(-\Delta)^N}f(k)}{|2 \pi k|^{2N}} \forall k \in \mathbb{R}^d\]
    \begin{enumerate}
      \item \(f \in C_c^\infty \subseteq L^1(\mathbb{R}^d) \Rightarrow \hat f \in L^\infty\)
      \item \((-\Delta)^N f \in C_c^\infty \subseteq L^1(\mathbb{R}^d) \Rightarrow \widehat{(-\Delta)^N f} \in L^\infty\)
    \end{enumerate}
    Conclusion: \(\hat f(k) \le \begin{cases}
      C &\forall k \\ \frac{C_N}{|k|^{2N}} &\forall k
    \end{cases}\)
    So \(\hat f(k) \le \frac{C_N}{(1+|k|)^N}\)
  \end{proof}

  \begin{ex}[E 3.4]
    
  \end{ex}

  \begin{proof}
    Siehe Goodnotes
  \end{proof}
  
  \begin{ex}[Bonus 3]
    Let \(f \in L^1(\mathbb{R}^d)\) such that
    \[|\hat f(k)| \le \frac{C_N}{(1 + |k|)^N}\]
    for all \(k \in \mathbb{R}^d\), for all \(N \ge 1\). (\(C_N\) is independent of \(k\)). Prove that \(f \in C^\infty(\mathbb{R}^d)\)
  \end{ex}
  (\(f \in C^\infty\)) i.e. \(\exists \tilde f \in C^\infty\) s.t. \(f = \tilde f\) a.e.

  \begin{proof}[My Solution]
    First we regard for \(N \in \mathbb{N}\) and \(|k| \ge 1\):
    \begin{align*}
      \int_{\mathbb{R}^d} \frac{1}{(1 + |k|)^N} \, dk 
      &= \int_0^\infty \left(\int_{\partial B(0, r)} \frac{1}{(1+r)^N} \, dS(y)\right) \, dr \\
      &= \int_0^\infty \frac{1}{(1+r)^N} |\partial B(0, r)| \, dr \\
      &\le \int_1^\infty \frac{1}{r^N} \underbrace{|\partial B(0,r)|}_{c r^{d-1}} \, dr \quad \text{for a } c \in \mathbb{R} \\
      &= c \int_1^\infty \frac{1}{r^{N-d+1}} \, dr
    \end{align*}
    From Ana I we know that \(\int_1^\infty \frac{1}{r^{N-d+1}} \, dr < \infty\) is equivalent to \(N-d+1 > 1\) \(\Leftrightarrow\) \(N > d\), so for \(N > d\) we have 
    \[\frac{1}{(1+|k|)^N} \in L^1(\mathbb{R}^d).\]
    Now let \(\alpha \in \mathbb{N}^d\), then we have
    \begin{align*}
      k^\alpha 
      = k_1^{\alpha_1} \cdots k_d^{\alpha_d}
      = |k|^{\alpha_1} \cdots |k|^{\alpha_d}
      = |k|^{\alpha_1 + \cdots + \alpha_d}
      = |k|^{|\alpha|}
      = (1 + |k|)^{|\alpha|}.
    \end{align*}
    By assumption we have for all \(N \ge 1\):
    \begin{align*}
      k^\alpha \hat f(k) 
      \le k^\alpha \frac{C_n}{(1 + |k|)^N}
      \le (1 + |k|)^{|\alpha|} \frac{C_n}{(1 + |k|)^N}
      = \frac{C_n}{(1 + |k|)^{N - |\alpha|}}
    \end{align*}
    If we set \(N\) such that \(N - |\alpha| > d\), for example \(N = d + |\alpha| + 1\), then we can conclude that \(k^\alpha \hat f \in L^1(\mathbb{R}^d)\). This implies \(\widehat{k^\alpha \hat f} \in L^\infty(\mathbb{R}^d)\), so
    \begin{align*}
      \widehat{k^\alpha \hat f} (k)
      = \partial^\alpha \widehat{\hat f}(k)
      = \partial^\alpha (\hat f)^\lor (-k)
      = \partial^\alpha f(-k) \in L^\infty(\mathbb{R}^d).
    \end{align*}
    This implies \(f \in C^\infty(\mathbb{R}^d)\).
  \end{proof}
  
  \begin{thm}
    Take \(T \in D'(\mathbb{R}), f \in C_c^\infty(\mathbb{R}^d) = D(\mathbb{R}^d)\), \(f_y(x) = f(x-y)\)
    \begin{enumerate}[label=\alph*)]
      \item \(y \mapsto T(f_y) \in C^\infty(\mathbb{R}^d)\) and \(D_y^\alpha(T(f_y)) = (D^\alpha T) (f_y) = (-1)^{|\alpha|} T(D_x^\alpha f_y)\)
      \item \(\forall g \in L^1(\mathbb{R}^d)\) and compactly supported 
      \[\int_{\mathbb{R}^d} g(y) T(f_y) \, dy = T(\underbrace{f \star g}_{\in C_c^\infty})\]
    \end{enumerate}
  \end{thm}

  \begin{proof}
    \begin{enumerate}[label=\alph*)]
      \item \(y \mapsto T(f_y)\) is continuous since \(y_n \to y\) in \(\mathbb{R}^d\), then 
      \(f_{y_n} \to f_y\) implies \(T(f_{y_n}) \to T(f_y)\). Let's check that \(y \mapsto T(f_y) \in C^1\):
      \begin{align*}
        \lim_{h \to 0} \frac{T(f_{y-he_i})-T(f_y)}{h}
        &= \lim_{h \to 0} T \left(\frac{f_{y-he_i} - f_y}{h}\right)
      \end{align*}
        We have \(\frac{f_{y - h e_i} - f_y}{h} \xrightarrow{h \to 0} (\partial_i f)_y\) in \(D(\mathbb{R}^d)\)
      \begin{itemize}
        \item \(\exists K\) compact set such that \(\supp(f_{y - e_i} - f_y)\), \(\supp \partial_i f \subseteq K\) as \(|h|\) small.
        \item \(\begin{aligned}[t]
          &\frac{f_{y - h e_i}(x)- f_y(x)}{h} - (\partial_i f)_y(x) \\
          &\quad = \frac{f(x-y+he_i) - f(x-y)}{h} - (\partial_i f)(x-y) \\
          &\left| \int_0^1 \partial_i f(x-y+the_i) \, dt - \partial_i f(x-y) \right| \xrightarrow{h \to 0} 0 \text{ uniformly in } x
        \end{aligned}\) \\
        Similary:
        \begin{align*}
          &\left| D_x^\alpha \left(\frac{f(x-y+he_i) - f(x-y)}{h} - (\partial_i f)(x-y)\right) \right| \\
          &= \left| \frac{D^\alpha f(x-y+he_i) - D^\alpha f(x-y)}{h} - \partial_i(D^\alpha f)(x-y) \right| \xrightarrow{h \to 0} 0 
        \end{align*}
        uniformly in \(x\). Conclude: 
        \begin{align*}
          \lim_{h \to 0} \frac{T(f_{y - he_i}) - T(f_y)}{h} \xrightarrow{h \to 0} T((\partial_i f)_y) \in C(\mathbb{R}^d)
        \end{align*}
        So we geht that \(y \mapsto T(f_y) \in C^1\) and \(- \partial_{y_i} T(f_y) = T((\partial_i f)_y)\)
      \end{itemize}
      By induction: 
      \begin{align*}
        D_y^\alpha T(f_y) = (-1)^{|\alpha|} T((D^\alpha f)_y) = (D^\alpha T)(f_y) \quad \forall \alpha \in \mathbb{N}^d
      \end{align*}
      \item Heuristic: \(T = T(x)\)
      \begin{align*}
        \int_{\mathbb{R}^d} g(y) T(f_y) \, dy 
        &= \int_{\mathbb{R}^d} g(y) \left(\int_{\mathbb{R}^d}T(x) f(x-y) \, dx \right)\, dy \\
        &= \int_{\mathbb{R}^d} T(x) \left(\int_{\mathbb{R}^d} g(y) f(x-y) \, dy \right) \, dx \\
        &= \int_{\mathbb{R}^d} T(x) (f \star g)(x) \, dx = T(f \star g)
      \end{align*}
      \begin{enumerate}[label=Step \arabic*:]
        \item \(g \in C_c^\infty(\mathbb{R}^d)\) \begin{align*}
          (\text{Rieman Sum}) \quad \int_{\mathbb{R}^d} g(y) T(f_y) \, dy 
          &= \lim_{\Delta_N \to 0} \Delta_N \sum_{j=1}^N g(y_j) T(f_{y_j}) \\
          &= \lim_{\Delta_N \to 0} T\left(\Delta_N \sum_{j=1}^N g(y_j) f_{y_j}\right) \\
          &= T(f\star g)
        \end{align*}
        because
        \begin{align*}
          \lim_{\Delta_N \to 0} \Delta_N \sum_{j=1}^N g(y_j) f_{y_j} (x) \to (f\star g)(x) \text{ in } D(\mathbb{R}^d) \\
          \lim_{\Delta_N \to 0} \Delta_N \sum_{j=1}^N g(y_j) f(x-y_j) \xrightarrow{\text{Riemann}} \int_{\mathbb{R}^d} g(y) f(x-y) \, dy = (f \star g)(x)
        \end{align*}
        Proof of: 
        \begin{align*}
          \lim_{\Delta_N \to 0} \Delta_N \sum_{j=1}^N g(y_j) f(x-y_j) \to (f\star g)(x) \text{ in } D(\mathbb{R}^d)
        \end{align*}
        \begin{enumerate}[label=\arabic*)]
          \item Since \(f, g \in C_c^\infty\) we have \(f \star g \in C_c^\infty\). And we have \[x \mapsto \Delta_N \sum_{j=1}^N g(y_j) f(x-y_j) \in C^\infty\] since \(f \in C^\infty\) supported in \((\supp g + \supp f)\). So all functions are \(C_c^\infty\) and supported in \((\supp g + \supp f)\).
          \item 
          \begin{align*}
            \left| \lim_{\Delta_N \to 0} \Delta_N \sum_{j=1}^N g(y_j) f(x-y_j) - \int_{\mathbb{R}^d} g(y) f(x-y) \, dy \right| \xrightarrow{\Delta_N \to 0} 0
          \end{align*}
          uniformly in \(x\). (Result from the Riemann-Sum)
          \item \begin{align*}
            &\left| D_x^\alpha(\Delta_N \sum_{j=1}^N g(y_j) f(x-y) - (f \star g)(x)) \right| \\
            &= \left| \Delta_N \sum_{j=1}^N g(y_j) D^\alpha f(x-y) - (D^\alpha f)\star g(x) \right| \xrightarrow{\Delta_N \to 0} 0
          \end{align*}
          uniformly in \(x\) for all \(\alpha\).
        \end{enumerate}
        \item Take \(g \in L^1(\mathbb{R}^d)\) and compactly supported. Then \(\exists \{g_n\} \subseteq C_c^\infty(\mathbb{R}^d)\), \(\supp g_n \subseteq \supp g + B(0,1)\) such that \(g_n \to g\) in \(L^1(\mathbb{R}^d)\). By Step 1: 
        \begin{align*}
          \int_{\mathbb{R}^d} g_n(y) T(f_y) \, dy = T(g_n \star f)
        \end{align*}
        Take \(n \to \infty\):
        \begin{align*}
          \int_{\mathbb{R}^d} g_n(y) T(f_y) \, dy \to \int_{\mathbb{R}^d} g(y) T(f_y) \, dy
        \end{align*}
        since \(g_n \to g\) in \(L^1\) compactly supported and \(y \mapsto T(f_y) \in C^\infty \subseteq L^\infty(K)\). Moreover (exercise):
        \[\underbrace{g_n \star f}_{\in C_c^\infty} \to g \star f \quad \text{ in } D(\mathbb{R}^d)\]
        So \(T(g_n \star f) \xrightarrow{n \to \infty} T(g \star f)\).
        Finally we optain:
        \[\int g(y) T(f_n) \, dy = T(g \star f)\qedhere\] 
      \end{enumerate}
  \end{enumerate}
  \end{proof}
  
  \begin{thm}
    Let \(\Omega \subseteq \mathbb{R}^d\) be open. Let \(T \in D'(\Omega)\) and \(f \in C_c^\infty(\Omega)\). Denote
    \[\Omega_f = \{y \in \mathbb{R}^d \mid \supp f_y = y + \supp f \subseteq \Omega\}\]
    \begin{enumerate}[label=\alph*)]
      \item \(y \mapsto T(f_y) \in C^\infty(\Omega_f)\) and \(D_y^\alpha(T(f_y)) = (D^\alpha T)(f_y) = (-1)^{|\alpha|}T((D^\alpha f)_y)\)
      \item For all \(g \in L^1(\Omega_g)\) compactly supported in \(\Omega_f\) and it holds:
      \[\int_\Omega g(y) T(f_y) \, dy = T(f \star g).\]
    \end{enumerate}
  \end{thm}
  
  \begin{thm}
    Let \(T \in D'(\Omega)\) s.t. \(\nabla T = 0\) in \(D'(\Omega)\). Then: \(T = const.\) in \(\Omega\).
  \end{thm}

  \begin{proof}
    \((\Omega = \mathbb{R}^d)\) for all \(f \in C_c^\infty\), \(y \mapsto T(f_y) \in C^\infty(\mathbb{R}^d)\) and \(\partial_{y_i} T(f_y) = (\partial_j T)(f_y) = 0\) for all \(i = 1, \dots, d\). Then by the result of the theorem for \(C^\infty\) functions,
    \(y \mapsto T(f_y) = const\) independent of \(y\). Consequently:
    \begin{align*}
      T(f_y) = T(f_0) = T(f) \quad \forall y \in \mathbb{R}^d \ \forall f \in C_c^\infty(\mathbb{R}^d)
    \end{align*}
    For any \(g \in C^\infty(\mathbb{R}^d)\):
    \begin{align*}
      \left(\int_{\mathbb{R}^d} g \, dy\right) T(f)
      &= \int_{\mathbb{R}^d} g(y) T(f_y) \, dy
      = T(f \star g)
      = T(g \star f)
      = \left(\int_{\mathbb{R}^d} f \, dy\right) T(g)
    \end{align*}
    So \(\frac{T(f)}{\int_{\mathbb{R}^d}f}\) is independent of \(f\) (as soon as \(\int f \ne 0\)). So we get that \(T(f) = const \int_{\mathbb{R}^d} f\), where const is independent of \(f\).
  \end{proof}
  
  \begin{rem}
    If \(u \in C^1(\mathbb{R}^d)\), then:
      \begin{align*}
        u(x+y) - u(x) 
        &= \int_0^1 \sum_{j=1}^d y_j (\partial_j u)(x + ty_j) \, dt
        = \int_0^1 y \nabla u(x+ty) \, dt
      \end{align*}
      So we get that if \(\nabla u = 0\), then \(u(x+y) - u(x) = 0\) for all \(x,y\), so \(u = const.\)
  \end{rem}

  \begin{thm}[Taylor expansion for distributions]
    Let \(
      T \in D'(\mathbb{R}^d)\) and \(f \in C_c^\infty(\mathbb{R}^d)\). Then \(y \mapsto T(f_y) \in C^\infty\)
       and 
    \[T(f_y) - T(f) = \int_0^1 \sum_{j=1}^d y_j(\partial_j T) (f_{ty}) \, dt.\]
    In particular, if \(g \in L_{loc}^1\) and \(\nabla g \in L_{loc}^1\), then \(\forall y \in \mathbb{R}^d\):
    \[g (x+y) - g(x) = \int_0^1 g(x + ty) y \, dt\]
    for a.e. \(x \in \mathbb{R}^d\).
  \end{thm}

  \begin{proof}
    \(y \mapsto T(f_y)\) is \(C^\infty\) and \(\frac{d}{dt} [T(f_{ty})] = (\nabla T)(f_{ty}) y\) So we get
    \begin{align*}
      T(f_y) - T(f) 
      &= \int_0^1 \frac{d}{dt}(T(f_{ty})) \, dt \\
      &= \int_0^1 (\nabla T)(f_{ty}) y \, dt \\
      &= \int_0^1 \sum_{j=1}^d (\partial_j T)(f_{ty}) y_j \, dt \qedhere
    \end{align*}
  \end{proof}
  
  \begin{cor}
    Let \(g \in L_{loc}^1(\mathbb{R}^d)\) s.t. \(\partial_j g\in L_{loc}^1(\mathbb{R}^d)\) for all \(j = 1, 2, \dots, d\) (i.e. \(g \in W_{loc}^{1,1}(\mathbb{R}^d)\)). Then for all \(y \in \mathbb{R}^d\):
    \begin{align*}
      g(x+y) - g(x) &= \int_0^1 y \cdot \nabla g(x + ty) \, dt \\
      &= \int_0^1 \sum_{j=1}^d y_j \partial g(x+ty) \, dt
    \end{align*}
    for a.e. \(x\).
  \end{cor}

  \begin{proof}
    For all \(f \in C_c^\infty\) we have 
    \begin{align*}
      \int_{\mathbb{R}^d} f(x) [g(x+y) - g(x)] \, dx
      &= \int_{\mathbb{R}^d} g(x) [f(x-y) - f(x)] \, dx \\
      &= g(f_y) - g(f) \\
      &= \int_0^1 \sum_{j=1}^d y_j (\partial_j g)(f_{ty}) \, dt \\
      &= \int_0^1 \sum_{j=1}^d y_j \int_{\mathbb{R}^d} \sum_{j=1}^d y_j \left[\int_{\mathbb{R}^d} (\partial_j g)(x) f_{ty}(x) \, dx\right] \\
      &= \int_0^1 \sum_{j=1}^d y_i \left[\int_{\mathbb{R}^d}(\partial_j g)(x+ty) f(x) \, dx\right] \, dt \\
      &= \int_{\mathbb{R}^d} f(x) \left[\int_0^1 \sum_{j=1}^d y_j \partial_j g(x+ty) \, dt \right] \, dx
    \end{align*}
    For all \(\phi \in C_c^\infty\): \( = g(x+y) - g(x)\) a.e. \(x \in \mathbb{R}^d\).
  \end{proof}

  \begin{rem}
    If \(T \in D'(\Omega)\), \(\Omega \subseteq \mathbb{R}^d\) open, if \(y \nabla T = 0\), then \(T = const\).
  \end{rem}

  \begin{thm}[Equivalence of the classical and distributional derivatives]
      Let \(\Omega \subseteq \mathbb{R}^d\). Then the following are equivalent:
      \begin{enumerate}
        \item \(T \in D'(\Omega)\) s.t. \(\partial_{x_i} T = g_i \in C(\Omega)\) for all \(i = 1, \dots, d\).
        \item \(T = f \in C^1(\Omega)\) and \(g_i = \partial_{x_i} f\)
      \end{enumerate}
  \end{thm}

  \begin{proof} \
    \begin{itemize}
      \item [(2) \(\Rightarrow\) (1):] If \(T = f \in C^1(\Omega)\), then: \(\partial_{x_i} f \in C(\Omega)\).
      \begin{align*}
        \partial_{x_i} T(\phi) &= - T(\partial_{x_i} \phi) 
        = - \int_\Omega f(\partial_{x_i} \phi) = \int_\Omega (\partial_{x_i} f) \phi
      \end{align*}
      for all \(\phi \in D(\Omega)\), so \(\partial_{x_i} T = \partial_{x_i} f\).
      \item [(1) \(\Rightarrow\) (2):] Why is \(T = f \in C^1(\Omega)\)? As \(\partial_{x_i} f = g_i\): 
      \begin{align*}
        f(x+y) - f(x) 
        &= \int_0^1 \nabla f(x+ty) y \, dt
        = \int_0^1 \sum_{i=1}^d g_i(x + ty) y_i \, dt
      \end{align*}
      So we get
      \begin{align*}
        f(y) = f(0) + \int_0^1 \sum_{i=1}^d g_i(ty) g_i \, dt.
      \end{align*}
      We expect that \(f \in C^1\) and \(\partial_{x_i} f = g_i\). But this is not trivial to prove.
    \end{itemize}
    \begin{align*}
      \frac{f(y + he_i) - f(y)}{h} 
      &= \int_0^1 \sum_{i=1}^d [g_i(ty + the_i)(y_i + h \delta_{ij})] \, dt \\
      &= \int_0^1 g_i(ty + the_i) \, dt + \int_0^1 \sum_{j \ne i} \frac{[g_i(ty + the_i) - g_i(ty)]}{h} y_i \, dt \\
      &\xrightarrow{h \to 0} \int_0^1 g_i(ty) \, dt  + \text{is difficult ...}
    \end{align*}
    Lets take \(\phi \in C_c^\infty\), then:
    \begin{align*}
      T(\phi_{y}) - T(\phi)
      &= \int_0^1 \underbrace{\nabla T}_{(g_i)_{i=1}^d} (\phi_{ty}) y \, dt \\
      &= \int_0^1 \sum_{i=1}^d \left(\int_\Omega g_i(x) \smash{\underbrace{\phi_{ty} }_{\mathclap{= \phi(x - ty)}}} \, dx \right) \, dt \\
      &= \int_{\mathbb{R}^d} \left(\sum_{i=1}^d \int_0^1 g_i(x) \phi(x-ty) y_i \ dt\right) \, dx \\
      &= \int_{\mathbb{R}^d} \left(\sum_{i=1}^d \int_0^1 g_i(x + ty) \phi(x) y_i \, dt\right) \, dx \\
      &= \int_{\mathbb{R}^d} \left(\sum_i \int_0^1 g_i(x + ty) y_i \, dt \right) \phi(x) \, dx
    \end{align*}
    Integrating against \(\psi(y)\) with \(\psi \in C_c^\infty\):
    \begin{align*}
      &\int_{\mathbb{R}^d} T(\phi_y) \psi(y) \, dy - T(\phi) \int_{\mathbb{R}^d} \psi(y) \, dy  \\
      &\quad = \int_{\mathbb{R}^d} \left(\int_{\mathbb{R}^d} \sum_{i} \int_0^1 g_i (x + ty) y_i \psi(y) \, dt \, dy \right) \psi(x) \, dx
    \end{align*}
    \begin{align*}
      &\Rightarrow T(\phi \star \psi) - T(\phi)\int \psi = \dots \\
      &\Rightarrow \int_{\mathbb{R}^d} T(\psi_y) \phi(y) \, dy - T(\phi) \int \psi = \dots
    \end{align*}
    Take \(\psi \in C_c^\infty(\mathbb{R}^d)\) such that \(\int \psi = 1\). Then:
    \begin{align*}
      T(\phi)
      &= \int_{\mathbb{R}^d} \underbrace{T(\psi_x) - \left(\int_{\mathbb{R}^d} \sum_{i=1}^d \int_0^1 g_i(x + ty) y_i \psi(y) \, dt \, dy\right)}_{\smash{f(x)}} \phi(x) \, dx
    \end{align*}
    for all \(\phi \in C_c^\infty\), so \(T = f \in C(\Omega)\). Thus \(T = f \in C(\Omega)\) and \(\partial_{x_i} T = g_i \in C(\Omega)\). Then we need to prove that \(f \in C^1(\Omega)\) and \(\partial_{x_i} f = g_i\) (classical derivative). Since \(f \in W_{loc}^{1,1}\):
    \begin{align*}
      f(x + y) - f(x)
      &= \int_0^1 \sum_{i=1}^d g_i(x + ty)y_i \, dt \quad \forall x,y
    \end{align*}
    In particular:
    \begin{align*}
      \frac{f(x + h e_i) - f(x)}{h}
      &= \int_0^1 \frac{1}{h} \sum_{i=1}^d g_i (x + the_i) h \delta_{ij} \, dt \\
      &= \int_0^1 g_i(x + the_i) \, dt \xrightarrow{h \to 0} g_i(x)
    \end{align*}
    So we get \(\partial_{x_i} f(x) = g_i(x) \in C(\Omega)\) in the classical sense. So \(f \in C^1(\Omega)\).
  \end{proof}
  
  \begin{defn}[Sobolev Spaces]
    Let \(\Omega \subseteq \mathbb{R}^d\) be open. We define for \(1 \le p\le \infty\):
    \begin{align*}
      W^{1, p}(\Omega)
      &= \{f \in L^p(\Omega) \mid \partial_{x_i} f \in L^p(\Omega)\ \forall i=1, \dots, d \} \\
      W^{k, p}(\Omega)
      &= \{f \in L^p(\Omega) \mid D^\alpha f \in L^p(\Omega) \ \forall |\alpha|\le k \} \\
      W^{k, p}_{loc}(\Omega)
      &= \{f \in L_{loc}^p(\Omega) \mid D^\alpha f \in L_{loc}^p(\Omega) \ \forall |\alpha|\le k \}
    \end{align*}
  \end{defn}
  
  \begin{thm}[Approximation of \(W_{loc}^{1,p}(\Omega)\) by \(C^\infty(\Omega)\)]
    Let \(\Omega \subseteq \mathbb{R}^d\) be open, let \(f \in W_{loc}^{1,p}(\Omega)\). Then there exists \(\{f_n\} \subseteq C^\infty(\Omega)\) such that \(f_n \to f \) in \(W_{loc}^{1,p}(\Omega)\), i.e. for all \(K \subseteq \Omega\) compact: \(\|f_n - f\|_{L^p(K)} + \sum_{i=1}^d \| \partial_{x_i}(f_n - f)\|_{L^p(K)} \to 0\) .
  \end{thm}

  \begin{proof}
    Case \(\Omega = \mathbb{R}^d\): Take \(g \in C_c^\infty\), \(\int g = 1\), \(g_\epsilon(x) = \epsilon^{-d} g(\epsilon^{-1}x)\). Then \(g_\epsilon \star f \in C_c^\infty\). Since \(f \in L_{loc}^p(\Omega)\) we have \(g_\epsilon \star f \to f\) in \(L_{loc}^p\) as \(\epsilon \to 0\). Moreover \(\partial_{x_i} (g_\epsilon \star f) = (g_\epsilon \star \partial_{x_i} f)\xrightarrow{\epsilon \to 0} \partial_{x_i} f\) in \(L_{loc}^p\). Then we can take \(f_n = g_{\frac{1}{n} \star f}\).
  \end{proof}

  \begin{rem}
    In general, if we want to compute the distributional derivative \(D^\alpha f\), then we can find \(f_n \to f\) in \(D'(\Omega)\) and compute \(D^\alpha f_n\). Then \(D^\alpha f_n \to D^\alpha f\) in \(D^\alpha (\Omega)\). As an example we can compute \(\nabla |f|\) with \(f \in W_{loc}^{1,p}(\Omega)\).
    \begin{align*}
      (\nabla |f|)(x)
      &= \begin{cases}
        \nabla f(x) & f(x) > 0 \\
        - \nabla f(x) & f(x) < 0 \\
        0 & f(x) = 0
      \end{cases}
    \end{align*}
  \end{rem}
  
  \begin{thm}[Chain Rule]
    Let \(G \in C^1(\mathbb{R}^d)\) with \(|\nabla G|\) is bounded. Let \(f = (f_i)_{i=1}^d \subseteq W_{loc}^{1,p}(\Omega)\). Then \(x \mapsto G(f(x)) \in W_{loc}^{1,p}(\Omega)\) and
    \begin{align*}
      \partial_{x_i} G(f)
      &= \sum_{k=1}^d (\partial_k G)(f) \cdot \partial_{x_i} f_k \quad \text{ in } D'(\Omega)
    \end{align*}
    Moreover, if \(G(0) \in L^p(\Omega)\) (i.e. either \(|\Omega| < \infty\) or \(G(0) = 0\)), then if \(f = (f_i)_{i=1}^d \subseteq W^{1,p}(\Omega)\), then \(G(f) \in W^{1,p}(\Omega)\).
  \end{thm}

  \begin{proof}
    Since \(G \in C^1\) we have that \(G\) is bounded in any compact set. Moreover \(\|\nabla G\|_{L^\infty} < \infty\) implies:
    \[|G(f) - G(0)| \le \|\nabla G\|_{L^\infty} |f| \in L^p_{loc}\]
  
    So \(G(f) \in L_{loc}^p\). Let us compute \(\partial_{x_i} G(f)\). Let \(\{f^{(n)}\}_{n=1}^\infty \subseteq C^\infty\) such that \(f^{(n)} \to f\) in \(W_{loc}^{1,p}\), then: 
    \begin{align*}
      |G(f^{(n)}) - G(f)|
      \le \|\nabla G\|_{L^\infty} |f^{(n)} - f| \to 0 \text{ in  \(L_{loc}^p\)}
    \end{align*}
    So \(G(f^{(n)}) \to G(f)\) in \(L_{loc}^p\), thus \(\partial_{x_i} G(f^{(n)}) \to \partial_{x_i} G(f)\) in \(D'(\Omega)\). On the other hand, by the standard Chain-Rule for \(C^1\)-functions:
    \begin{align*}
      \partial_{x_i} G(f^{(k)})
      &= \sum_{k=1}^d \underbrace{\partial_k G(f^{(k)})}_{(\text{b.d.} \to \partial_k G(f))} \underbrace{\partial_i f_k^{(n)}}_{(\to \partial_i f_k \text{ in } L^p(\Omega))} \to \sum_{k=1}^d \partial_k G(f) \partial_i f_k \text{ in }L_{loc}^p(\Omega)
    \end{align*}
    Thus
    \begin{align*}
      \partial_{x_i} G(f) = \sum_{k=1}^d \underbrace{\partial_k G(f)}_{\in L^\infty} \underbrace{\partial_i f_k}_{\in L_{loc}^p} \in L_{loc}^p \text{ in } D'(\Omega)
    \end{align*}
    So \(G(f) \in W_{loc}^{1,p}(\Omega)\). Aussume that \(G(0) \in L^p(\Omega)\) (i.e. \(|\Omega| < \infty\) or \(G(0) = 0\)). If \(f \in W^{1,p}(\Omega)\), then \(G(f) \in W^{1,p}(\Omega)\) since
    \begin{align*}
      |G(f) - G(0) | \le \|\nabla G\|_{L^\infty} |f| \in L^p \Rightarrow G(f) \in L^p
    \end{align*}
    and 
    \begin{align*}
      \partial_{x_i} G(f) = \sum_k \underbrace{\partial_k G}_{\in L^\infty} \underbrace{\partial_i f_k}_{\in L^p} \in L^p \Rightarrow G(f) \in W^{1,p}(\Omega)
    \end{align*}
  \end{proof}
  
  \begin{thm}[Derivative of absolute value] Let \(\Omega \subseteq \mathbb{R}^d\) be open. Let \(f \in W^{1,p}(\Omega)\). 
    Then \(|f| \in W^{1,p}(\Omega)\)
    and  if \(f\) is real-valued:
    \begin{align*}
      (\nabla |f|) (x) =
      \begin{cases}
        \nabla f(x) & f(x) > 0 \\
        -\nabla f(x) & f(x) < 0 \\
        0 & f(x) = 0
      \end{cases}
    \end{align*}
  \end{thm}

  \begin{proof}
    Exercise. Hint: Use the Chain-Rule for \(G_\epsilon(x) = \sqrt{\epsilon^2 + x^2} - \epsilon \to |x|\) as  \(\epsilon \to 0\)
  \end{proof}

  \section{Distribution vs. measures}
  Let \(\mu\) be a Borel measure in \(\mathbb{R}^d\) s.t. \(\mu(K) < \infty\) for all compact \(K \subseteq \mathbb{R}^d\). Then define 
  \begin{align*}
    T: \ D(\mathbb{R}^d) &\longrightarrow \mathbb{C} \\
    \phi &\longmapsto \int_{\mathbb{R}^d} \phi(x) \, d\mu(x) \quad \forall \phi \in C_c^\infty
  \end{align*}
  \(\leadsto\) T is a distribution since if \(\phi_n \to \phi\) in \(D(\Omega)\), then
  \begin{align*}
    |T(\phi_n) - T(\phi)| 
    \le \int_{\mathbb{R}^d} |\phi_n - \phi| \, d\mu(x) \le \|\phi_n - \phi\|_{L^\infty} \left(\int_{K} \, d \mu \right) \xrightarrow{n \to \infty} 0
  \end{align*}
  
  \begin{eg}
    \(\partial_0\) in \(D'(\mathbb{R}^d)\) is a Borel probability measure.
  \end{eg}  
  
  \begin{thm}[Positive distributions are measures] 
    Let \(\Omega \subseteq \mathbb{R}^d\) be open, let \(T \in D'(\Omega)\). Assume \(T \ge 0\), i.e. \(T(\phi) \ge 0\) for all \(\phi \in D(\Omega)\) satisfying \(\phi(x) \ge 0\) for all \(x\). Then there is a Borel positive measure \(\mu\) on \(\Omega\) such that \(\mu(K) < \infty\) for all \(K \subseteq \Omega\) compact and:
    \[T(\phi) = \int_\Omega \phi(x) \, d\mu (x) \quad \forall \phi \in D^(\Omega)\]
  \end{thm}

  \begin{proof}See Lieb-Loss Analysis. Sketch: If \(O \subseteq \mathbb{R}^d\) is open, then 
    \[\mu(O) = \sup \{T(\phi) \mid \phi \in D(\Omega), 0 \le \phi \le 1, \supp \phi \subseteq O\}\]
    For all \(A \subseteq \Omega\) (not necessarily open),
    \[\mu(A) = \inf \{\mu(O) \mid O \text{ open}, A \subseteq O\}\]
    The mapping \(\mu: 2^\Omega \to [0, \infty]\) is an outer measure, i.e.
    \begin{enumerate}
      \item \(\mu(\emptyset) = 0\)
      \item \(\mu(A) \le \mu(B)\) if \(A \subseteq B\)
      \item \(\mu \left(\bigcup_{i=1}^\infty A_i\right) \le \sum_{i=1}^\infty \mu(A_i)\)
    \end{enumerate}
    From the outer measure we can find a \(\sigma\)-algebra \(\Sigma\) and \(\mu\) is a measure on \(\Omega\) s.t. \(E\) is measurable iff \[\mu(E) = \mu(E \cap A) + \mu(E \cap A^\complement).\]
    So all open sets are measurable, thus outer regularity (by def \(\mu(A) = \inf\{\mu(O) \mid O \text{ open } \supseteq A\)), so inner regularity \(\mu(A) = \sup\{\mu(K) \mid K \text{ compact} \subseteq A\}\). 
  \end{proof}

  \begin{ex}[E 4.1]
    Prove that if \(T_n \to T\) in \(D'(\mathbb{R}^d)\), then \(D^\alpha T_n  \to D^\alpha T\) in \(D^\alpha(\mathbb{R}^d)\) for all \(\alpha \in \mathbb{N}^d\).
  \end{ex}

  \begin{proof}[My Solution]
    See Goodnotes.
  \end{proof}

  \begin{ex}[E 4.2]
  \end{ex}

  \begin{proof}[My Solution]
    See Goodnotes.
  \end{proof}

  \begin{ex}[E 4.3]
    \(f \in L^1(\mathbb{R}^d)\), \(\int f = 1\) \(f_\epsilon(x) = \epsilon^{-d} f(\epsilon^{-1}x)\). Then \(f_\epsilon \to \delta_0\) in \(D'(\mathbb{R}^d)\). 
  \end{ex}

  \begin{proof}[My Solution]
    See Goodnotes.
  \end{proof}

  \begin{ex}[E 4.4]
    Let \(\{f_n\} \subseteq L^1\), \(\supp f \subseteq B(0,1), f_n \to f\) in \(L^1\). Prove for all \(g \in C_c^\infty\) that \(f_n \star g \to f \star g\) in \(D(\mathbb{R}^d)\).
  \end{ex}

  \begin{proof}[Solution]
    Since \(f_n \in L^1\), \(\supp f \subseteq B(0,1)\) and \(g \in C_c^\infty\) we have \(f_n \star g \in C_c^\infty\) and \[\supp(f_n \star g) \subseteq (\supp g) + \overline{B(0,1)} = K.\] Since \(f_n \to f\) in \(L^1\) there is a subsequence \(f_{n_k} \to f\) almost everywhere, so \(f \supp\) in \(\overline{B(0,1)}\), so \(f \star g \in C_c^\infty\), \(\supp(f \star g) \subseteq K\). We have:
    \begin{align*}
      |f_n \star g(x) - f \star g(x)| 
      &= \left|\int_{\mathbb{R}^d} (f_n(y)-f(y))g(x-y) \, dy \right| \\
      &\le \int_{\mathbb{R}^d} |f_n(y) - f(y)| |g(x-y)| \, dy \\
      &\le \|g\|_{L^\infty} ||f_n - f\|_{L^1} 
      \xrightarrow{n \to \infty} 0
    \end{align*}
    thus \(\|f_n \star g - f \star g\|_{L^\infty} \to 0\). Similary:
    \begin{align*}
      \|D^\alpha(f_n \star g) - D^\alpha (f\star g)\|_{L^\infty} 
      &= \|f_n \star \underbrace{(D^\alpha g)}_{\in C_c^\infty} - f \star (D^\alpha g)\|_{L^\infty} \xrightarrow{n \to \infty} 0
    \end{align*}
    for all \(\alpha \in \mathbb{N}^d\), so \(f_n \star g \to f \star g\) in \(D(\mathbb{R}^d)\).
  \end{proof}

  \begin{ex}[E 4.5]
    Compute distributional derivatives \(f', f''\) of \(f(x) = x|x-1|\).
  \end{ex}

  \begin{proof}[Solution]
    We prove \(f'(x) = g(x) \coloneqq \begin{cases}
      2x - 1 & x > 1 \\  1- 2x & x < 1
    \end{cases}\). Take \(\phi \in C_c^\infty(\mathbb{R}^d)\).
    \begin{align*}
      -f'(\phi) 
      &= - \int_{\mathbb{R}^d} f \phi' \, dy \\
      &= - \int_{-\infty}^1 f \phi' \, dy - \int_1^\infty f \phi' \, dy  \\
      &= [f \phi]_{- \infty}^1 - \int_{- \infty}^1 f' \phi \, dy + [f \phi]_1^\infty - \int_1^\infty f' \phi \, dy \\
      &= [f \phi]_{- \infty}^1 - \int_{- \infty}^1 g \phi \, dy + [f \phi]_1^\infty - \int_1^\infty g \phi \, dy \\
      &= f(1-) \phi(1) - f(1+)\phi(1) - \int_{\mathbb{R}^d} g \phi \, dy \\
      &= 0  - \int_{\mathbb{R}^d} g \phi \, dy \\
    \end{align*}
    Now we compute \(f'' = g'\). Take \(\phi \in C_c^\infty(\mathbb{R}^d)\):
    \begin{align*}
      -(g')(\phi) 
      &= \int_{\mathbb{R}^d} g\phi' \, dy \\
      &= \int_{- \infty}^1  g\phi' \, dy + \int_1^\infty  g\phi' \, dy \\
      &= [g(1-) - g(1+)] \phi(1) - \int_{-\infty}^1g' \phi \, dy - \int_1^\infty g' \phi \, dy \\
      &= [g(1-) - g(1+)] \phi(1) - \int_{-\infty}^1(-2) \phi \, dy - \int_1^\infty 2 \phi \, dy \\
      &= - 2 \phi(1) + \int_{-\infty}^\infty [2 \mathbb{1}_{(-\infty, 1)}(x) - 2 \mathbb{1}_{(1,  \infty)} (x)]\phi(x) \, dx \\
      &= -2 \delta_1(\phi) + \int_{-\infty}^\infty [2 \mathbb{1}_{(-\infty, 1)}(x) - 2 \mathbb{1}_{(1,  \infty)} (x)]\phi(x) \, dx \\
      \Rightarrow g' &= \underbrace{2 \delta_1}_{\notin L_{loc}^1} - \underbrace{2 \mathbb{1}_{(-\infty, 1)} + 2 \mathbb{1}_{(1, \infty)}}_{\int L_{loc}^1} \qedhere
    \end{align*}
  \end{proof}

  \chapter{Weak Solutions and Regularity}
  \begin{defn}
    Consider the linear PDE:
    \[\sum_{\alpha} c_\alpha D^\alpha u(x) = F(x), \quad c_\alpha \text{ constant}, F \text{ given}\]
    A function \(u\) is called a weak solution (a distributional solution) if 
    \[\sum_\alpha c_\alpha D^\alpha u = F \quad \text{in } D'(\Omega).\]
    Namely,
    \[\sum_\alpha (-1)^{|\alpha|} c_\alpha \int_\Omega u D^\alpha \phi = \int_\Omega F \phi, \quad \forall \phi \in D(\Omega)\]
  \end{defn}

  Regularity: Given some condition on the data \(F\), what can we say about the smoothness of \(u\)? Can we say that the equation holds in the classical sense? We derived \(G\) (the solution of the Laplace Equation) before in two ways:
  \begin{enumerate}
    \item \(\Delta G(x) = 0\) for all \(x \ne 0\), assuming \(G(x) = G(|x|)\) and \(d \ge 2\)
    \item \(\hat G(k) = \frac{1}{|2\pi k|^2}\) for \(d \ge 3\)
  \end{enumerate}
  
  \begin{thm}
    For all \(d \ge 1\) we have \(G \in L_{loc}^1(\mathbb{R^d})\) and \(- \Delta G = \delta_0\) in \(D'(\mathbb{R}^d)\).
  \end{thm}

  \begin{proof}
    Take \(\phi \in D(\mathbb{R}^d)\). Then:
    \begin{align*}
      (- \Delta G_y)(\phi) 
      &= G_y(-\Delta \phi)
      = \int_{\mathbb{R}^d} G_y(x) (-\Delta \phi)(x) \, dx \\
      &= \int_{\mathbb{R}^d} G(y-x) (-\Delta \phi)(x) \, dx \\
      &= [G \star (-\Delta \phi)](y) = (-\Delta)(G \star \phi)(y)
    \end{align*}
    Recall for all \(f \in C^2\), \(-\Delta (G \star f) = f\) pointwise. So we can conclude \(-\Delta G_y = \delta_y\) in \(D'(\mathbb{R}^d)\).
  \end{proof}
  
  \begin{rem}
    In \(d = 1\), \(G(x) = - \frac{1}{2}|x|\), so \(-G'(x) = \sgn(x)/2\), so \(-G''(x) = \delta_0\).
  \end{rem}

  \begin{rem}
    Formally: 
    \begin{align*}
      -\Delta(G_y \star \phi) = (-\Delta G_y) \star \phi(x) = (\delta_0 \star \phi)(x) = \int \delta_0(y) \phi(x - y) \, dy = \delta_0 (\phi(x-\bullet))
    \end{align*}
  \end{rem}

  \begin{thm}[Poisson's equation with \(L_{loc}^1\) data]\label{PoissonsequationwithL1locdata}
    Let \(f \in L_{loc}^1(\mathbb{R}^d)\) s.t. \(\omega_d f \in L^1(\mathbb{R}^d)\) where 
    \[\omega_d(x) = \begin{cases}
      1 + |x| & d = 1 \\ \log(1 + |x|) & d=2 \\ \frac{1}{1 + |x|^{d-2}} & d \ge 3,
    \end{cases}\]
    then \(u(x) = (G\star f)(x) \in L_{loc}^1(\mathbb{R}^d)\). Moreover \(-\Delta u = f\) in \(D'(\mathbb{R}^d)\). In fact, \(u \in W_{loc}^{1,1}(\mathbb{R}^d)\) and:
    \[\partial_{x_i} u(x) = (\partial_{x_i} G) \star f(x) = \int_{\mathbb{R}^d} (\partial_{x_i} G)(x-y)f(y) \, dy\]
  \end{thm}

  \begin{rem}
    We can also replace \(\mathbb{R}^d\) by \(\Omega\) and get \(- \Delta u = f\) in \(D'(\Omega)\). 
  \end{rem}

  \begin{proof}[Proof of Theorem \ref{PoissonsequationwithL1locdata}]
    First we check that \(u \in L_{loc}^1\). Take any Ball \(B(0, R) \subseteq \mathbb{R}^d\), prove \(\int_B |u| \, dy < \infty\). We have 
    \begin{align*}
      \int_B |u| \, dy 
      &= \int_B \left| \int_{\mathbb{R}^d} G(x-y) f(y) \, dy \right| \, dx \\
      &\le \int_B \int_{\mathbb{R}^d} |G(x-y)||f(y)| \, dy \, dx \\
      &= \int_{\mathbb{R}^d} \left(\int_B |G(x-y) \, dx\right)|f(y)| \, dy
    \end{align*}
    If \(y \notin B = B(0,R)\), then by Newtons's theorem (Mean-value theorem):
    \begin{align*}
      \int_{B(0, R)} |G(x-y)| \, dx
      &= |B(0, R)| |G(y)|
      \le C|B| \omega_d(y)
    \end{align*}
    If \(y \in B\), then \(|y| \le R\), so \(|x-y| \le 2 R\) if \(x \in B\).
    \begin{align*}
      \int_{B(0,R)}|G(x-y)| \, dx
      &\le \int_{|x-y|\le 2 R} |G(x-y)| \, dx
      = \int_{|z| \le 2 R} |G(z)| \, dz 
      \le c_R
    \end{align*}
    as \(G \in L_{loc}^1\). Thus
    \begin{align*}
      \int_B |u| \, dy 
      \le c_B \int_{|y|\ge R} \omega_d (y) |f(y)|\, dy + c_B \int_{|y|\le R} |f(y)| \, dy < \infty
    \end{align*}
    Let us prove \(- \Delta u = f\) in \(D'(\mathbb{R}^d)\). Take \(\phi \in D(\mathbb{R}^d)\). Then:
    \begin{align*}
      (-\Delta u)(\phi)
      &= u(-\Delta \phi)\\
      &= \int_{\mathbb{R}^d} u(x) (-\Delta \phi)(x) \, dx \\
      &= \int_{\mathbb{R}^d}\int_{\mathbb{R}^d} G(x-y) f(y) (-\Delta \phi)(x) \, dx \, dy\\
      &= \int_{\mathbb{R}^d}\int_{\mathbb{R}^d} G(y-x) f(y) (-\Delta \phi)(x) \, dx \, dy \\
      &= \int_{\mathbb{R}^d} [G \star (-\Delta \phi)](y) f(y) \, dy \\
      &= \int_{\mathbb{R}^d} -\Delta(G\star \phi)(y) f(y) \, dy \\
      &= \int_{\mathbb{R}^d} \phi(y) f(y) \, dy
    \end{align*}
    So \(-\Delta u = f\) in \(D'(\mathbb{R}^d)\). We check that \(\partial_i G \star f \in L_{loc}^1(\mathbb{R}^d)\). Note that 
    \[|\partial_i G(x)| \le c \frac{1}{|x|^{d-1}} \in L_{loc}^1(\mathbb{R}^d)\]
    and
    \[\int_{B(0,R)} |\partial_i G(x-y)| \, dx \le \begin{cases}
      C_r \omega_d(y) & |y| \ge R \\ C_r & |y| \le R
    \end{cases}\]
    So \(\int_{B(0,R)} |(\partial_i G\star f)|(y) < \infty\) for all \(R > 0\). For all \(\phi \in D(\mathbb{R}^d)\): 
    \begin{align*}
      -(\partial_i u)(\phi) 
      &= u(\partial_i \phi)
      = \int_{\mathbb{R}^d} u(x) \partial_i \phi(x) \, dx \\
      &= \int_{\mathbb{R}^d} \int_{\mathbb{R}^d} G(x-y) f(y) \partial_i \phi(x) \, dx \, dy \\
      &= \int_{\mathbb{R}^d} \int_{\mathbb{R}^d} G(y-x) f(y) \partial_i \phi(x) \, dx \, dy \\
      &= \int_{\mathbb{R}^d} (G \star \partial_i^y \phi)(y) f(y) \, dy \\
      &= \int_{\mathbb{R}^d}(\partial_i^y G \star \phi)(y) f(y) \, dy \\
      &= \int_{\mathbb{R}^d} \int_{\mathbb{R}^d} \partial_i^y G(y-x) f(y) \phi(x) \, dx \, dy \\
      &= \int_{\mathbb{R}^d} \int_{\mathbb{R}^d} -(\partial_i G)(x-y) f(y) \phi(x) \, dx \, dy \\
      &= - \int_{\mathbb{R}^d} (\partial_i G \star f)(x) \phi(x) \, dx
    \end{align*}
    So \(\partial_i u = \partial_i G \star f \in L_{loc}^1(\mathbb{R}^d)\). Thus \(u \in L_{loc}^1\), \(\partial_i u \in L_{loc}^1\) for all \(i\). So \(u \in W_{loc}^{1,1}(\mathbb{R}^d)\).
  \end{proof}

  Regularity: We consider the Laplace Equation \(\Delta u = 0\) in \(\mathbb{R}^d\).

  
  \begin{lem}[Weyl]\label{weyl}
    If \(\Omega \subseteq \mathbb{R}^d\) open and \(T \in D'(\Omega)\) s.t. \(\Delta T = 0\) in \(D'(\Omega)\), then: \(T = f \in C^\infty(\Omega)\) and \(f\) is a harmonic function.
  \end{lem}

  \begin{proof}
    (\(\Omega = \mathbb{R}^d\)). Take \(\phi \in C_c^\infty\), then \(y \mapsto T(\phi_y) = T(\phi(-y))\) is \(C^\infty\) and \(\Delta_y T(\phi_y) = T((\Delta \phi)_y) = (\Delta T)(\phi_y)=0\). Take \(g \in C_c^\infty\), \(g\) is radial. Then:
    \begin{align*}
      \int_{\mathbb{R}^d} T(\phi_y) g(y) \, dy 
      \overset{\text{(exercise)}}{=} \int_{\mathbb{R}^d} T(\phi)g(y) \, dy 
      = T(\phi) \left(\int_{\mathbb{R}^d} g \, dy \right)
    \end{align*}
  
  
    \begin{ex}
      Let \(f \in C^\infty(\mathbb{R}^d)\) be a harmonic function and \(g \in C_c^\infty\), \(g\) is radial. Then:
      \begin{align*}
        \int_{\mathbb{R}^d} f(x) g(x) \, dx = f(0) \left(\int_{\mathbb{R}^d} g(x) \, dx\right)
      \end{align*}
    \end{ex}

    On the other hand:
    \begin{align*}
      \int_{\mathbb{R}^d} T(\phi_y) g(y) \, dy = T(\phi \star g) = T(g \star \phi) = \int_{\mathbb{R}^d} T(g_y) \phi(y)\, dy
    \end{align*}

    Take \(\int_{\mathbb{R}^d} g \, dy = 1\), then:
    \begin{align*}
      T(\phi) 
      &= \int_{\mathbb{R}^d} T(g_y) \phi(y) \, dy 
    \end{align*}
    For all \(\phi \in C_c^\infty\). Then \(T = T(g_y) \in C^\infty\)
  \end{proof}

  Now lets regard the Poisson Equation \(- \Delta u = f\) in \(D'(\mathbb{R}^d)\).

  \begin{rem}
    Any solution has the form \(u = G \star g + h\) where \(\Delta h = 0\) in \(D'(\mathbb{R}^d)\). By Weyls Lemma (\ref{weyl}), \(h \in C^\infty\), then we only need to consider the regularity of \(G \star f\).
  \end{rem}

  \begin{rem}
    The regularity is a \emph{local question}, namely if we write \[f = f_1 + f_2 = f \phi + f(1-\phi),\] where \(\phi = 1\) in a ball \(B\) and \(\phi \in C_c^\infty\).
  \end{rem}
  Then \(G \star f = G \star f_1 + G \star f_2\). Here \(f_2 = f(1 - \phi) = 0\) in \(B\). With Weyls Lemma (\ref{weyl}), \(G \star f_2 \in C^\infty\).

  \begin{thm}[Low Regularity of Poisson Equation]\label{Low Regularity for Poisson Equation}
    Lef \(f \in L^p(\mathbb{R}^d)\) and compactly supported. Then
    \begin{enumerate}[label=\alph*)]
      \item If \(p \ge 1\), then \begin{itemize}
        \item \(G \star f \in C^1(\mathbb{R}^d)\) if \(d = 1\).
        \item \(G \star f \in L_{loc}^q(\mathbb{R}^d)\) for any \(q < \infty\) if \(d = 2\).
        \item \(G \star f \in L_{loc}^q(\mathbb{R}^d)\) for \(q < \frac{d}{d-2}\) if \(d \ge 3\).
      \end{itemize}
      \item If \(\frac{d}{2} < p \le d\), then \(G \star f \in C_{loc}^{0, \alpha}(\mathbb{R}^d)\) for all \(0 < \alpha < 2 - \frac{d}{p}\), i.e.
      \begin{align*}
        |(G \star f)(x) - (G \star f)(y) | \le C_k|x-y|^\alpha \quad \forall x,y \in K
      \end{align*}
      with \(K\) compact in \(\mathbb{R}^d\).
      \item If \(p > d\), then \(G \star f \in C_{loc}^{1, \alpha} (\mathbb{R}^d)\) for all \(0 < \alpha < 1 - \frac{d}{p}\).
    \end{enumerate}
    where \(G\) is den fundamental solution of the laplace equation.
  \end{thm}
  
  \begin{eg}
    Let \(r = |x|\)
    \begin{align*}
      u(x) 
      &= \omega(r) = \log(|\log(r)|)
    \end{align*}
    if \(0 < r < \frac{1}{2}\), so \(u\) is well-defined in \(B = B(0, \frac{1}{2})\). We conclude:
    \begin{align*}
      - \Delta_{\mathbb{R}^3} u(x) = - \omega''(r) - \frac{2 \omega'(r)}{r} = f(x) \in L^{\frac{3}{2}(B)}
    \end{align*}
    But the Theorem (b) tells us that if \(f \in L^{\frac{3}{2}}\) then \(u\) is continuous but \(u \notin C(B)\).
  \end{eg}

  \begin{proof}[Proof of theorem \ref{Low Regularity for Poisson Equation}]
    \begin{enumerate}[label=\alph*)]
      \item (\(p=1\)) Why is \(G \star f \in L_{loc}^q\)? Recall from the proof of Youngs inequality: \begin{align*}
        |(G\star f)(x)| 
        &= \left| \int_{\mathbb{R}^d} G(x-y) f(y) \, dy \right| \\
        (\text{Hölder}) \quad &= \left(\int_{\mathbb{R}^d} |G(x-y)|^q |f(y)| \, yd\right)^{\frac{1}{q}}\left(\int_{\mathbb{R}^d} |f(y)| \, dy\right)^{\frac{1}{q'}}
      \end{align*}
      Where \(\frac{1}{q} + \frac{1}{q'} = 1\). Then:
      \begin{align*}
        |(G \star f)(x)|^q 
        &\le C \int_{\mathbb{R}^d} |G(x-y)|^q |f(y)| \, dy
      \end{align*}
      For any Ball \(B = B(0, R) \subseteq \mathbb{R}^d\):
      \begin{align*}
        \int_B |G \star f(x)|^q \, dx
        &\le C \int_B \left(\int_{\mathbb{R}^d} |G(x-y)|^q |f(y)| \, dy\right) \, dx \\
        &= C \int_{\mathbb{R}^d} \left(\int_B |G(x-y)|^q \, dx \right) |f(y)| \, dy
      \end{align*}
      \(G(x) \sim \frac{1}{|x|^{d-2}} \leadsto |G|^{q} = \frac{1}{|x|^{(d-2)q}} \in L_{loc}^1(\mathbb{R}^d)\) if \((d-2)q < 2 \Leftrightarrow q < \frac{d}{d-2}\). Here, \(y \in \supp f \), so \(|y| \le R_1\), then \(|x-y| \le R + R\) if \(|x| \le R\). With \(y \in \supp f\), this implies:
      \begin{align*}
        \int_{B(0,R)}|G(x-y)|^q \, dx \le \int_{|z| \le R + R_1} |G(z)|^q \, dz < \infty
      \end{align*}

      \item \begin{align*}
        (G \star f)(x) - (G \star f)(y) 
        &= \int_{\mathbb{R}^d} (G(x-z)-G(y-z)) f(z) \, dz
      \end{align*}
      So \begin{align*}
        |G \star f(x) - (G\star f)(y)| 
        &\le C \int_{\mathbb{R}^d} \left| \frac{1}{|x-z|^{d-2}} - \frac{1}{|y-z|^{d-2}}\right| |f(z)| \, dz
        \end{align*}
        for all \(x, y \in \mathbb{R}^d\):
        \begin{align*}
          \left| \frac{1}{|x|^{d-2}} - \frac{1}{|y|^{d-2}} \right|
          &= \left| \left( \frac{1}{|x|} - \frac{1}{|y|}\right) \left(\frac{1}{|x|^{d-3}} + \cdots + \frac{1}{|y|^{d-3}}\right) \right| \\
          &\le C \frac{||x|-|y||}{|x||y|} \max \left(\frac{1}{|x|^{d-3}}, \frac{1}{|y|^{d-3}}\right) \\
          &= C \frac{|x-y|}{|x||y|} \max \left(\frac{1}{|x|^{d-3}}, \frac{1}{|y|^{d-3}}\right) \\
          &\le C \max(|x|, |y|)^{1-\alpha} \frac{|x-y|^\alpha}{|x||y|} \max \left(\frac{1}{|x|^{d-3}}, \frac{1}{|y|^{d-3}}\right)
        \end{align*}
        as
        \begin{align*}
          ||x|-|y|| 
          &\le \min \left(|x-y|, \max(|x|, |y|)\right)
          \le |x-y|^\alpha \max(|x|, |y|)^{1-\alpha}
        \end{align*}
        Thus, for all \(x,y \in \mathbb{R}^d\):
        \begin{align*}
          \left| \frac{1}{|x|^{d-2}}- \frac{1}{|y|^{d-2}}\right| 
          &\le C |x-y|^\alpha \frac{\max(|x|, |y|)^{1-\alpha}}{|x||y|} \max \left(\frac{1}{|x|^{d-3}}, \frac{1}{|y|^{d-3}}\right) \\
          &\le C |x-y|^\alpha \max \left(\frac{1}{|x|^{d-2+\alpha}}, \frac{1}{|y|^{d-2+\alpha}}\right)
        \end{align*}
        So we get \begin{align*}
          \left| \frac{1}{|x-y|^{d-2}}- \frac{1}{|y-z|^{d-2}}\right|
          &\le C |x-y|^\alpha \max \left(\frac{1}{|x-z|^{d-2+\alpha}}, \frac{1}{|y-z|^{d-2+\alpha}}\right)
        \end{align*}
        Therefore:
        \begin{align*}
          &|G \star f(x) - G \star f(y)| \\
          &\quad\le C \int_{\mathbb{R}^d}|x-y|^\alpha \max \left(\frac{1}{|x-z|^{d-2+\alpha}}, \frac{1}{|y-z|^{d-2+\alpha}}\right) |f(z)| \, dz \\
          &\quad\le C |x-y|^\alpha \left(\sup_{\xi \in \mathbb{R^d}} \int_{\mathbb{R}^d} \frac{1}{|\xi - z|^{d-2+\alpha}} |f(z)| \, dz\right)
        \end{align*}
        Claim: If \(f \in L^p(\mathbb{R}^d)\) is compactly supported, \(d \ge p > \frac{d}{2}\), then: 
        \begin{align*}
          \sup_{\xi \in \mathbb{R}^d} \int_{\mathbb{R}^d} \frac{1}{|\xi - z|^{d - 2 + d}}|f(z)| \, dz < \infty
        \end{align*}
        for all \(0 < \alpha < 2 - \frac{d}{p}\). Assume \(\supp f \subseteq \overline{B(0, R_1)}\). Consider 2 cases:
        \begin{itemize}
          \item If \(|\xi| > 2 R_1\), then: \(|\xi - z| \ge R_1\) for all \(z \in B(0, R_1)\). Hence: \begin{align*}
            \int_{\mathbb{R}^d} \frac{1}{|\xi -z|^{d-2+\alpha}}|f(z)| \, dz
            &\le \frac{1}{R_1^{d-2+\alpha}} \|f\|_{L^1} < \infty
          \end{align*}
          \item If \(|\xi| \le 2 R_1\), then: \(|\xi - z| \le 3 R_1\) for all \(z \in B(0, R_1)\):
          \begin{align*}
            \int_{\mathbb{R}^d} \frac{1}{|\xi - z|^{d-2+\alpha}} |f(z)| \, dz
            &\le \int_{|\xi - z| \le 3 R_1} \frac{1}{|\xi - z|^{d - 2 + \alpha}} |f(z)| \, dz \\
            (\text{Hölder}), \left(\frac{1}{p} + \frac{1}{q} = 1\right) \quad &\le \left(\int_{\mathbb{R}^d}|f(z)|^p \, dz\right)^{\frac{1}{p}}\\
            &\quad \cdot \left(\int_{|\xi - z| \le 3 R_1} \frac{1}{|\xi - z|^{(d - 2 + \alpha)q}}\right)^{\frac{1}{q}} \\
            &= \|f\|_{L^p} \left(\int_{|z| \le 3 R_1} \frac{1}{|z|^{(d-2+\alpha)q}} \, dz\right)^{\frac{1}{q}} < \infty
          \end{align*}
        \end{itemize}
        \item (\(d \ge 3\)) We already know: \begin{align*}
          \partial_i(G \star f) =(\partial_i G \star f) \in L_{loc}^1(\mathbb{R}^d)
        \end{align*}
        as \(\omega_d f \in L^1(\mathbb{R}^d)\). We claim that \(\partial_i G \star f \in C^{0, \alpha}(\mathbb{R}^d)\). So \(G \star f \in C^{1, \alpha}(\mathbb{R}^d)\) by the equivalence between the classical and the distributional derivatives. Exercise. Hint:
        \begin{align*}
          |\partial_i G\star f(x) - \partial_i G \star f(y)|
          &\le \int_{\mathbb{R}^d} |\partial_i G(x-z) - \partial_i G(y-z)||f(z)| \, dz,
        \end{align*}
        \(\partial_i G(x) = \frac{-x_i}{d|B_1||x|^d}\). \(\leadsto\) Need to estimate \(|\partial_i G(x) - \partial_i G(y)| \le C|x-y|^\alpha\). \qedhere
    \end{enumerate}
  \end{proof}

  \begin{thm}[High regularity for Poisson's equation]\label{High regularity for Poisson's equation}
    Let \(f \in C^{0, \alpha}(\mathbb{R}^d)\), \(0 < \alpha < 1\) be compactly supported. Then \(G \star f \in C^{2, \alpha}(\mathbb{R}^d)\).
  \end{thm}

  \begin{rem}
    \((- \Delta u = f)\) and \(f \in C(\mathbb{R}^d)\) does not imply that \(u \in C^2(\mathbb{R}^d)\). (exercise)
  \end{rem}

  \begin{rem}
    If \(f \in C^{k, \alpha}(\mathbb{R}^d)\), \(k \in \{0, 1, \dots\}\), \(0 < \alpha < 1\) is compactly supported, then \(G \star f \in C^{k + 2, \alpha}(\mathbb{R}^d)\). This more general statement is a consequence of the theorem since
    \[D^\beta(G \star f) = G \star \underbrace{(D^\beta f)}_{\in C^{0, \alpha}}\]
    for all \(\beta = (\beta_1, \dots, \beta_d)\), \(|\beta| \le k\).
  \end{rem}

  \begin{proof}[Proof of theorem \ref{High regularity for Poisson's equation}]
    Since \(f \in L^p\) for all \(p \le \infty\) by the low regularity (\ref{Low Regularity for Poisson Equation}) we have \(G \star f \in C^{1, \alpha}\) and \(\partial_i (G \star f) = \partial_i G \star f\)
    in the classical sense. We will compute the distributional derivatives \(\partial_i \partial_j (G \star f)\) and prove that they are Hölder continuous. Compute \(\partial_j \partial_i (G \star f)\): For all \(\phi \in C_c^\infty(\mathbb{R}^d)\) we have
    \begin{align*}
      -(\partial_j \partial_i G \star f)(\phi)
      &= (\underbrace{\partial_i(G \star f)}_{\in C})(\partial_j \phi) \\
      &= \int_{\mathbb{R}^d}((\partial_i G)\star f)(x) \partial_j \phi(x) \, dx \\
      &= \int_{\mathbb{R}^d}\int_{\mathbb{R}^d} \partial_i G(x-y) f(y) \partial_j \phi(x) \, dx \, dy \\
      &= \int_{\mathbb{R}^d} f(y) \left[\int_{\mathbb{R}^d} \partial_i G(x-y)\partial \phi(x) \, x\right] \, dy \\
      &\overset{?}{=} \int_{\mathbb{R}^d} \square \phi(y) \, dy
    \end{align*}
    Recall: \(\partial_i G(x) = \frac{-x_i}{d|B_1||x|^d}, \partial_i \partial_j G(x) = \frac{1}{|B_1|}\left[\frac{x_i x_j}{|x|^2}- \frac{\delta_{ij}}{d}\right] \frac{1}{|x|^d}\). We have:
    \begin{align*}
      \int_{\mathbb{R}^d} \partial_i G(x-y) \partial_j \phi(x) \, dx
      &= \lim_{\epsilon \to 0^+}\int_{|x-y| \ge \epsilon} \partial_i G(x-y) \partial_j \phi(x) \, dx
    \end{align*}
    By dominated convergence we have \(|\partial_i G(x-y) \partial_j \phi(x)| \in L^1(dx)\).
    By the Gauss-Green-Theorem (\ref{gauss-green}) for all \(\epsilon > 0\):
    \begin{align*}
      &\int_{|x-y| \ge \epsilon} \partial_i G(x-y) \partial_j \phi(x) \, dx \\
      &\quad= \int_{\partial B(y, \epsilon)}\partial_i G(x-y) \phi(x) \omega_j \, dS(x) - \int_{|x-y| \ge \epsilon} \partial_j \partial_i G(x-y) \phi(x) \, dx
    \end{align*}
    Where \(\omega = \frac{x-y}{|x-y|}\). For the boundary term:
    \begin{align*}
      - \int_{\partial B(y, \epsilon)} \partial_i G(x-y) \phi(x) \omega_j \, dS(x)
      &= - \epsilon^{d-1} \int_{\partial B(0, 1)} \partial_i G(\epsilon \omega) \phi(y + \epsilon \omega) \omega_j \, d\omega \\
      (\star) \quad &= \int_{\partial B(0, 1)} \frac{1}{d|B_1|} \omega_i \omega_j \phi(y + \epsilon \omega) \, d \omega \\
      &\xrightarrow{\epsilon \to 0} \int_{\partial B(0, 1)} \frac{1}{d|B_1|} \omega_i \omega_j \phi(y) \, d\omega \\
      &= \frac{1}{d} \delta_{i,j} \phi(y)
    \end{align*}
    \((\star)\) \ \(\partial_i G(x) = \frac{- x_i}{d|B_1||x|^d}\)
    , so \(\partial_i G(\epsilon \omega) = - \frac{- \omega_i}{d |B_1|} \frac{1}{\epsilon^{d-1}}.\) for all \(|\omega| = 1\). \\
    
    Now we split:
    \begin{align*}
      &- \int_{|x-y| \ge \epsilon} \partial_i \partial_j G(x-y) \phi(x) \, dx \\
      &\quad= - \int_{|x-y| \ge 1}  \partial_i \partial_j G(x-y) \phi(x) \, dx - \int_{1 \ge |x-y| \ge \epsilon}  \partial_i \partial_j G(x-y) \phi(x) \, dx
    \end{align*}
    The key observation is: \(\int_{\partial B(0, r)} \partial_i \partial_j G(x) \, dx = 0\) since \[\partial_i \partial_j G(x) = \frac{1}{|B_1|}\left(\omega_i \omega_j - \frac{\partial_{ij}}{d}\right) \frac{1}{|x|^d},\] \(\omega = \frac{x}{|x|}\). For example if \(i = 1, j = 2, r = 1\):
    \begin{align*}
      \int_{\partial B(0, 1)} \partial_1 \partial_2 G(x) \, dS(x) 
      &= \frac{1}{|B_1|} \int_{\partial B(0, 1)} \omega_1 \omega_2 \, d \omega,
    \end{align*}
    \(\partial B(0,1) = \{\omega \mid |\omega| = 1\}\). Consider: \(\omega \mapsto R \omega, (\omega_1, \dots, \omega_d) \mapsto (- \omega_1, \omega_2, \dots, \omega_d)\). Then
    \begin{align*}
      -\int_{1 \ge |x-y| \ge \epsilon} \partial_i \partial_j G(x-y) \phi(y) \, dx = 0.
    \end{align*}
    So 
    \begin{align*}
      - \int_{1 \ge |x-y| \ge \epsilon} \partial_i \partial_j G(x-y) \phi(x) \, dx &= - \int_{1 \ge |x-y|\ge \epsilon} \partial_i \partial_j G(x-y) (\phi(x) - \phi(y)) \, dx
    \end{align*}
    In summary:
    \begin{align*}
      \partial_i \partial_j (G \star f)(\phi)
      &= \int_{\mathbb{R}^d} f(y) \left(\int_{\mathbb{R}^d} \partial_i G(x-y) \partial_j \phi(x) \, dx\right) \, dy \\
      &= \int_{\mathbb{R}^d} f(y) \frac{1}{d} \partial_{ij} \phi(y) \, dy \\
      & \quad - \int_{\mathbb{R}^d} f(y) \left(\int_{|x-y| > 1} \partial_i \partial_j G(x-y) \phi(x) \, dx\right) \\
      & \quad - \int_{\mathbb{R}^d} \left[\lim_{\epsilon \to 0} \int_{1 \ge |x-y| \ge \epsilon} \underbrace{\partial_i \partial_j G(x-y) (\phi(x) - \phi(y)) \, dx}_{\smash{\le \frac{C}{|x-y|^d}|x-y| \|\nabla \phi\|_{L^\infty} \le \frac{C}{|x-y|^{d-1}} \in L_{loc}^1(dx) \forall y}}\right] \, dy \\
      &= \int_{\mathbb{R}^d} \frac{\delta_{ij}}{d} f(x) \phi(x) \, dx
      - \int_{\mathbb{R}^d} \phi(x) \left(\int_{|x-y| > 1} \partial_i \partial_j G(x-y) f(y) \, dy\right) \, dx \\
      & \quad - \int_{\mathbb{R}^d} \phi(x) \left[\int_{|x-y| \le 1} \partial_i \partial_j G(x-y) (f(y)-f(x))\, dy\right] \, dx
    \end{align*}
    Conclusion: 
    \begin{align*}
      \partial_i \partial_j (G \star f) (x) &= - \frac{\delta_{ij}}{d} f(x) + \int_{|x-y| > 1} \partial_i \partial_j G(x-y) f(y) \, dy \\
      &\quad + \int_{|x-y| \le 1} \partial_i \partial_j G(x-y) \left(f(y) - f(x)\right) \, dy
    \end{align*}
    The first term \(f \in C^{0, \alpha}\). The second term is also at least \(C^{0, \alpha}\) since \(\partial_i \partial_j G(x)\) is smooth as \(|x| > 1\). We need to prove that the thirt term
    \begin{align*}
      W_{ij}(x) &= \int_{|x-y| \le 1} \partial_i \partial_j G(x-y)(f(y) - f(x)) \, dy
    \end{align*}
    is Hölder-continuous, \(|W_{ij}(x) - W_{ij(y)}| \le C |x-y|^\alpha\). Recall:
    \begin{align*}
      |\partial_i \partial_j G(x-y) (f(y)-f(x))| \le C \frac{1}{|x-y|^d}|x-y|^\alpha = \frac{C}{|x-y|^{d-\alpha}} \in L_{loc}^1(dy)
    \end{align*}
    We write 
    \begin{align*}
      W_{ij}(x) 
      &= \int_{|x-y| \le 1} \partial_i \partial_j G(x-y) (f(y)-f(x)) \, dy \\
      &= \int_{|z| \le 1} \partial_i \partial_j G(z) (f(x+z)-f(x)) \, dz
    \end{align*}
    So we get: \begin{align*}
      W_{ij} - W_{ij}(y) &= \int_{|z| \le 1} \partial_i \partial_j G(z) (f(x+z)-f(y+z)-f(x)+f(y)) \, dz
    \end{align*}
    Easy thought: Use \(\partial_i \partial_j G(z)| \le \frac{C}{|z|^d}\) and 
    
    \begin{align*}
      &|f(x+z) - f(y+z) - f(x) + f(y)| \\
      &\quad\le 
      \begin{cases}
        |f(x+z) - f(x)| + |f(y+z)-f(y)| \le C|z|^\alpha \\
        |f(x+z) - f(y+z)| + |f(x) - f(y)| \le C|x-y|^\alpha
      \end{cases}
    \end{align*}
    Thus: 
    
    \begin{align*}
      |W_{ij}(x) - W_{ij}(y)| 
      &\le C \int_{|z| \le 1} \frac{1}{|z|^d} \min(|z|^\alpha, |x-y|^\alpha) \, dz \\
      &\le C \int_{|z| \le 1} \frac{1}{|z|^d} (|z|^\alpha)^\epsilon (|x-y|^\alpha)^{1-\epsilon}, \quad 0 < \epsilon < 1 \\
      &\le C \left(\int_{|z| \le 1} \frac{1}{|z|^{d-\alpha \epsilon}}\right)|x-y|^{\alpha(1-\epsilon)} \\
      &\le C_\epsilon |x-y|^{\alpha (1 - \epsilon)}
    \end{align*}

    thus it is easy to prove \(|W_{ij}(x) - W_{ij}(y)| \le C_\alpha |x-y|^\alpha\) for all \(\alpha' \le \alpha\). However, to get \(\alpha' = \alpha\) we need a more precise estimate. We split:
    \begin{align*}
      W_{ij}(x) - W_{ij}(y) 
      &= \int_{|z| \le 1} \dots = \int_{|z| \le min(4|x-y|, 1)} + \int_{4|x-y| < |z| \le 1}
    \end{align*}
    For the first domain:
    \begin{align*}
      &\int_{|z| \le 4 |x-y|} |\partial_{ij} G(z)| |f(x+z)-f(y+z)-f(y)+f(x)| \, dz \\
      &\quad \le C \int_{|z| \le 4|x-y|} \frac{1}{|z|^d} |z|^\alpha \, dz
      = const \cdot |x-y|^\alpha
    \end{align*}
    For the second domain:
    \begin{align*}
      &\int_{4|x-y| < |z| \le 1} \partial_{ij} G(z) (f(x+z) - f(y+z) + f(y)  f(x)) \, dz \\
      &\quad = \int_{4|x-y| < z \le 1} \partial_{ij} G(z) (f(x+z) - f(y+z)) \, dz = (\ldots)
    \end{align*}
    since \(\int_{4|x-y|<|z|\le1} \partial_{ij}G(z) \, dz = 0\). Then
    \begin{align*}
      (\ldots) &= \int_{4|x-y| < |z-x| \le 1} \partial_{ij} G(z-x) f(z) \, dz - \int_{4|x-y| < |z-y| \le 1} \partial_{ij} G(z-y) f(z) \, dz.
    \end{align*}
    Denote \(A = \{z \mid 4 |x-y| < |z-x| \le 1\}\), \(B = \{z \mid 4|x-y| < |z-y| \le 1\}\). Consider 
    \begin{align*}
      &\int_A \partial_{ij} G(z-x) f(z) \, dz - \int_B \partial_{ij} G(z-y) f(z) \, dz \\
      &\quad = \int_{A\setminus B} + \int_{B \setminus A} + \int_{A \cap B} (\partial_{ij} G(z-x) - \partial_{ij} G(z-y))f(z) \, dz
    \end{align*}
    Lets regard the intersection. We have \begin{align*}
      \partial_{ij} G(x) &= \frac{1}{|B_1|}\frac{1}{|x|^d} (\omega_i \omega_j - \frac{1}{d} \delta_{ij}) \\
      |\partial_{ij}G(x) - \partial_{ij}G(y)| &\le C|x-y| \left(\frac{1}{|x|^{d+1}} + \frac{1}{|y|^{d+1}}\right)
    \end{align*}
    Now, 
    \begin{align*}
      |\partial_{ij} G(z-x) - \partial_{ij} G(z-y)|
      &\le C |x-y| \left(\frac{1}{|z-x|^{d+1}} + \frac{1}{|z-y|^{d+1}}\right)
    \end{align*}
    So we have 
    \begin{align*}
      &\left| \int_{A \cap B} (\partial_{ij} G(z-x) - \partial_{ij} G(z-y)) f(z) \, dz \right| \\
      &\quad \le C \int_{A \cap B} |x-y| \left(\frac{1}{|z-x|^{d+1}} + \frac{1}{|z-y|^{d+1}}\right) |f(z)| \, dz = (\ldots)
    \end{align*}
    Now we replace \(f(z)\) by \(f(z) - f(x)\), then:
    \begin{align*}
      &\left| \int_{A \cap B} (\partial_{ij} G(z-x) - \partial_{ij} G(z-y)) (f(z)-f(x)) \, dz \right| \\
      &\quad \le C \int_{A \cap B} |x-y| \left(\frac{1}{|z-x|^{d+1}} + \frac{1}{|z-y|^{d+1}}\right) |z-x|^\alpha \, dz \\
      &\quad = C \underbrace{\int_{A \cap B} |x-y| \frac{1}{|z-x|^{d + 1 - \alpha}} \, dz}_{(I)} + \underbrace{C \int_{A \cap B} |x-y| \frac{1}{|z-y|^{d+1}}|z-x|^\alpha \, dz}_{(II)}
    \end{align*}
    Now, \begin{align*}
      (I) &\le C |x-y| \int_{4 |x-y| < |z-x| \le 1} \frac{1}{|z - x|^{d+1-\alpha}} \, dz \\
      &= C |x-y| \int_{4 {x-y} < |z| \le 1} \frac{1}{|z|^{d+1-\alpha}} \, dz \\
      &\le C|x-y| \int_{4|x-y|}^1 \frac{1}{r^{d+1-\alpha}}r^{d-1} \, dr \\
      &= C|x-y| \int_{4|x-y|}^1 \frac{1}{r^{2-\alpha}} \, dr \\
      &\le C |x-y| \left[-1 + \frac{1}{(4|x-y|)^{1-\alpha}}\right] \\
      &\le C|x-y|^\alpha
    \end{align*}

    \begin{align*}
      (II) &\le C |x-y| \int_{A \cap B} \frac{1}{|z-y|^{d+1}} |z-x|^\alpha \, dz \\
      &\le C |x-y| \int_{A \cap B} \frac{1}{|z-y|^{d+1}} \left(|z-y|^\alpha + |x-y|^\alpha\right) \, dz \\
      &\le \underbrace{C |x-y| \int_B \frac{1}{|z-y|^{d+1-\alpha}} \, dz}_{\text{similar to (I)}} +\ C |x-y|^{1+\alpha} \int_B \frac{1}{|z-y|^{d+1}} \, dz \\
    \end{align*}
    and \begin{align*}
      C |x-y|^{1+\alpha} \int_B \frac{1}{|z-y|^{d+1}} \, dz
      &\le \int_{4|x-y|} \frac{1}{r^{d+1}} r^{d-1} \, dr 
      \le \frac{C}{|x-y|}
    \end{align*}
    Consider \(A \setminus B\): 
    \begin{align*}
      \left| \int_{A \setminus B} \right| \le C \|f\|_{L^\infty} \int_{A \setminus B} \frac{1}{|z-x|^d} \, dz
    \end{align*}
    where
    \begin{align*}
      A &= \{z \mid 4 |x-y| < |z-x| \le 1\} \\
      B &= \{z \mid 4 |x-y| < |z-y| \le 1\} \\
      A \setminus B &= \{z \in A \mid |z-y| \le 4 |x-y|\} \cup \{z \in A \mid |z-y| > 1\} = E_1 \cup E_2 \\
    \end{align*}
    for 
    \begin{align*}
      E_1 &= \{z \mid |z-y| \le 4 |x-y| < |z-x| \le 1\} \\
      &\subseteq \{ z \mid 4 |x-y| \le |x-z| \le 5 |x-y| \}.
    \end{align*}
    \(|x-z| \le |x-y| + |y-z| \le 5 |x-y|\) in \(E_1\).
    We have 
    \begin{align*}
      \int_{E_1} \frac{1}{|z-x|^d} \, dz 
      &\le \int_{4|x-y| \le |x-z| \le 5 |x-y|} \frac{1}{|z-x|^{d-\alpha}} \, dz \\
      &= \int_{4|x-y| \le |z| \le 5 |x-y|} \frac{1}{|z|^{d-\alpha}} \, dz \\
      &= \int_{4|x-y|} \frac{1}{r^d} r^{d-1} \, dr \\
      &= \int_{4|x-y|} \frac{1}{r^{1-\alpha}} \, dr \\
      &\le C |x-y|^\alpha
    \end{align*}
    Now in \(E_2\): \(|z-x| \ge |z-y| - |y-x| \ge 1 - |y-x|\).
    \begin{align*}
      \int_{E_2} \frac{1}{|z-x|^{d-\alpha}} \, dz
      &\le \int \frac{1}{|z-x|^{d-\alpha}} \, dz
      = \int_{1-|x-y|}^1 \frac{1}{r^{d-\alpha}} r^{d-1} \, dr \\
      &\le const. \left| 1 - \frac{1}{(1 - |x-y|)^\alpha} \right| \le C |x-y|^\alpha
    \end{align*}
  \end{proof}

  \begin{ex}[E 5.1]
    Prove that if \(f\) is a harmonic function in \(\mathbb{R}^d\) and \(g \in C_c(\mathbb{R}^d)\) is radial, then
    \[\int_{\mathbb{R}^d} f(x) g(x) \, dx = f(0) \int_{\mathbb{R}^d} g(x) \, dx\]
  \end{ex}

  \begin{proof}[Solution]
    \(x = r \omega, r > 0, |\omega| = 1\)
    \begin{align*}
      \int_{\mathbb{R}^d} f(x) g(x) \, dx &\overset{{\text{(Polar)}}}{=} \int_0^\infty \left(\int_{\partial B(0,1)} f(r\omega) g(r\omega) \, d \omega\right) \, dr \\
      &= \int_0^\infty \left(g_0(r) \int_{\partial B(0, 1)} f(r \omega) \, d \omega   \right) \, dr \\
      \text{(Mean value theorem (\ref{mean-value-theorem}))} \quad &= \int_0^\infty \left(g_0(r) f(0) \int_{\partial B(0, 1)}\, d \omega\right) \, dr \\
      &= f(0) \int_0^\infty \left( \int_{\partial B(0,1)} g(r \omega) \, d \omega \right) \, dr \\
      &= f(0) \int_{\mathbb{R}^d} g(x) \, dx \qedhere
    \end{align*}
  \end{proof}

  \begin{rem}
    Let \(g \in C_c(\mathbb{R}^d)\) be radial. Why is \(\int_{\mathbb{R}^3} \frac{g(x)}{|x|} \,dx \ne \infty\)? Because \(f(x) = \frac{1}{|x|}\) is harmonic in \(\mathbb{R}^d \setminus \{0\}\) and sub-harmonic in \(\mathbb{R}^d\), \(- \Delta f= c \delta_0\).
  \end{rem}

  \begin{ex}[E 5.2]
    Let \(1 \le p < \infty\). Let \(\Omega \subseteq \mathbb{R}^d\) be open. Consider the Sobolev Space
    \begin{align*}
      W^{1, p}(\Omega) &= \{f \in L^p(\Omega) \mid \partial_{x_i} f \in L^p(\Omega), \ \forall i = 1, 2, \dots, d\}
    \end{align*}
    with the norm
    \[\| f \|_{W^{1,p}} = \|f\| + \sum_{i=1}^d \| \partial_{x_i} f\|_{L^p(\Omega)}.\]
    Prove that \(W^{1,p}(\Omega)\) is a Banach space. Here \(x = (x_i)_{i=1}^d \in \mathbb{R}^d\). Hint: You can use the fact that \(L^p(\Omega)\) is a Banach Space.
  \end{ex}

  \begin{proof}[Solution]
    \(W^{1,p}(\Omega) \subseteq L^p(\Omega) \times L^p(\Omega) \cdots \times L^p(\Omega) = (L^p(\Omega))^{d+1}\). For an element \(f \in W^{1,p}(\Omega)\) we can think of it as \(f \mapsto (f, \partial_1 f, \partial_2 f, \dots, \partial_d f)\), so \(W^{1,p}(\Omega)\)  is a subspace of \((L^p(\Omega))^{d+1}\), which is a norm-space. Why is \(W^{1,p}(\Omega)\) closed in \((L^p(\Omega))^{d+1}\)? Take \(\{f_n\}_{n=1}^\infty \subseteq W^{1,p}(\Omega)\) such that \(f_n \to f\) in \(L^p\) an \(\partial_i f_n \to g_i\) in \(L^p\) for all \(i = 1, \dots, d\). We prove that \((f, g_1, \dots, g_d) \in W^{1,p}(\Omega)\), i.e. \(f \in W^{1,p}\) and \(g_i = \partial_i f\) for all \(i = 1, \dots, d\). We know that \(f_n \to f\) in \(L^p(\Omega)\), so \(f_n \to f\) in \(D'(\Omega)\) and \(\partial_i f_n \to \partial_i f\) in \(D'(\Omega)\). On the other hand we have \(partial_i f_n \to g_i\) in \(L^p(\Omega)\), so \(\partial_i f_n \to g_i\) in \(D'(\Omega)\). So we get \(\partial_i f = g_i \in L^p(\Omega)\) for all \(i=1, \dots, d\) in \(D'(\Omega)\). So we can conclude \(f \in W^{1,p}(\Omega)\) and \(\partial_i f = g_i\) for all \(i = 1, \dots, d\).
  \end{proof}

  \begin{ex}[E 5.3]
    Let \(f\) be a real-valued function in \(W^{1,p}(\mathbb{R}^d)\) for some \(1 \le p < \infty\). Prove that \(|f| \in W^{1,p}(\mathbb{R}^d)\) and 
    \begin{align*}
      (\nabla |f|)(x) &= \begin{cases}
        \nabla f(x) & f(x) > 0 \\ - \nabla f(x) & f(x) < 0 \\ 0 & f(x) = 0
      \end{cases}.
    \end{align*}
  \end{ex}

  \begin{proof}[Solution]
    Consider \(G_\epsilon(t)= \sqrt{\epsilon^2 + t^2} - \epsilon\) for \(\epsilon > 0\), \(t \in \mathbb{R}\). Clearly we have \(G_\epsilon(t) \to |t|\) as \(\epsilon \to 0\) and 
    \begin{align*}
      G_\epsilon'(t) &= \frac{2t}{2 \sqrt{\epsilon^2 + t^2}} = \frac{t}{\sqrt{\epsilon^2 + t^2}},
    \end{align*}
    so \(|G_\epsilon'(t)| \le 1\), \(G_\epsilon(0) = 0\). By the chain rule, \(G_\epsilon(f) \in W^{1,p}(\mathbb{R}^d)\) and 
    \begin{align*}
      (\partial_i G_\epsilon(f))(x) &= G_\epsilon'(f) \partial_if(x) = \frac{f(x)}{\sqrt{\epsilon^2 + f^2(x)}} \partial_i f(x) \in L^p(\mathbb{R}^d)
    \end{align*}
    for all \(i = 1, \dots, d\). Note then when \(\epsilon \to 0\) that \(G_\epsilon(f)(x) \to |f(x)|\) pointwise, so \(G_\epsilon(f) \to |f|\) in \(L^p(\mathbb{R}^d)\). \(|G_\epsilon(f)(x) - G_\epsilon(0)| \le |f(x)| \in L^p(\mathbb{R}^d)\) by dominated convergence. \begin{align*}
      \partial_i G_\epsilon(f)(x) 
      &= \frac{f(x)}{\sqrt{\epsilon^2 + f^2(x)}} \partial_i f(x) \xrightarrow{\epsilon \to 0} g_i(x) \coloneqq \begin{cases}
        \partial f_i(x) & f(x) > 0 \\ - \partial_i f(x) & f(x) < 0 \\ 0 & f(x) = 0
      \end{cases} \\
      |\partial_i G_\epsilon(f)(x)|
      &\le \left| \frac{f(x)}{\sqrt{\epsilon^2 + f^2(x)}}\right| |\partial_i f(x)| \le |\partial_i f(x)| \in L^p(\mathbb{R}^d)
    \end{align*}
    So we get \(\partial_i G_\epsilon(f) \xrightarrow{\epsilon \to 0} g_i\) in \(L^p(\mathbb{R}^d)\) by Dominated Convergence. So we conclude: \(\partial_i(|f|) = g_i \in L^p(\mathbb{R}^d)\) for all \(i = 1, \dots, d\), so \(|f| \in W^{1,p}(\mathbb{R}^d)\), \(|f| \in L^p\).
  \end{proof}

  \begin{ex}[E 5.4]
    Let \(\Omega \subseteq \mathbb{R}^d\) be open and bounded, \(f \in L^1(\Omega)\), 
    \begin{align*}
      u(x) &= \int_\Omega G(x-y)f(y) \, dy
    \end{align*}
    Let \(- \Delta u = f\) in \(D'(\Omega)\), \(u \in L_{loc}^1(\Omega)\), \(f \in L_{loc}^1(\mathbb{R}^d)\) and \(\omega_d f \in L^1(\mathbb{R}^d)\), where \[\omega_d (x) = \begin{cases}
      1 + |x| & d = 1 \\ \log(1 + |x|) & d = 1 \\ \frac{1}{(1 + |x|)^{d-2}} & d \ge 3
    \end{cases}.\]
    Prove that \begin{align*}
      G \star f &= \int_{\mathbb{R}^d} G(x-y) f(y) \, dy \in L_{loc}^1(\mathbb{R}^d) 
    \end{align*}
    and \(- \Delta (G \star f) = f\) in \(D'(\mathbb{R}^d)\).
  \end{ex}

  \begin{proof}[Solution]
    Define \(\tilde f = \mathbb{1}_\Omega(x) f(x) = \begin{cases}
      f(x) & x \in \Omega \\ 0 & x \notin \Omega
    \end{cases}\). Then 
    \begin{align*}
      u(x) &= \int_{\Omega} G(x-y)f(y) \, dy = \int_{\mathbb{R}^d} G(x-y) \tilde f(y) \, dy = (G \star \tilde f)(x)
    \end{align*}
    We have \(u \in L_{loc}^1(\mathbb{R}^d)\), so \(u \in L^1(\Omega)\).
    Then \(- \Delta u = \tilde f\) in \(D'(\mathbb{R}^d)\), so \(- \Delta u = f\) in \(D'(\Omega)\). Claim: \(- \Delta u = f\) in \(D'(\mathbb{R}^d)\), so \(- \Delta u = f\) in \(D'(\Omega)\) if \(\Omega \subseteq \mathbb{R}^d\), \(\tilde f|_\Omega = f\). Take \(\phi \in C_c^\infty(\Omega)\). We need: \((- \Delta u)(\phi) \overset{?}{=} \int_\Omega f \phi\). We have \(\phi \in C_c^\infty(\Omega)\), so \(\phi C_c^\infty(\mathbb{R}^d)\). This implies:
    \begin{align*}
      (- \Delta u)(\phi) 
      &= \int_{\mathbb{R}^d} \tilde f \phi 
      = \int_{\substack{\Omega, \\ \supp \phi \subseteq \Omega}} \tilde f \phi = \int_\Omega f \phi \qedhere
    \end{align*}
  \end{proof}

  \begin{ex}[E 5.5]
    Let \(B = B\left(0, \frac{1}{2}\right) \subseteq \mathbb{R}^3\). Consider \(u: B \to \mathbb{R}\), defined by 
    \begin{align*}
      u(x) &= \log|\log|x||.
    \end{align*}
    Prove that the distributional derivative \(f = - \Delta u\) is a function in \(L^{\frac{3}{2}}(B)\).
  \end{ex}

  \begin{proof}[Solution]
    \begin{align*}
      \omega(r) &= \log(-\log(r)), \quad \text{for } r \in \left(0, \frac{1}{2}\right) \\
      \omega'(r) &= \frac{1}{- \log(r)} \left(- \frac{1}{r}\right) = \frac{1}{r \log{r}} \\
      \omega''(r) &= - \frac{1}{(r \log(r))^2}(r \log(r))' = - \frac{\log(r)+1}{(r \log r)^2}
    \end{align*}
    So we have 
    \begin{align*}
      - \Delta u = w''(r) = \frac{1}{(r \log r)^2} - \frac{1}{r^2 \log(r)} = f(r)
    \end{align*}
    % Originally:
    % \[- \Delta u = - \omega''(r) - \frac{2 \omega'(r)}{r} = \frac{\log(r) + 1}{(r \log(r))^2} - \frac{2}{r^2 \log (r)} = \frac{1}{(r \log r)^2} - \frac{1}{r^2 \log(r)} = f(r)\]
    We show that \(f \in L^{\frac{3}{2}}: \) 
    \begin{align*}
      \int_B |f(x)|^{\frac{3}{2}} \, dx 
      &= const \int_0^{\frac{1}{2}} \left| \frac{1}{r^2 (\log r)^2} - \frac{1}{r^2 \log{r}} \right|^{\frac{3}{2}} r^2 \, dr \\
      &\tilde < \int_0^{\frac{1}{2}} \frac{1}{r} \left| \frac{1}{(\log(r))^2} - \frac{1}{(\log(r))} \right|^{\frac{3}{2}} \, dr \\
      \left(\begin{aligned}
        r = e^{-x}, \\
        x \in (\log(2), \infty), \\
        dr = -e^{-x} \, dx
      \end{aligned}\right) \quad &\tilde < \int_{\log(2)}^\infty e^x \left(\frac{1}{x^2} + \frac{1}{x}\right)^{\frac{3}{2}} e^{-x} \, dx \\
      &\tilde < \int_{\log(2)}^\infty \frac{1}{x^{\frac{3}{2}}} \, dx < \infty
    \end{align*}
    Where \(\tilde <\) means \emph{up to a constant}. Now, \(u(x) = \omega(r) = \log(-\log(r))\). 
    \begin{align*}
      - \Delta u(x) &= f(r) = \frac{1}{r^2(\log(r))^2} - \frac{1}{r^2\log(r))}
    \end{align*}
    for all \(x \ne 0, |x| = r < \frac{1}{2}\). Why is \(- \Delta u(x) = f\) in \(D'(B)\)? Take \(\phi \in C_c^\infty(B)\), check: \(\int_B u(-\Delta \phi) = \int_B f \phi\). 
    \begin{align*}
      \int_{|x| < \frac{1}{2}} u (- \Delta \phi) \, dx = \lim_{\epsilon \to 0^+} \int_{\epsilon < |x| < \frac{1}{2}} u(x) (- \Delta \phi)(x) \, dx
    \end{align*}
    by Dominated convergence. \(u \in L^1(B)\). For all \(\epsilon > 0\):
    \begin{align*}
      \int_{\epsilon < |x| < \frac{1}{2}} u(x) (-\Delta \phi)(x) \, dx 
      &= \int_{|x|>\epsilon} u(x) (-\Delta \phi)(x) \, dx \\
      &= \int_{\partial B(0, \epsilon)}u(x) \nabla \phi(x) \frac{x}{|x|} \, dS(x) + \int_{|x| > \epsilon} \nabla u(x) \nabla \phi(x) \, dx
    \end{align*}
    The boundary term vanishes as \(\epsilon \to 0\) since 
    \begin{align*}
      \left|u(x) \nabla \phi(x) \frac{x}{|x|}\right| \le \|\nabla \phi \|_{L^\infty} |u(x)| = C \log|\log(r)|
    \end{align*}
    \begin{align*}
      \left| \int_{\partial B(0, \epsilon)} u(x) \nabla \phi(x) \frac{x}{|x|} \, dS(x) \right| 
      &\le C \int_{\partial B(0, \epsilon)} \log |\log(\epsilon)| \, dS(x) \\
      &= C \log |\log \epsilon| \underbrace{|\partial B(0, \epsilon)|}_{\sim \epsilon^2} \xrightarrow{\epsilon \to 0} 0
    \end{align*}
    \begin{align*}
      &\int_{|x|> \epsilon} \nabla u(x) \nabla \phi(x) \, dx 
      = \sum_{i=1}^d \int_{|x|> \epsilon} \partial_i u(x) \partial_i \phi(x) \, dx \\
      &\quad= \sum_{i=1}^d \left(- \int_{\partial B(0, \epsilon)} \partial_i u(x) \phi(x) \frac{x_i}{|x|} \, dS(x) - \int_{|x|> \epsilon} \underbrace{\partial_i \partial_i u(x)}_{f(x)} \phi(x) \, dx\right)
    \end{align*}
    The boundary term vanishes as \(\epsilon \to 0\) as 
    \begin{align*}
      \left| \int_{\partial B(0, \epsilon)} \partial u(x) \phi(x) \frac{x_i}{|x|}\, dS(x) \right|
      &\le \|\phi\|_{L^\infty} \int_{\partial B(0, \epsilon)} |\partial_i u(x)| \, dS(x) \\
      (\star) \quad &\le C \frac{1}{|\epsilon \log(r)|} |\partial B(0, \epsilon)| \to 0
    \end{align*} as \(\epsilon \to 0\). 
    \((\star) u = u(r), u(x) = \omega(|x|), \partial_i u(x) = \omega(|x|)\frac{x_i}{|x|}\), \(|\partial_i u(x)| \le |\omega(|x|)| = \left|\frac{1}{r\log(r)}\right|\). Finally:
    \begin{equation*}
      \int_{|x|> \epsilon} f(x) \phi(x) \, dx \xrightarrow{\epsilon \to 0} \int_{\mathbb{R}^d} f(x) \phi(x) \, dx
    \end{equation*}
    Since \(f \phi \in L^1\) and Dominated Convergence.
  \end{proof}

  \begin{ex}[Bonus 5]
    Construct \(u \in L^1(\mathbb{R}^3)\) compactly supported s.t. \(- \Delta u \in L^{\frac{3}{2}}(\mathbb{R}^3)\) and \(u\) is not continuous at \(0\).
  \end{ex}
  Hint: Related to E 5.5. \(u_0(x) = \omega(r) = \log(|\log(r)|)\) if \(0 < r = |x| < \frac{1}{2}\). Consider \(\chi u_0\) where \(\chi \in C_c^\infty\), \(\chi = 0\) if \(|x| > \frac{1}{2}\), \(\chi = 1\) if \(|x| < \frac{1}{4}\). You can prove that \(\Delta (\chi u_0) = (\Delta \chi) u_0 + 2 \nabla \chi \nabla u_0 + \chi(\underbrace{\Delta u_0}_{\in L^{\frac{3}{2}}})\) in \(D'(\mathbb{R}^3)\). (almost everywhere, in distributional sense, integration by parts)

  \begin{thm}[Regularity on Domains] Let \(\Omega \subseteq \mathbb{R}^d\) be open. Assume \(u, f \in D'(\Omega)\) such that \(- \Delta u = f\) in \(D'(\Omega)\).
    \begin{enumerate}[label=\alph*)]
      \item If \(f \in L_{loc}^1(\Omega)\), then \begin{itemize}
        \item \(u \in C^1(\Omega)\) if \(d = 1\)
        \item \(u \in L_{loc}^q(\Omega)\) for all \(q < \infty\) if \(d = 2\)
        \item \(u \in L_{loc}^q(\Omega)\) for all \(q < \frac{d}{d-2}\) if \(d \ge 3\)
      \end{itemize}
      \item If \(f \in L_{loc}^q(\Omega)\), \( d \ge p < \frac{d}{2}\), then \(u \in C_{loc}^{0, \alpha}(\Omega)\), where \(0 < \alpha < 2 - \frac{d}{p}\)
      \item If \(f \in L_{loc}^p(\Omega)\), \(p > d\)f, then \(u \in C_{loc}^{1, \alpha}(\Omega)\), where \(0 \le \alpha < 1 - \frac{d}{p}\)
      \item If \(f \in C_{loc}^{0, \alpha}(\Omega)\) for some \(0 < \alpha < 1\), then \(u \in C_{loc}^{2, \alpha}(\Omega)\)
      \item If \(f \in C_{loc}^{m, \alpha}(\Omega)\), then \(u \in C_{loc}^{m+2, \alpha}(\Omega)\)
    \end{enumerate}
  \end{thm}

  \begin{proof}
    Let \(\mathbb{K} \in \{\mathbb{R}, \mathbb{C}\}\).
    Take a ball \(\overline B \subseteq \Omega\). Define \(f_B: \mathbb{R}^d \to \mathbb{K}\), \begin{align*}
      f_B(x) &= (\mathbb{1}_B f)(x) = \begin{cases}
        f(x) & x \in B \\ 0 & x \notin B
      \end{cases}
    \end{align*}
    Then if \(f \in L_{loc}^1(\Omega)\), \(f_B\) is compactly supported. From the previous theorems: \(G \star f_B \in L_{loc}^1(\mathbb{R}^d)\) and \(- \Delta (G \star f_B) = f_B\) in \(D'(\mathbb{R}^d)\). On the other hand, \(- \Delta u = f\) in \(D'(\Omega)\), so \(- \Delta(u - G \star f_B) = 0\) in \(D'(B)\). Indeed, for all \(\phi \in C_c^\infty(B)\), then:
    \begin{align*}
      (- \Delta u)(\phi) &= \int_\Omega f \phi = \int_B f_B \phi = - \int_{\mathbb{R}^d} f_B \phi = (-\Delta)(G \star f_B)(\phi)
    \end{align*}
    Then \(- \Delta u = - \Delta (G \star f_B)\) in \(D'(B)\). Then \(u - G \star f_B\) is harmonic in \(B\) and by Weyls lemma we have \(u - G \star f_B \in C^\infty(B)\). So the smoothness of \(u\) in \(B\) is the same to that of \(G \star f\).
  \end{proof}


  \begin{ex}[E 6.1]
    Show that If \(\chi \in C^\infty(\mathbb{R}^d)\), then \(f \in W^{1,p}(\mathbb{R}^d)\), \(1 \le p < \infty\), then \(\chi f \in W_{loc}^{1, p}(\mathbb{R}^d)\) and 
    \[\partial_i (\chi f) = (\partial_i \chi) f + \chi(\partial_i f) \quad \text{in } D'(\mathbb{R}^d)\]
  \end{ex}

  \begin{proof}[Solution]
    \(\chi f \in L_{loc}^p(\mathbb{R}^d)\) obvious. \(\partial (\chi f) \in L_{loc}^p(\mathbb{R}^d)\) is nontrivial but follows from \(\partial_i (\chi f) = \underbrace{(\partial_i \chi) f + \chi (\partial f)}_{\in L_{loc}^p}\) in \(D'(\mathbb{R}^d)\). To compute the distributional derivative \(\partial_i (\chi f)\), then: Take \(\phi \in C_c^\infty(\mathbb{R}^d)\): 
    \begin{align*}
      - \int_{\mathbb{R}^d} \chi f (\partial \phi)
      &= \int_{\mathbb{R}^d}(?) \phi 
    \end{align*}
    We have 
    \begin{align*}
      - \int_{\mathbb{R}^d}\chi f(\partial_i \phi) 
      &= - \int_{\mathbb{R}^d} f(\chi \partial_i \phi) \\
      (\chi \partial_i \phi = (\partial_i \chi)\phi + \chi(\partial_i \phi)) \quad &= - \int_{\mathbb{R}^d} f \left(\partial_i(\chi \phi)-(\partial_i \chi) \phi\right) \\
      &= - \int_{\mathbb{R}^d} f \partial_i(\underbrace{\chi \phi}_{\in C_c^\infty}) + \int_{\mathbb{R}^d} f (\partial_i \chi) \phi \\
      &= \int_{\mathbb{R}^d} (\partial_i f) \chi \phi + \int f(\partial_i \chi) \phi \\
      &= \int_{\mathbb{R}^d} ((\partial_i f) \chi + f (\partial_i \chi)) \phi
    \end{align*}
    So \(\partial_i (\chi f) = (\partial_i f) \chi + f (\partial_i \chi)\) in \(D'(\mathbb{R}^d)\).
  \end{proof}

  \begin{rem}
    Question: If \(\chi \in C^1(\mathbb{R}^d)\), \(f \in W^{1,p}(\mathbb{R}^d)\). Is this it still correct that \(\partial_i (\chi f) = (\partial_i \chi) f + \chi(\partial_i f) \quad \text{in } D'(\mathbb{R}^d)\)?
  \end{rem}
  
  \begin{proof}
    It suffices to show that we still can apply intergration by parts.
    \begin{align*}
      (\star) \quad - \int f \partial_i g
      &\overset{?}{=} \int(\partial_i f) g
    \end{align*}
    Approximation: \((\star)\) is correct if \(g \in C_c^\infty\) \begin{itemize}
      \item If \(g \in C_c^1\), there is \(\{g_n\} \subseteq C_c^\infty\) s.t. \(g_n \to g\) in \(W_{loc}^{1,p}\), \(\frac{1}{p} + \frac{1}{q} = 1\).
      \begin{align*}
        \int (\partial_i g) f \xleftarrow{n \to \infty} - \int \underbrace{f}_{L^p} \underbrace{\partial g_n}_{\to \partial_i g \text{ in } L^q} = \int \underbrace{(\partial_i f)}_{\in L^p} \underbrace{g_n}_{\to g \text{ in } L^q} \xrightarrow{n \to \infty} \int (\partial_i f) g
      \end{align*}
    \end{itemize}
  \end{proof}

  \begin{ex}[E 6.2]
    \(\mathbb{R}^2\), \(G(x) = - \frac{1}{2 \pi} \log |x|\). Let \(f \in L^p(\mathbb{R}^d)\), compactly supported. Define \(u(x) =(G \star f)(x) = \int_{\mathbb{R}^2} G(x-y) f(y) \, dy\)
    \begin{enumerate}
      \item If \(p = 1\), then \(u \in L_{loc}^q(\mathbb{R}^2)\) for all \(q < \infty\).
      \item If \(p > 2\), then \(u \in C^{1, \alpha}\) with \(0 < \alpha < 1 - \frac{2}{p}\).
    \end{enumerate}
  \end{ex}

  \begin{proof}[Solution]
    \begin{enumerate}
      \item Take any ball \(B = B(0,R)\) and:
      \begin{align*}
        \int_B |u(x)|^q \ dx 
        &= \int_B \left(\int_{\mathbb{R}^d} |G(x-y)| |f(y)| \, dy\right)^q \, dx \\
        &\le C \int_{B} \left(\int_{\mathbb{R}^2} |G(x-y)|^q |f(y)| \, dy\right) \, dx  \\
        &= C \int_{\mathbb{R}^2} \left(\int_B |G(x-y)|^q \, dx\right) |f(y)| \, dy
      \end{align*}
      Recall from the proof of Youngs inequality:
      \begin{align*}
        |u(x)| &= \left| \int_{\mathbb{R}^2} G(x-y) f(y) \, dy \right| \\
        &\le \int_{\mathbb{R}^2} |G(x-y)||f(y)| \, dy \\
        &\le \left(\int_{\mathbb{R}^2} |G(x-y)|^q |f(y)| \, dy\right)^{\frac{1}{q}} \left(\int_{\mathbb{R}^2} |f(y)| \, dy\right)^{\frac{1}{q}}, \quad \frac{1}{q} + \frac{1}{q'} = 1
      \end{align*}
      Assume \(\supp f \subseteq \overline{B(0, R)}\). Then if \(y \in \supp f\) and \(x \in B(0,R)\), then \(|x-y| \le |x| + |y| \le R + R_1\). For all \(y \in \supp f\):
      \begin{align*}
        \int_{B(0, R)} |G(x-y)|^q \, dx
        &\le \int_{|x-y| \le R + R_1} |G(x-y)|^q \, dx \\
        &= \int_{|z| \le R + R_1} |G(z)|^q \, dz < \infty
      \end{align*}
      as \(G \in L_{loc}^q\) (\(|G(z)| = \frac{1}{2 \pi} |\log(z)| \le \frac{C_{R + R_1, \epsilon}}{|z|^\epsilon}\) for all \(|z| \le R + R_1\)), so 
      \begin{align*}
        \int_{|z| \le R + R_1} |G(z)|^q \le C_{R + R_1, \epsilon} \int_{|z| \le R + R_1} \frac{1}{|z|^{\epsilon q}} \, dz < \infty
      \end{align*}
      if \(\epsilon q < 2\).
      \item Recall \(\partial_i u \in L_{loc}^1(\mathbb{R}^2)\) and:
      \begin{align*}
        \partial_i u(x) &= (\partial_i G \star f)(x) 
        = c \int_{\mathbb{R}^2} \frac{x_i - y_i}{|x-y|^2} f(y) \, dy
      \end{align*}
      First we show \(\partial_i u \in C^{0, \alpha}\): 
      \begin{align*}
        |\partial_i u(x) - \partial_i u(z)|
        &= \left| C \int_{\mathbb{R}^2} \left(\frac{x_i - y_i}{|x-y|^2} - \frac{z_i - y_i}{|z-y|^2}\right) \, f(y) \, dy \right| \\
        &\le C \int_{\mathbb{R}^2} \left| \frac{x_i y_i}{|x-y|^2} - \frac{z_i - y_i}{|z-y|^2} \right| |f(y)| \, dy \\
        &\overset{?}{\le} C |x-y|^\alpha
      \end{align*}
      Note that 
      \begin{align*}
        \left| \frac{x_i - y_i}{|x-y|^2} - \frac{z_i - y_i}{|z-y|^2} \right| 
        &= \left| (x_i  - y_i) \left(\frac{1}{|x-y|^2} - \frac{1}{|z-y|^2}\right) + \frac{x_i - z_i}{|z-y|^2} \right| \\
        &\le |x_i - y_i| \left| \frac{1}{|x-y|^2} - \frac{1}{|z-y|^2} \right| + \frac{|x_i - z_i|}{|z-y|^2} \\
        &\le C|z-x|^\alpha \left(\frac{1}{|x-y|^{1 + \alpha}} + \frac{1}{|z-y|^{1 + \alpha}} + \frac{|x-z|}{|z-y|^{2}}\right)
      \end{align*}
      Here \(|x_i - z_i| \le |x-z|\) and \(|x_i - y_i| \le |x-y|\) and:
      \begin{align*}
        \smash{\underbrace{\left| \frac{1}{|x-y|^2} - \frac{1}{|z-y|^2} \right|}_{\text{sym } x \leftrightarrow z}}
        &= \left| \frac{1}{|x-y|} - \frac{1}{|z-y|}\right| \left| \frac{1}{|x-y|} + \frac{1}{|z-y|}\right| \\
        &= \frac{||z-y| - |x-y|}{|x-y||z-y|} \left| \frac{1}{|x-y|} + \frac{1}{|z-y|} \right| \\
        &\le |z-x|^\alpha \frac{\max(|z-y|, |x-y|)^{1-\alpha}}{|x-y| |z-y|} \left(\frac{1}{|x-y|} + \frac{1}{|z-y|}\right) \\
        &\le C |z-x|^\alpha \left(\frac{1}{|x-y|^{2 + \alpha}} + \frac{1}{|z-y|^{2 + \alpha}}\right)
      \end{align*}
    \end{enumerate}
    By the symmetrie \(x \leftrightarrow z\):
    \begin{align*}
      LHS &\le C|z-x|^\alpha \left(\frac{1}{|x-y|^{1 + \alpha}} + \frac{1}{|z-y|^{1+\alpha}}\right) + \frac{|x-y|}{|x-y|^2} \\
      \Rightarrow LHS &\le C \dots + |x-z| \min\left(\frac{1}{|z-y|^2}, \frac{1}{|x-y|^2}\right) \\
      & \le (|x-y| + |z-y|)^{1-\alpha} \\
      & C |z-x|^\alpha \left(\frac{1}{|x-y|^{1+\alpha}} + \frac{1}{|z-y|^{1+\alpha}}\right)
    \end{align*}
    In summary:
    \begin{align*}
      |\partial_i u(x) - \partial_i u(z)| 
      &\le C \int_{\mathbb{R}^2} \left| \frac{x_i - y_i}{|x-y|^2} - \frac{z_i - y_i}{|z-y|^2}\right||f(y)| \, dy \\
      &= C |x-y|^\alpha \int_{\mathbb{R}^2} \left(\frac{1}{|x-y|^{1+\alpha}} + \frac{1}{|z-y|^{1+\alpha}}\right) |f(y)| \, dy
    \end{align*}
    Consider if \(|x| > 2 R_1\):
    \begin{align*}
      \int_{\mathbb{R}^2} \frac{1}{|x-y|^{1+\alpha}} |f(y)| \, dy 
      &\le \int_{\mathbb{R}^2} \frac{1}{R_1^{1+\alpha}} |f(y)| \, dy \le C
    \end{align*}
    \(\supp f \subseteq B(0, R_1)\). If \(|x| < 2 R_1\), then \(|x-y| \le 3R\) if \(y \in B(0, R_1)\). Hence:
    \begin{align*}
      &\int_{|x-y| \le 3 R_1} \frac{1}{|x-y|^{1+\alpha}} |f(y)| \, dy \\
      &\quad \le \left(\int_{|x-y| \le 3 R_1} \frac{1}{|x-y|^{(1+\alpha)p'}}\right)^{\frac{1}{p'}} \left(\int |f(y)|^p \, dy\right)^{\frac{1}{p}} \\
      &\quad= \int_{|z| \le 3 R_1} \frac{1}{|z|^{(1+\alpha)p'}} \,dz < \infty
    \end{align*}
    So \(\alpha < 1 - \frac{2}{p}\).
  \end{proof}

  \begin{ex}[E 6.3]  
    Let \(f \in C_{loc}^{0,\alpha}\) and \(- \Delta u = f\) in \(D'(\Omega)\). Prove \(u \in C_{loc}^{2, \alpha}(\Omega)\).
  \end{ex}

  \begin{proof}[Solution]
    Take an open ball \(B \subseteq \bar B \subseteq \Omega\). We prove \(u \in C^{2, \alpha}(B)\). There is an open \(\Omega_B\) s.t. \(\bar B \subseteq \bar \Omega_B \subseteq \Omega\). Then there is a \(\chi_B \in C_c^\infty(\mathbb{R}^d)\) s.t. \(\chi_B(x) = 1\) if \(x \in B\) and \(\chi_B(x) = 0\) if \(x \notin \Omega_B\). Define
    \begin{align*}
      f_B(x) = \chi_B(x)f(x): \ \mathbb{R}^d \to \mathbb{R}
    \end{align*}
    We prove that \(f_B \in C^{0, \alpha}(\mathbb{R}^d)\). Since \(f \in C_{loc}^{0,\alpha}(\Omega)\) we have \(f \in C^{0,\alpha}(\Omega)\), so \(|f(x)-f(y)| \le C|x-y|^\alpha\) for all \(x,y \in \Omega_B\). Then:
    \begin{align*}
      |f_B(x) - f_B(y)| 
      &= |\chi_B(x) f(x) - \chi_B(y) f(y)| \\
      &\le |(\chi_B(x) - \chi_B(y))f(x) + \chi_B(y)(f(x)-f(y))| \\
      &\le C |x-y|^\alpha \|f\|_{L^\infty} + C\|\chi\|_{L^\infty(\Omega_B)}|x-y|^\alpha
      \le C_{\Omega_B}|x-y|^\alpha
    \end{align*}
    What about other cases? If \(x, y\) are bot not in \(\Omega_B\), then \(|f_B(x) - f_B(y)| =0\), then if \(x \in \Omega_B\) and \(y \notin \Omega_B\): \(|f_B(x) - f_B(y)| = |f_B(x)| = |\chi_B(x)||f(x)| = |\chi_B(x) - \chi_B(y)||f(x)| \le C |x-y|^\alpha\). Conclusion: \(|f_B(x) - f_B(y)| \le C|x-y|^\alpha\) for all \(x,y \in \mathbb{R}^d\), i.e. \(f_B \in C^{0,\alpha}(\mathbb{R}^d)\). Also \(f_B\) is compactly supported. By a theorem in the lecture: \(G \star f_B \in C^{2, \alpha}(\mathbb{R}^d)\). Finally: \(-\Delta u = f\) in \(D'(\Omega)\), \(-\Delta (G \star f_B) = f_B\) in \(D'(\mathbb{R}^d)\). So we conclude \(-\Delta u = f = f_B = - \Delta (G\star f_B) \) in \(D'(B)\). \(-\Delta(u - G \star f_B)= 0\) in \(D'(B)\), so \(u - G \star f_B \in C^\infty(B)\), so \(u \in C^{2,\alpha}(B)\).
  \end{proof}

  \begin{ex}[6.4]
    \(u, f \in L^2(\mathbb{R}^d)\), \(-\Delta u = f \) in \(D'(\mathbb{R}^d)\). Prove \(u \in W^{2,2}(\mathbb{R}^d)\), \(\|u\|_{W^{2,2}(\mathbb{R}^d)} \le C \left(\|u\|_{L^2} + \|f\|_{L^2}\right)\).
    \begin{align*}
      W^{2,2}(\mathbb{R}^d)
      &= \{g \in L^2(\mathbb{R}^d) \mid D^\alpha g \in L^2 \text{ for all } |\alpha| \le 2\} \\
      &= \{g \in L^2(\mathbb{R}^d) \mid \widehat{D^\alpha g}(k) = (-2 \phi ik)^\alpha \hat g(k) \in L^2(\mathbb{R}^d) \text{ for all } |\alpha| \le 2\} \\
      &= \{g \in L^2(\mathbb{R}^d) \mid (1 + |k|^2) \hat g (k) \in L^2(\mathbb{R}^d)\}
    \end{align*}
    \(\|u\|_{W^{2,2}(\mathbb{R}^d)}\) is comparable \(\int_{\mathbb{R}^d} (1 + |k|^2)^2 |\hat g(k)|^2 \, dk\). If \(D^\alpha g \in L^2\), then \(\widehat{D^\alpha g}(k) = (-2 \pi i k)^\alpha \hat g(k)\). For any \(\phi \in C_c^\infty(\mathbb{R}^d)\): 
    \begin{align*}
      \int \widehat{D^\alpha g} (k) \hat \phi (k) , dk
      &= \int (D^\alpha g) \phi = (-1)^{|\alpha|} \int g (D^\alpha \phi) \\
      &= (-1)^{|\alpha|} \int \overline{\widehat{g}}(k) \widehat{D^\alpha} \phi(k) \\
      &= (-1)^{|\alpha|} \int \overline{\widehat{g}}(k)(-2 \pi i k)^\alpha \hat \phi(k) \, dk
    \end{align*}
  \end{ex}
  so \(\hat D^\alpha g(k) = (-1)^{|k|} \hat g (k) \overline{(-2 \pi i k x)^\alpha} = \hat g(k)(-2 \pi ik)^\alpha\). This implies:
  \begin{align*}
    \|u\|_{W^{2,2}(\mathbb{R}^d)} 
    &\le C \int_{\mathbb{R}^d} (1 + |k|^2)^2 |\hat u(k)|^2 \, dk \\
    &= C \left(\|u\|_{L^2}^2  + \int_{\mathbb{R}^d} |k|^4 |\hat u(k)|^2 \, dk\right) \\
    &\le C \left(\|u\|_{L^2}^2 + \|f\|_{L^2}^2\right) \\
    &\le C(\| u\|_{L^2} + \|f||_{L^2})^2
  \end{align*}

  \begin{rem}[Bonus 6]
    Let \(f,g \in W^{1,2}(\mathbb{R}^d)\). Prove that \(fg \in W^{1,1}(\mathbb{R}^d)\) and 
    \[\partial_i (fg) = (\partial_i f) g + f(\partial_i g) \quad \text{ in } D'(\mathbb{R}^d)\]
  \end{rem}


  \chapter{Existence for Poisson's Equation on Domains}

  Let \(\Omega \subseteq \mathbb{R}^d\) be open. Consider Poisson's equation.
  \[\begin{cases}
    - \Delta u = f & \text{in } \Omega \\ u = g & \text{on } \partial \Omega
  \end{cases}\]
  for given data \((f, g)\) and \(u\) the unknown function.
  \begin{itemize}
    \item Classical solutions: \(f \in C^2(\bar \Omega) \leadsto\) explicit representation formula.
    \item Weak solution: \(f \in L^p( \Omega)\), \(g \in L^p(\partial \Omega)\) \(\leadsto\) \(u \in W^{2,p}(\Omega)\). We are going to establish the existence by \emph{Energy Methods}. (Calculus of variations)
  \end{itemize}

  \begin{defn}[\(C^1\)-Domains]
    Let \(\Omega \subseteq \mathbb{R}^d\) be open. We say that \(\Omega\) is of class \(C^1\) (i.e. \(\partial \Omega \in C^1\)) if for all \(x_0 \in \partial \Omega\) there is a bijective function \(h: U \to Q\), where \begin{itemize}
      \item \(x_0 \in U\) open in \(\mathbb{R}^d\)
      \item \(Q = \{x = (x_1, \dots, x_d) = (x', x_d)\} \in \mathbb{R}^{d-1} \times \mathbb{R} \mid |x'| < 1, |x_d| < 1 \}\)
      \item \(h \in C^1(\bar U)\) and \(h^{-1} \in C^1(\bar Q)\) (\(C^1\)-diffeomorphism)
      \item \(h(U) = Q\)
      \begin{align*}
        h(U \cap \Omega) &= Q_+ = Q \cap \mathbb{R}_+^d = \{x = (x', x_d) \in Q \mid x_d > 0\} \\
        h(U \cap \partial \Omega) &= Q_0 = Q \cap \partial \mathbb{R}_+^d = \{x = (x', x_d) \in Q \mid x_d = 0\} \\
        h(U \setminus \bar \Omega) &= Q_- = Q \cap \mathbb{R}_-^d = \{x = (x', x_d) \in Q \mid x_d < 1\}
      \end{align*}
      (From Brezis' book)
    \end{itemize}
  \end{defn}
  
  \begin{rem}
    The set \(Q\) can be replaced by a ball, i.e. \(\Omega\) is of \(C^1\) if for all \(x_0 \in \partial \Omega\) there is a function \(U \to B(0,1) \subseteq \mathbb{R}^d\).
    \begin{itemize}
      \item \(x_0 \in U\) with \(U \subseteq \mathbb{R}^d\) open.
      \item \(h \in C^1(\bar U), h^{-1} \in C^1(\overline{B(0,1)})\)
      \item \(h(U \cap \Omega) = B(0,1) \cap \mathbb{R}_+^d\), \(h(U \cap \partial \Omega) = B(0,1) \cap \mathbb{R}^d\).
    \end{itemize}
  \end{rem}

  \begin{rem}[An equivalent definition form Evan's book App. C]
    Let \(\Omega \subseteq \mathbb{R}^d\) be open. Then \(\Omega\) is \(C^1\) if for all \(x_0 \in \partial \Omega\) there is a \(r > 0\) and a \(C^1\)-function \(\gamma: \mathbb{R}^{d-1} \to \mathbb{R}\) s.t. (upon relabeling and reorienting the axes if necessary) such that:
    \begin{align*}
      \Omega \cap B(x_0, r) &= \{x = (x', x_d) \in B(x_0, r) \mid x_d < \gamma(x_0)\}
    \end{align*}
  \end{rem}

  \begin{proof}[Proof of the equivalence of the two definitions]\
    \begin{itemize}
      \item [Def. 2 \(\Rightarrow\) Def. 1:] In fact, given \(x_0 \in \partial \Omega\) and \(\gamma\) we can define
      \begin{align*}
        h(x', x_d) &= (x', x_d - \gamma(x')) \in C^1(\mathbb{R}^d, \mathbb{R}^d) \\
        h^{-1}(x', x_d) &= (x', x_d + \gamma(x')) \in C^1(\mathbb{R}^d, \mathbb{R}^d)
      \end{align*}
      \item [Def. 1 \(\Rightarrow\) Def. 2:] We need the inverse function theorem and the implicit function theorem. Let \(x_0 \in \partial \Omega\), let \(h: U \to B(0,1)\) as in Def. 1. Denote \(h = (h_1, h_2, \dots, h_d)\). Since \(h\) is invertible near \(x_0\), by the inverse function theorem we have for the Jacobi matrix \(J h(x_0) = (\partial_j h_i(x_0))_{1 \le i,j \le d}\) is invertible. So we have \(\nabla h_d(x_0) = (\partial_j h_d(x_0))_{1 \le j \le d} \ne \vec{0}^{\mathbb{R}^d}\), so there is a \(j \in \{1, 2, \dots, d\}\) s.t. \(\partial_j h_d(x_0) \ne 0\). By relabeling and reorienting the axes, we can assume that \(\partial_d h_d(x_0) > 0\). By continuity there is a \(r > 0\) such that \(\partial_d h_d(x) > 0\) for all \(x \in B(x_0, r)\). Define \(\gamma: \mathbb{R}^{d-1} \to \mathbb{R}\) s.t. in \(B(x_0, r)\):
      \begin{equation*}
        x = (x', x_d) \in \partial \Omega
        \Longleftrightarrow h_d(x', x_d) = 0
        \Longleftrightarrow x_d = \gamma(x'),
      \end{equation*}
      \(h_d: \mathbb{R}^d \to \mathbb{R}\). This gives a solution \(\gamma\) if \(\partial_d h_d > 0\) in \(B(x_0, r)\). (For implicit function theorem, \(\partial_d h_d(x_0) \ne 0\))
      Question: Why in \(B(x_0,r)\)?
      \begin{align*}
        x = (x', x_d) \in \Omega
        \Longleftrightarrow x_d > \gamma(x')
      \end{align*}
      Since \(\partial_d h_d(x) > 0\) for all \(x \in B(x_0, r)\) we have that \(x_d \mapsto h_d(x', x_d)\) is strictly increasing, hence 
      \begin{align*}
        &x = (x', x_d) \in \Omega \\
        \Longleftrightarrow \quad&h(x', x_d) \in \mathbb{R}_+^d \\
        \Longleftrightarrow \quad&h_d(x', x_d) > 0 = h_d(x', \gamma(x')) \\
        \Longleftrightarrow \quad& x_d > \gamma(x') \qedhere
      \end{align*}
    \end{itemize}
  \end{proof}
  
  \begin{thm}[Gauss-Green formula / Integration by parts]
    Let \(\Omega \subseteq \mathbb{R}^d\) be open and bounded. Then
    \begin{enumerate}
      \item For all \(u, v \in C^1(\bar \Omega)\):
      \begin{align*}
        \int_\Omega (\partial_i u) v &= - \int_\Omega u(\partial_i v) + \int_{\partial \Omega} uv n_i \, dS,
      \end{align*}
      where \(\vec{n} = (n_i)_{i=1}^d\) is the outwarded unit normal vector.
    \item For all \(u,v \in C^2(\bar \Omega)\):
    \begin{align*}
      \int_\Omega u(-\Delta v) &= \int_\Omega \nabla u \nabla v - \int_{\partial \Omega} u \frac{\partial v}{\partial \vec{n}} \, dS
    \end{align*}
    where \(\frac{\partial v}{\partial \vec{n}} = \nabla v \vec{n} = \sum_{i=1}^d \partial_i v n_i\). 
  \end{enumerate}
  \end{thm}

  Classical solutions via Green's function:
  \begin{align*}
    \begin{cases}
      - \Delta u = f & \text{in } \Omega \\ u = g & \text{on } \partial \Omega
    \end{cases}
  \end{align*}
  Let \(\Omega \subseteq \mathbb{R}^d\) be open, bounded, \(\partial \Omega \in C^1\). Assume there exists a \(u \in C^2(\bar \Omega)\), \(f \in C(\bar \Omega)\), \(g \in C(\partial \Omega)\). Let \(G\) be the fundamential solution of the Laplace Equation in \(\mathbb{R}^d\). We use integration by parts in \(\Omega \setminus B(x, \epsilon)\):
  \begin{align*}
    &\int_{\Omega \setminus B(x, \epsilon)} u(y)(-\Delta G)(y-x) \, dy \\
    &\quad= \int_{\Omega \setminus B(x, \epsilon)} \nabla u(y) \nabla G(y-x) \, dy - \int_{\partial \Omega \cup \partial B(x, \epsilon)} u(y) \frac{\partial G}{\partial \vec{n}} (y-x) \, dS(y) \\
    &\int_{\Omega \setminus B(x, \epsilon)} G(y-x)(-\Delta u)(y) \, dy \\
    &\quad= \int_{\Omega \setminus B(x,\epsilon)} \nabla G(y-x)\nabla u(y) \, dy - \int_{\partial \Omega \cup \partial B(x,\epsilon)}G(y-x) \frac{\partial u}{\partial \vec{n}}(y) \, dS(y)
  \end{align*}
  This implies:
  \begin{align*}
    &\int_{\Omega \setminus B(x,\epsilon)} \left[u(y) (-\Delta G(y-x))-G(y-x)(-\Delta u)(y)\right] \, dy  \\
    &\quad= - \int_{\partial \Omega \cup \partial B(x, \epsilon)} \left[u(y) \frac{\partial G}{\partial \vec{n}}(y-x) - G(y,x) \frac{\partial u}{\partial \vec{n}}(y)\right] \, dS(y)
  \end{align*}
  for all \(x \in \Omega, x \in B(x, \epsilon) \subseteq \Omega\). When \(\epsilon \to 0\), then the left hand side converges to \(- \int_\Omega G(y-x) f(y) \, dy\) and the right hand side (for \(d \ge 2\)) we have \(\partial_j G(y) = \frac{-y_j}{d|B_1||y|^d}\), so
  \begin{align*}
    \frac{\partial G}{\partial \vec{n}}
    = \nabla G \vec{n} 
    = \nabla G(y) \left(\frac{-y}{|y|}\right)
    = \sum_{j=1}^d \frac{-y_i}{d|B_1||y|^d} \frac{-y_j}{|y|}
    = \frac{1}{d|B_1||y|^{d-1}} \text{ on} \partial B(0, \epsilon)
  \end{align*}
  so we have 
  \begin{align*}
    \frac{\partial G}{\partial \vec{n}}(y-x) = \frac{1}{d|B_1| \epsilon^{d-1}}
  \end{align*}
  on \(\partial B(x, \epsilon)\). Hence
  \begin{align*}
    \int_{\partial B(x, \epsilon)} u(y) \frac{\partial G}{\partial \vec{n}}(y-x) \, dS(y) 
    &= \frac{1}{d|B_1| \epsilon^{d-1}} \int_{\partial B(x, \epsilon)} u(y) \, dS(y) \\
    &= \fint_{\partial B(x,\epsilon)} u(y) \, dS(y)
    \xrightarrow{\epsilon \to 0} u(x) 
  \end{align*}
  On the other hand:
  \begin{align*}
    \left|\int_{\partial B(x, \epsilon)} G(y-x) \frac{\partial u(y)}{\partial \vec{n}} \, dS(y)\right|
    &\le C \epsilon^{d-1} \sup_{|z| = \epsilon} |G(z)| \xrightarrow{\epsilon \to 0} 0
  \end{align*}
  since \(|G(z)|\le \frac{C}{|z|^{d-2}}\) if \(d \ge 3\), \(|G(z)|\le C |\log(z)| \) if \(d = 2\) and \(|G(z)|\le C|z|\) if \(d = 1\). In summary: 
  \begin{align*}
    - \int_\Omega G(y-x) f(y) \, dy 
    = - \int_{\partial \Omega} \left[u(y) \frac{\partial G}{\partial \vec{n}} (y-x) - G(y-x) \frac{\partial u}{\partial \vec{n}}(y)\right] \, dS(y) - u(x) \\
    \Leftrightarrow u(x) = \int_\Omega G(y-x) f(y) \, dy + \int_{\partial \Omega} \left[G(y-x) \frac{\partial u}{\partial \vec{n}}(y) - g(y) \frac{\partial G}{\partial \vec{n}}(y-x)\right] \, dS(y)
  \end{align*}
  Problem: We don't know anything about \(\frac{\partial u}{\partial \vec{n}}\) on \(\partial \Omega\). Trick: We can resolve that by using the \emph{corrector} function: \(\Phi_x = \Phi_x(y)\) which solves:
  \[\begin{cases}
    - \Delta \Phi_x = 0 & \text{in } \Omega \\ \Phi_x(y) = G(y-x) &\text{on } \partial \Omega
  \end{cases}\]
  We assume that \(\Phi_x\) exists. 

  \begin{defn}[Green's function]
    \(\tilde G(x-y) = G(y-x) - \Phi_x(y)\) for all \(x,y \in \Omega\), \(x \ne y\).
  \end{defn}
  

  \begin{ex}[E 7.1]
    Let \(\Omega \subseteq \mathbb{R}^d\) be open and bounded with \(C^1\) boundary. For \(x \in \Omega\), assume there exist \(\Phi_x(y)\), \(y \in \bar \Omega\), s.t. 
    \begin{align*}
      \begin{cases}
        \Delta_y \Phi_x(y) = 0 \\ \Phi_x(y) = G(y-x)
      \end{cases},
    \end{align*}
    \(G(z) = \frac{1}{d(d-2)|B_1||z|^{d-2}}, d \ge 3\). Prove that \(\Phi_x(y) = \Phi_y(x)\) for all \(x,y \in \Omega\). Then \(\tilde G(x,y) = G(y-x) - \Phi_x(y)\) is symmetric, i.e. \(\tilde G(x,y) = \tilde G(y,x)\).
  \end{ex}

  \begin{proof}[Solution]
    Assume \(x \ne y\). Define \begin{align*}
      f(z) &= \tilde G(x,z) = G(z-x) - \Phi_x(z) \\
      g(z) &= \tilde G(y,z) = G(z-y) - \Phi_y(z)
    \end{align*}
    Integration by parts:
    \begin{align*}
      \int_{\Omega \setminus (B(x, \epsilon) \cup B(y, \epsilon))} (f \Delta g - g \Delta f) 
      &= \int_{\partial \Omega \cup \partial B(x,\epsilon) \cup \partial B(y, \epsilon)} \left(f \frac{\partial g}{\partial \vec{n_z}} - g \frac{\partial f}{\partial \vec{n_z}}\right) \, dS(z) \\
      &= \int_{\partial B(x, \epsilon) \cup \partial B(y, \epsilon)} \left(f \frac{\partial g}{\partial \vec{n_z}} - g \frac{\partial f}{\partial \vec{n_z}}\right)\, dS(z)
    \end{align*}
    Consider \(f \frac{\partial g}{\partial \vec{n_z}}\) on \(\partial B(x,\epsilon)\). Since \(g\) is only singular at \(y\), so \(\left|\frac{\partial g}{\partial \vec{n}}\right| \le C\) on \(\partial B(x,\epsilon)\). This implies:
    \begin{align*}
      \int_{\partial B(x,\epsilon)} \left|f \frac{\partial g}{\partial \vec{n_z}}\right| \, dS(z) 
      &\le C \int_{\partial B(x,\epsilon)}|f| \, dS(z) \\
      &\le C \int_{\partial B(x,\epsilon)} \left(\frac{1}{|x-z|^{d-2}} + \|\Phi_x\|_{L^\infty(\Omega)}\right) \, dS(z) \\
      &\le C \epsilon^{d-1} \left(\frac{1}{\epsilon^{d-2}} + 1\right)
      \le C\epsilon \xrightarrow{\epsilon \to 0} 0
    \end{align*}
    Consider \(f \frac{\partial g}{\partial \vec{n_z}}\) on \(\partial B(y, \epsilon)\). Decompose \(\frac{\partial g}{\partial \vec{n}} = \left[\nabla_z G(z-y) - \nabla_z \Phi_y(z)\right]\frac{(z-y)}{|z-y|}\). Since \(\Phi_y(z)\) is harmonic in \(\Omega\), we have that 
    \begin{align*}
      \int_{\partial B(y,\epsilon)} \left| f \nabla_z \Phi_y(z) \frac{-(z-y)}{|z-y|} \right|
      \le C \int_{\partial B(y,\epsilon)}|f|
      \le C \epsilon^{d-1} \xrightarrow{\epsilon \to 0}0
    \end{align*}
    Thus the main contribution from \(f \frac{\partial g}{\partial \vec{n}}\) is 
    \begin{align*}
      &\int_{\partial B(y, \epsilon)} f(z) \nabla_z G(z-y) \frac{-(z-y)}{|z-y|} \, dS(z) \\
      &\quad= \int_{\partial B(y, \epsilon)} f(z) \frac{-(z-y)}{d |B_1||z-y|^d} \frac{-(z-y)}{|z-y|} \, dS(z) \\
      &\quad = \frac{1}{d|B_1|\epsilon^{d-1}} \int_{\partial B(y,\epsilon)} f(z) \, dS(z) \\
      &\quad= \fint_{\partial B(y,\epsilon)} f(z) \, dS(z) = f(y)
    \end{align*}
    In summary:
    \begin{align*}
      \int_{\partial B(x, \epsilon) \cup \partial B(y,\epsilon)} f \frac{\partial g}{\partial \vec{n_z}} \, dS(z) \xrightarrow{\epsilon \to 0} f(y)
    \end{align*}
    Similary:
    \begin{align*}
      \int_{\partial B(x,\epsilon) \cup \partial B(y, \epsilon)} g \frac{\partial f}{\partial \vec{n_z}} \, dS(z) \xrightarrow{\epsilon \to 0} g(x)
    \end{align*}
    So we have that \(f(y) = g(x)\), so \begin{align*}
      f(y) &= G(y-x) - \Phi_x(y) \\
      g(x) &= G(x-y) - \Phi_y(x).
    \end{align*}
    So \(\Phi_x(y) = \Phi_y(x)\) for all \(x \ne y \in \Omega\). This implies \(\Phi_x(y) = \Phi_y(x)\) for all \(x,y \in \Omega\).
  \end{proof}
  
  
  \begin{thm}
    Let \(\Omega \subseteq \mathbb{R}^d\) be open, bounded and \(C^1\). If \(u \in C^2(\Omega)\) solves 
    \begin{align*}
      \begin{cases}
        - \Delta u = f & \text{in } \Omega \\
        u = g & \text{on } \partial \Omega
      \end{cases},
    \end{align*}
    then 
    \begin{align*}
      u(x)
      &= - \int_{\partial \Omega} g(y) \frac{\partial \tilde G}{\partial \vec{n_y}}(x,y) \, dS(y) + \int_{\Omega} \tilde G(x,y) \, dy    \end{align*}
  \end{thm}

  \begin{proof}
    We need to prove: 
    \begin{align*}
      \int_\Omega \Phi_x(y) f(y) \, dy + \int_{\partial \Omega} \left(-g(y) \frac{\partial \Phi_x(y)}{\partial \vec{n}_y} + G(y-x) \frac{\partial u}{\partial \vec{n}}(y)\right) = 0
    \end{align*}
    By integration by parts:
    \begin{align*}
      \int_\Omega \Phi_x(y) f(y) \, dy 
      &= \int_\Omega \Phi_x(y) (-\Delta u(y)) \, dy  \\
      &= \int_\Omega \left[\Phi_x(y) (-\Delta u(y)) + (\Delta \Phi_x(y)) u(y)\right] \, dy \\
      (\Delta \Phi_x(y) = 0) \quad &= \int_{\partial \Omega} \left(-\Phi_x(y) \frac{\partial u}{\partial \vec{n}} + \frac{\partial \Phi_x(y)}{\partial \vec{n}} \smash{\underbrace{u(y)}_{g(y)}}\right) \, dS(y) \qedhere
    \end{align*}
  \end{proof}
  How can we compute \(\Phi_x(y)\)? It is not easy for general domains. But let us prove on two cases:
  \begin{itemize}
    \item \(\Omega = \mathbb{R}_+^d\) (half-space)
    \item \(\Omega = B(0,r)\) (a ball)
  \end{itemize}
  \section{Green's function on the upper half plane}
  We use the following notation:
  \begin{align*}
    \mathbb{R}_+^d &= \{x = (x_1, x_2, \dots, x_d) = (x', x_d) \in \mathbb{R}^{d-1} \times \mathbb{R} \mid x_d > 0\} \\
    \partial \mathbb{R}_+^d &= \{x = (x', x_d) \mid x_d = 0\} = \mathbb{R}^{d-1} \times \{0\}
  \end{align*}
  For all \(x \in \mathbb{R}^d\) we want to find the correction function \(\Phi_x(y)\) with \(y \in \overline{\mathbb{R}_{+}^d}\) s.t.
  \begin{align*}
    \begin{cases}
      + \Delta_y \Phi_x(y) = 0 & \text{in } \mathbb{R}_+^d \\ \Phi_x(y) = G(y-x) & \text{in } \partial \mathbb{R}_+^d
    \end{cases}
  \end{align*}

  
  \begin{defn}[Reflection for \(\mathbb{R}_+^d\)] 
    For all \(x = (x', x_d) \in \mathbb{R}^d\), \(\tilde x = (x', -x_d) \in \mathbb{R}^d\), (if \(x \in \mathbb{R}_+^d \Rightarrow \tilde x \mathbb{R}_-^d\)) 
  \end{defn}
    
  Claim: \(\Delta_y \Phi_x(y) = G(y - \tilde x)\) is a corrector function.
  \begin{itemize}
    \item \(\Delta_y \Phi_x(y) = \Delta_y G(y-\tilde x) = 0\) for all \(y \in \mathbb{R}_+^d\) for all \(x \in \mathbb{R}_+^d\) (as \(\tilde x \in \mathbb{R}_-^d = \mathbb{R}^d \setminus \overline{\mathbb{R}_+^d}\))
    \item \(\Phi_x(y) = G(y-\tilde x) = G(y-x)\) on \(y \in \partial \mathbb{R}_+^d\). In fact, \(y \in \partial \mathbb{R}_+^d\), so \(y_d = 0\), so 
    \begin{align*}
      G(y - \tilde x) = G_0(|y-\tilde x|) = G_0\left(\sqrt{\sum_{i=1}^{d-1} |x_i - y_i|^2 +|x_d|^2}\right) = G_0(|y-x|)
    \end{align*}
  \end{itemize}
  Consider \(f = 0\) and 
  \begin{align*}
    \begin{cases}
      - \Delta = 0 &\text{in } \mathbb{R}_+^d \\ u = g & \text{on } \partial \mathbb{R}_+^d
    \end{cases}
  \end{align*}
  Then we expect \[u(x) = - \int_{\partial \Omega} g(y) \frac{\partial \tilde G}{\partial \vec{n_y}}(x,y) \, dS(y)\]
  We compute
  \begin{align*}
    \frac{\partial \tilde G}{\partial \vec{n_y}}(x-y) = \sum_{j=1}^d \frac{\partial \tilde G}{\partial y_j}(x,y) \vec{n_j} = - \frac{\partial \tilde G}{\partial y_d}(x,y) = \frac{\partial }{\partial y_d}(G(y-\tilde x) - G(y-x)) = \dots
  \end{align*}
  because \(\tilde G(x,y) = G(y-x) - \Phi_x(y) = G(y-x) - G(y-\tilde x)\). 
  \begin{align*}
    \dots &= \frac{1}{d |B_1|} \left[\frac{-(y_d - \tilde x_d)}{|y-\tilde x|^d} - \frac{-(y_d-x_d)}{|y-x|^d}\right] \\
    (y \in \partial \mathbb{R}_+^d) &\quad= \frac{1}{d|B_1|} \left[\frac{\tilde x_d}{|y-x|} - \frac{x_d}{|y-x|^d}\right]
    = \frac{- 2 x_d}{d |B_1| |y-x|^d}
  \end{align*}
  We expect
  \begin{align*}
    u(x) = - \int_{\partial \mathbb{R}_+^d} g(y) \frac{\partial \tilde G}{\partial \vec{n_y}} (x,y) \, dS(y) = \int_{\partial \mathbb{R}_+^d} g(y) \frac{2x_d}{d |B_1| |y-x|^d} \, dS(y)
  \end{align*}
  
  \begin{thm}
    Assume \(g \in C(\mathbb{R}^{d-1}) \cap L^\infty(\mathbb{R}^{d-1})\) Then 
    \begin{align*}
      u(x) &= \int_{\partial \mathbb{R}_+^d} g(y) K(x,y) \, dS(y)
    \end{align*}
    and 
    \begin{align*}
      K(x,y) &= \frac{2 x_d}{d|B_1||y-x|^d} \quad \text{for all \(x \in \mathbb{R}_+^d\).}
    \end{align*}
    satisfies that \(u \in C^\infty(\mathbb{R}_+^d) \cap L^\infty(\mathbb{R}_+^d)\) and 
    \begin{align*}
      \begin{cases}
        \Delta u = 0 & \text{in } \mathbb{R}_+^d \\ \lim_{\substack{x \to 0 \\ x \in \mathbb{R}_+^d}} u(x) = g(x_0) & \forall x_0 \in \partial \mathbb{R}_+^d
      \end{cases}
    \end{align*}
  \end{thm}
  
  \begin{proof}
    Claim: For all \(y \in \partial \mathbb{R}_+^d\), \(x \mapsto K(x,y)\) is harmonic in \(\mathbb{R}_+^d\) (i.e. \(\Delta_x K(x,y) = 0\) in \(\mathbb{R}_+^d\))
    \begin{itemize}
      \item Argument from Evans: \begin{align*}
        K(x,y) = - \frac{\partial}{\partial y_d}, \ \tilde G(y-x) = - \frac{\partial}{\partial y_d}(G(y-x)-G(y-\tilde x))
      \end{align*}
      We know that for all \(x \in \mathbb{R}_+^d\), \(y \mapsto \tilde G(y,x)\) is haromnic in \(\mathbb{R}_+^d \setminus \{x\}\). By symmetry we have \(\tilde G(y,x) = \tilde G(x,y)\) for all \(x,y \in \mathbb{R}^d_+\). So for all \(y \in \mathbb{R}_+^d\), \(x \mapsto \tilde G(y,x)\) is harmonic in \(\mathbb{R}_+^d \setminus \{y\}\). Then for all \(y \in \mathbb{R}_+^d:\) \(- \frac{\partial}{\partial y_d} \tilde G(y,x)= K(x,y)\) is harmonic \(x \in \mathbb{R}_+^d \setminus \{y\}\). By a limit argument, for all \(y \in \partial \mathbb{R}_+^d\), \(x \mapsto K(x,y)\) is harmonic for all \(x \in \mathbb{R}_+^d\).
      \item  A direct proof:
      \begin{align*}
        K(x,y) = \frac{2 x_d}{d |B_1|} \frac{1}{|x-y|^d}
      \end{align*}
      for all \(x \in \mathbb{R}_+^d\), \(y \in \partial \mathbb{R}_+^d\). For \(i \ne d\), \(x=(x_1, \dots, x_d)\), 
      \begin{align*}
        \partial_{x_i} K(x,y) &= \frac{2 x_d}{d |B_1|} \frac{(-d)}{|x-y|^{d+1}}\frac{x_i-y_i}{|x-y|} = \frac{-2x_d}{|B_1|}\frac{x_i - y_i}{|x-y|^{d+2}} \\
        \partial_{x_i}^2 K(x,y) &= - \frac{2 x_d}{|B_1|} \left[\frac{1}{|x-y|^{d+1}} - \frac{(d+2)}{|x-y|^{d+3}}(x_i-y_i) \frac{(x_i-y_i)}{|x-y|}\right] \\
        &= - \frac{2 x_d}{|B_1|} \left[\frac{1}{|x-y|^{d+1}} - \frac{(d+2)}{|x-y|^{d+4}}(x_i-y_i)^2\right]
      \end{align*}
      Moreover:
      \begin{align*}
        \partial_{x_d} K(x,y) 
        &= \frac{2}{d|B_1|} \frac{1}{|x-y|^d} + \frac{2 x_d}{d|B_1|}(-d) \frac{(x_d-y_d)}{|x-y|^{d+2}} \\
        (y_d = 0) \quad &= \frac{2}{d|B_1|} \frac{1}{|x-y|^d} + \frac{2x_d^2}{|B_1||x-y|^{d+2}} \\
        \partial_{x_d}^2K(x,y) &= \frac{-2}{|B_1|} \frac{(x_d-y_d)}{|x-y|^{d+2}} + \frac{4 x_d}{|B_1||x-y|^{d+2}} - \frac{2(d+2){|B_1|}} x_d^2 \frac{(x_d - y_d)}{|x-y|^{d+4}}
      \end{align*}
      Then: \begin{align*}
        \Delta_x K(x,y) 
        &= \sum_{i=1}^{d-1} \partial_{x_i}^2 K(x,y) + \partial_{x_i}^2 K(x,y) \\
        &= - \frac{2 x_d}{|B_1|} \left[\frac{d-1}{|x-y|^{d+2}} - (d+2) \sum_{i=1}^{d-1} \frac{(x_i - y_i)^2}{|x-y|^{d+4}} \right. \\
        &\quad + \left. \frac{1+2}{|x-y|^{d+2}} - \frac{(d+2)x_d(x_d-y_d)}{|x-y|^{d+4}}\right] \\
        &= - \frac{2 x_d}{|B_1|} \left[\frac{d+2}{|x-y|^{d+2}} - (d+2) \frac{1}{|x-y|^{d+4}} \left(\underbrace{\sum_{i=1}^d |x_i - y_i|^2}_{\smash{|x-y|^2}}\right)\right] = 0
      \end{align*}
      for all \(x \in \mathbb{R}_+^d\), \(y \in \partial \mathbb{R}_+^d\).
      Claim (exercise) for all \(x \in \mathbb{R}_+^d\), 
      \begin{align*}
        \int_{\partial \mathbb{R}_+^d} K(x,y) \, dy = 1 
      \end{align*}
      Consider 
      \begin{align*}
        u(x) = \int_{\partial \mathbb{R}_+^d} K(x,y) g(y) \, dy, \quad x \in \mathbb{R}_+^d
      \end{align*}
      Since \(g \in L^\infty(\mathbb{R}^{d-1}) = L^\infty(\partial \mathbb{R}_+^d)\) and \(K(x,y) \ge 0\), hence 
      \begin{align*}
        |u(x)| \le \left(\int_{\partial \mathbb{R}_+^d} K(x,y) \, dy\right) \|g\|_{L^\infty}
      \end{align*}
      Thus \(\|u\|_{L^\infty} \le \|g\|_{L^\infty}\). Moreover 
      \begin{align*}
        D_x^\alpha u(x) &= \int_{\partial \mathbb{R}_+^d} D_x^\alpha K(x,y) g(y) \, dy
      \end{align*}
      bounded, so \(u \in C^\infty(\mathbb{R}_+^d)\), \(x \mapsto K(x,y)\) is smooth as \(x \ne y\).
      \begin{align*}
        \Delta_x u(x) &= \int_{\partial \mathbb{R}_+^d} \underbrace{\Delta_x K(x,y)}_{= 0} g(y) \, dy = 0
      \end{align*}
      So \(u\) is harmonic in \(\mathbb{R}^d_+\). (\(\Rightarrow u \in C^\infty\) by Weyl's lemma). Take \(x_0 \in \partial \mathbb{R}_+^d\) and \(x \in \mathbb{R}_+^d\). Then:
      \begin{align*}
        |u(x)-g(x_0)| 
        &= \left| \int_{\partial \mathbb{R}_+^d} K(x,y)(g(y) - g(x_0)) \, dy \right| \\
        &\le \int_{\partial \mathbb{R}_+^d} K(x,y) |g(y)-g(x_0)| \, dy \\
        &= \underbrace{\int_{|y-x_0| \le L |x-x_0|}}_{(I)} + \underbrace{\int_{|y-x_0| > L|x-x_0|}}_{(II)}
      \end{align*}
      \begin{align*}
        (I) &= \int_{|y-x_0| \le L |x-x_0|} K(x,y) |g(y) - g(x_0)| \, dy \\
        &= \sup_{|y-x_0| \le L|x-x_0|} |g(y) - g(x_0)| \xrightarrow{x \to x_0} 0 \quad \forall L > 0
      \end{align*}
      \((II)\): If \(|y-x_0| > L|x-x_0|\), then \(|y-x| > \frac{1}{2} |y-x_0| > \frac{L}{2}|x-x_0|\) if \(L \ge 2\).
      \begin{align*}
        &\int_{|y-x_0| > |L|x-x_0|} K(x,y) |g(y) - g(x_0)| \, dy \le C \int_{y \in \partial \mathbb{R}_+^d} \frac{x_d}{|x_0-y|} \, dy \\
        &\quad C x_d \int_{\substack{z \in \mathbb{R}^{d-1}\\|z| > L|x-x_0|}} \frac{1}{|z|^d} \, dz = const. \frac{x_d}{L|x-x_0|} \le \frac{const.}{L} \xrightarrow{L \to \infty} 0
      \end{align*}
      \(x_d = |x_d - (x_0)_d| \le |x-x_0|\)
    \end{itemize}
  \end{proof}

  \section{Green's function for a ball}
  Let \(B = B(0,1)\). For all \(x \in B,\) for all \(y \in \bar B\) we want to find the corrector function \(\Phi_x(y)\) s.t.
  \[\begin{cases}
    \Delta_y \Phi_x(y) = 0 & \text{in } B \\
    \Phi_x(y) = G(y-x) & \text{on } \partial B
  \end{cases}\] 
  where for \(d \ge 3\): \(G(z) = \frac{1}{d(d-2)|B_1||z|^{d-2}}\).

  \begin{defn}[Reflection / Duality through the sphere \(\partial B\)]
    For all \(x \in \mathbb{R}^d \setminus \{0\}\) we define \(\tilde x = \frac{x}{|x|^2}\). Clearly we have for all \(x \in B\) that if \(|x| < 1\), then \(|\tilde x| = \left| \frac{x}{|x|^2}\right| = \frac{1}{|x|} > 1\), so \(\tilde x \notin \bar B\) 
    % and \((\tilde x)^\sim = \frac{\tild x}{|\tilde x|^2 = \frac{\frac{x}{|x|^2}}{\left| \frac{x}{|x|^2}}\right|} = \frac{\frac{x}{|x|^2}}{\left(\frac{1}{|x|}\right)^2} = x\)
  \end{defn}

  \begin{lem}
    For \(d \ge 3\) the function \(\Phi_x(y) = G(|x|(y-\tilde x))\) is a corrector function.
  \end{lem}

  \begin{proof}
    \begin{align*}
      \Phi_x(y) &= \frac{1}{d(d-2)|B_1| |x|^{d-2} |y-\tilde x|^{d-2}}
    \end{align*}
    for all \(x \in B, x \ne 0\), for all \(y \in \bar B\). Then clearly \(y \mapsto \Phi_x(y)\) is harmonic in \(B\) (Since \(\frac{1}{|z|^{d-2}}\) is harmonic in \(\mathbb{R} \setminus {0}\)). Let's check the boundary: Let \(y \in \partial B\), i.e. \(|y| = 1\). Then
    \begin{align*}
      ||x|(y-\tilde x)| 
      &= |x| \left|y- \frac{x}{|x|^2}\right|  \\
      &= |x| \sqrt{|y|^2 - 2 \frac{xy}{|x|^2} + \left| \frac{x}{|x|^2}\right|^2} \\
      &= \sqrt{|x|^2 |y|^2 - 2xy + 1} \\
      (|y| = 1) \quad &= \sqrt{|x|^2 - 2xy + |y|^2} 
      = |x-y|
    \end{align*}
    Thus \(\Phi_x(y) = G(|x| |y-\tilde x|) = G(y-x)\) for all \(0 \ne x \in B\), for all \(y \in \partial B\). Let's compute the Poisson kernel: If want to solve
    \[\begin{cases}
      - \Delta u = 0 & \text{in } B \\ u = g &\text{on } \partial B
    \end{cases}\]
    then \[u(x) = - \int_{\partial B} \frac{\partial \tilde G}{\partial \vec{n}_y}(x,y) g(y) dS(y).\]
    \(\tilde G(x,y) = G(y-x) - \Phi_x(y) = G(y-x)-G(|x|(y-\tilde x))\) for all \(x \in B \setminus \{0\}\), \(y \in \bar B\).
    \begin{align*}
      \frac{\partial \tilde G}{\partial \vec{n}_y} = \sum_{i=1}^d \partial_{y_i} \tilde G y_i
    \end{align*}
    Here \begin{align*}
      \partial_{y_i} \tilde G &= \partial_{y_i} G(y-x) - \partial_{y_i} [G(|x|(y-\tilde x))] \\
      &= \frac{- (y_i -x_i)}{d|B_1||y-x|^d} + \frac{y_i-\tilde x_i}{d|B_1||x|^{d-2}|y-\tilde x|^d} \\
      \Rightarrow \frac{\partial \tilde G}{\partial \vec{n}_y} &= \sum_{i=1}^d [\dots] y_i \\
      &= \frac{-y(y-x))}{d|B_1||y-x|^d} + \frac{y(y-\tilde x)}{d|B_1||x|^{d-2}|y-\tilde x|^d} \\
      &= \frac{1}{d|B_1||y-x|^d} (-y(y-x) + y(y-\tilde x) |x|^2) \\
      &= \frac{1}{d|B_1||y-x|^d}[-|y|^2 + xy + |y|^2 |x|^2 - xy] \\
      &= \frac{-1 + |x|^2}{d|B_1||y-x|^d}
    \end{align*}
    as \(y \in \partial B\).
  \end{proof}

  \begin{thm}[Poisson Formula for a Ball] Let \(B = B(0,1)\), \(g \in C(\partial B)\). Define for all \(x \in B\):
    \begin{align*}
      u(x) &= \int_{\partial B} K(x,y) g(y) \, dS(y),
    \end{align*}
    \(K(x,y) = - \frac{\partial \tilde G}{\partial \vec{n}_y}(x,y) = \frac{1-|x|^2}{d|B_1||y-x|^d}\) for all \(x \in B\), for all \(y \in \partial B\). Then \(u \in C^\infty(B)\), \(\Delta u = 0\) and for all \(x_0 \in \partial B\) we have \(\lim_{\substack{x \to x_0 \\ x \in B}} u(x) = g(x_0)\). This holds for all \(d \ge 2\).
  \end{thm}


  \begin{proof}
    We need to check: \begin{enumerate}
      \item For all \(y \in \partial B\), \(x \mapsto K(x,y)\) is harmonic in \(B\).
      \item \(\int_{\partial B} K(x,y) \, dS(y) = 1\) for all \(x \in B\) (exercise)
    \end{enumerate}
    Now for all \(x \in B\), for all \(y \in \partial B\):
    \begin{align*}
      K(x,y) &= \frac{1-|x|^2}{d|B_1||y-x|^d} \\
      \partial_{x_i} K(x,y) &= \frac{-2x_i}{d|B_1|} \frac{1}{|x-y|^d} - \frac{1-|x|^2}{|B_1|} \frac{x_i - y_i}{|x-y|^{d+2}} \\
      \partial_{x_i}^2 K(x,y) &= - \frac{2}{d|B_1|} \frac{1}{|x-y|^d} + \frac{2 x_i}{|B_1|} \frac{x_i - y_i}{|x-y|^{d+2}} + \frac{2 x_i}{|B_1|} \frac{x_i - y_i}{|x-y|^{d+2}} \\
      &\quad - \frac{1-|x|^2}{|B_1|} \frac{1}{|x-y|^{d+2}} + \frac{1+|x|^2}{|B_1|} (d+2) \frac{(x_i-y_i)^2}{|x-y|^{d+4}}\\
      \Delta_x K &= \sum_{i=1}^d \partial_{x_i}^2 K = - \frac{2}{|B_1|} \frac{1}{|x-y|^d} + \frac{4 x(x-y)}{|B_1||x-y|^{d+2}} \\
      &\quad - \frac{d(1-|x|^2)}{|B_1|} \frac{1}{|x-y|^{d+2}} + (d+2) \frac{1-|x|}{|B_1|} \frac{1}{|x-y|^{d+2}} \\
      &= \frac{2}{|B_1||x-y|^{d+2}} [-|x|^2 + 2xy - |y|^2 + 2|x|^2 - 2xy + 1 - |x|^2] \\
      &= \frac{2}{|B_1||x-y|^{d+2}} [-|x|^2 + 2xy - |y|^2 + 2|x|^2 - 2xy + 1 - |x|^2]
    \end{align*}
    \(1 - |y|^2 = 0\) as \(y \in \partial B\). Thus \(\Delta_x K(x,y) = 0\), for all \(x \in B\), for all \(y \in \partial B\).
    \begin{align*}
      |u(x)| &= \left| \int_{\partial B}K(x,y) g(y) \, dS(y) \right| \le \|g\|_{L^\infty(\partial B)}
    \end{align*}
    \(\int_{\partial B} K(x,y) , dS(y) = \|g\|_{L^\infty}\), 
    \begin{align*}
      \Delta_x u(x) &= \int_{\partial B} \underbrace{\Delta_x K(x,y)}_{= 0} g(y) \, dS(y) = 0
    \end{align*}
    Take \(x \in B\), \(x \to x_0 \in \partial B\).
    \begin{align*}
      |u(x) - g(x_0)| 
      &= \left| \int_{\partial B} K(x,y)(g(y) - g(x_0)) \, dS(y) \right| \\
      &\le \int_{A_1} + \int_{A_2} K(x,y) |g(y) - g(x_0)| \, dS(y),
    \end{align*}
    where
    \begin{align*}
      A_1 &= \{y \in \partial B \mid |y - x_0| \le |x-x_0|^\alpha\} \\
      A_2 &= \{y \in \partial B \mid |y-x_0| > |x-x_0|^2\}
    \end{align*}
    On \(A_1\) we have:
    \begin{align*}
      \int_{A_1} \dots \le \sup_{\substack{|z-x_0| \le |x-x_0|^\alpha \\ z \in \partial B}} \int_{\partial B} K(x,y) \, dS(y) \xrightarrow{x \to x_0} 0
    \end{align*}
    since \(G \in C(\partial B)\). On \(A_2\):
    \[
      |y-x_0| > |x-x_0|^\alpha
    \]
    \[
      \Rightarrow |y-x| \ge |y-x_0|-|x-x_0| \ge |x-x_0|^\alpha - |x-x_0| \ge \frac{1}{2} {x-x_0}^\alpha
    \]
    if \(\alpha < 1\) and \(|x-x_0|\) small. So we get 
    \begin{align*}
      K(x,y) &= \frac{1-|x|^2}{d|B_1||x-y|^d} \le C \frac{1-|x|^2}{|x-x_0|^{d\alpha}} \le C |x-x_0|^{1-d\alpha}
    \end{align*}
    Thus 
    \begin{align*}
      \int_{A_2} K(x,y) |g(y)-g(x_0)| \, dS(y) \le C \|g\|_{L^\infty} |x-x_0|^{1-d\alpha} \xrightarrow{x \to x_0} 0
    \end{align*}
    if \(1 - d\alpha > 0\) \(\Leftrightarrow\) \(\alpha < \frac{1}{d}\).
  \end{proof}

  \begin{ex}[E 7.2]
    Define \(\mathbb{R}_+^d = \{(x', x_d) \in \mathbb{R}^{d-1} \times \mathbb{R} \mid x_d > 0\}\). Let \(K(x,y) = \frac{2 x_d}{d |B_1| |x-y|^d}\) for all \(x \in \mathbb{R}_+^d, y \in \partial \mathbb{R}_+^d = \{(y', 0) \mid y' \in \mathbb{R}^{d-1}\} \simeq \mathbb{R}^{d-1}\). Prove
    \begin{align*}
      \int_{\partial \mathbb{R}_+^d} K(x,y) \, dS(y) = 1 \quad \forall x \in \mathbb{R}_+^d
    \end{align*}
  \end{ex}

  \begin{proof}[Solution]
    Denote \(x = (x', x_d)\), \(y = (y', 0)\), \(x', y' \in \mathbb{R}^{d-1}\), \(x_d > 0\).
    \begin{align*}
      \int_{\partial \mathbb{R}_+^d} K(x,y) \, dS(y) &= \int_{\mathbb{R}^{d-1}} \frac{2 x_d}{d |B_1|\left(|x'-y'|^2 + x_d^2\right)^{\frac{d}{2}}} \, dy' = \dots
    \end{align*}
    as \(|x-y| = |(x'-y', x_d)| = \sqrt{|x'-y'|^2 + x_d^2}\).
    \begin{align*}
      (y'-x' \mapsto y') \quad \dots &= \int_{\mathbb{R}^{d-1}} \frac{2 x_d}{d |B_1|\left(|y'|^2 + x_d^2\right)^{\frac{d}{2}}} \, dy' \\
      (y' = x_d z) \quad &= \int_{\mathbb{R}^{d-1}} \frac{2 x_d}{d |B_1| \left(x_d^2 (|z|^2 + 1)\right)^{\frac{d}{2}}} \left(x_d^{d-1}\right) \, dz \\
      &= \int_{\mathbb{R}^{d-1}} \frac{2}{d|B_1|\left(|z|^2 + 1\right)^{\frac{d}{2}}} \, dz \\
      &= \int_0^\infty \frac{2 \omega_{d-1}}{d|B_1|} \frac{1}{(r^2+1)^{\frac{d}{2}}} r^{d-2} \, dr \\
      &= \frac{2 \omega_{d-1}}{\omega_d} \int_0^\infty \frac{1}{\left(r^2+1\right)^{\frac{d}{2}}} r^{d-2} \, dr
    \end{align*}
    Set \(d = 2\): \(\omega_1 = 1, |\omega_2| = 2 \pi\) 
    \begin{align*}
      \frac{2}{\pi} \int_0^\infty \frac{1}{r^2+1} \, dr 
      &= \frac{2}{\pi} \int_0^{\frac{\pi}{2}} \frac{1}{(\tan t)^2 +1} [(\tan t)^2 +1] \, dt = 1
    \end{align*}
    we we set \(r = \tan t, t \in \left(0, \frac{\pi}{2}\right), \frac{dr}{dt} = (\tan t)' = 1 + (\tan t)^2\)
  \end{proof}
  For \(d = 3\):
  \begin{align*}
    \frac{2 \cdot 2 \pi}{4 \pi} \int_0^\infty \frac{1}{(r^2 + 1)^{\frac{3}{2}}} r \, dr
    &= \int_0^\infty \frac{d}{dr} \left[\frac{-1}{(r^2+1)^{\frac{1}{2}}}\right] \, dr = \left. \frac{-1}{(r^2 + 1)^{\frac{1}{2}}}\right]_0^\infty = 1
  \end{align*}

  \begin{ex}[7.3]
    Let \(g \in C(\partial \mathbb{R}_+^d) \cap L^\infty(\partial \mathbb{R}_+^d)\) (\(\partial \mathbb{R}_+^d \simeq \mathbb{R}^{d-1}\)).
    \begin{align*}
      u(x) &= \int_{\partial \mathbb{R}_+^d} K(x,y) g(y) \, dS(y)
      &K(x,y) &= \frac{2 x_d}{d |B_1| |x-y|^d}, x \in \mathbb{R}_+^d
    \end{align*}
    Prove that if \(g(y) = |y|\), if \(|y| \le 1\), then \(|\nabla u|\) is unbounded in \(B(0,r) \cap \mathbb{R}_+^d\) for all \(r > 0\).
  \end{ex}

  \begin{proof}[Solution]
    \begin{align*}
      \partial_{x_d} u(x) &= \int_{\partial \mathbb{R}_+^d} \partial x_d K(x,y) g(y) \, dy \quad \forall x \in \mathbb{R}_+^d \\
      &= \frac{2}{d |B_1|} \int_{\partial \mathbb{R}_+^d} \left[\frac{1}{|x-y|^d} - \frac{dx_d^2}{|x-y|^{d+2}}\right] g(y) \, dy \\
      &= \frac{2}{d |B_1|} \int_{\partial \mathbb{R}_+^d} \frac{1}{|x-y|^{d+2}} [|x-y|^2 - dx_d^2] g(y) \, dy \\
      &= \frac{2}{d|B_1|} \int_{\partial \mathbb{R}_+^d} \frac{1}{(|x'-y'|+x_d^2)^{\frac{d+2}{2}}} \left[|y'|^2 - (d-1) x_d^2\right] g(y) \, dy
    \end{align*}
    Assume that \(\partial_d u\) is bounded in \(B(0,r) \cap \mathbb{R}_+^d\) Then:
    \begin{align*}
      |u(0,x_d) - \underbrace{u(0,0)}_{g(0) = 0}| \le C |x_d|
    \end{align*}
    if \(x_d\) small. Consider:
    \begin{align*}
      \limsup_{x_d \to 0^+} \frac{u(0,x_d)}{x_d} 
      &= \limsup_{x_d \to 0^+} c \int_{\mathbb{R}^{d-1}} \frac{1}{(|y'|^2 + x_d^2)^{\frac{d}{2}}} g(y) \, dy' \\
      &\ge \int_{\mathbb{R}^{d-1}} \frac{1}{|y'|^d} g(y) \, dy 
      = \int_{|y'| \le 1} + \int_{|y'| > 1} \\
      &to \int_{\mathbb{R}^{d-1}} \frac{1}{|y'|^{d-1}} \, dy' = \infty \qedhere
    \end{align*}
  \end{proof}

  \begin{ex}[Bonus 7]
    Recall the Poisson kernel on a ball \(B(0,r) \subseteq \mathbb{R}^d\):
    \begin{align*}
      K(x,y) = \frac{r^2 - |x|^2}{d|B_1|r} \frac{1}{|x-y|^d}
    \end{align*}
    for all \(x \in B(0,r)\), \(y \in \partial B(0,r)\). Prove:
    \begin{align*}
      \int_{\partial B(0,r)} K(x,y) \, dS(y) = 1
    \end{align*}
    for all \(x \in B(0,r)\). (It suffices if you can prove \(d = 2\) and \(d = 3\))
  \end{ex}

  \section{Energy Method}

  Consider \(u \in C^2(\Omega)\) for \(\Omega \subseteq \mathbb{R}^d\) open, bounded and with \(C^1\) boundary and \begin{align*}
    \begin{cases}
      - \Delta u = f &\text{in } \Omega \\ u = g &\text{ on} \partial \Omega.
    \end{cases}
  \end{align*}
  Take \(\phi \in C_c^\infty(\Omega)\), then by integration by parts:
  \begin{align*}
    0 &= \int_\Omega(-\Delta u - f) \phi = \int_\Omega \nabla u \nabla \phi - \int_\Omega f \phi
  \end{align*}
  Key observation: This is the \emph{derivative} of the energy functional 
  \begin{align*}
    \epsilon(u) &= \frac{1}{2} \int_\Omega|\nabla u|^2 - \int_\Omega f u
  \end{align*}
  If \(u\) is a minimizer of \(\epsilon\), then it solves the equation \(-\Delta u = f\) in \(\Omega\). The boundary condition \(u = g\) does not appear on \(\epsilon\), but this is encoded in the set of \emph{admissible functions}. (The set of candidates of solutions). For the classical solutions, we have 
  
  \begin{thm}(Dirichlet's principle) Let \(\Omega \subseteq \mathbb{R}^d\) be open, bounded with \(C^1\)-boundary. Let \(f \in C(\bar \Omega)\) and \(g \in C(\partial B)\). Then the following statements are equivalent:
    \begin{enumerate}
        \item \(u \in C^2(\bar \Omega)\) solves \(\begin{cases}
          - \Delta u = f &\text{in } \Omega \\ u = g &\text{on } \partial \Omega
        \end{cases}\)
        \item \(u\) is a minimizer of the variational problem \(E = \inf_{\nu \in A} \epsilon(\nu)\), where \(\epsilon(\nu) = \frac{1}{2} \int_\Omega |\nabla \nu|^2 - \int_\Omega f \nu\), \(A = \{\nu \in C^2(\bar \Omega) \mid \nu = g \text{ on } \partial \Omega\}\).
    \end{enumerate}
    Moreover there is at most a solution / minimizer (uniqueness). 
  \end{thm}

  \begin{proof}
    The result holds even for complex-valued functions. Let us write the proof for real-valued functions.
    \begin{itemize}
      \item[1. \(\Rightarrow\) 2.:] Let \(u \in C^2(\bar \Omega)\) be a solution of \(\begin{cases}
        - \Delta u = f &\text{in } \Omega \\ u = g &\text{on } \partial \Omega
      \end{cases}\). Then we prove \(\epsilon(u) \le \epsilon(\nu)\) for all \(\nu \in A\). If \(\nu \in A\), then \(u - \nu = 0\) on \(\partial \Omega\). Using this and \(-\Delta u = f\) in \(\Omega\), we have:
      \begin{align*}
        0 
        &= \int_\Omega (-\Delta u - f)(u-v)  \\
        &= \int_\Omega \nabla u (\nabla u - \nabla \nu) - \int_\Omega f (u-v) \\
        &= \left[\frac{1}{2} \int_\Omega |\nabla u|^2 - \int_\Omega fu\right] - \left[\frac{1}{2} \int_\Omega |\nabla v|^2 - \int_\Omega f v\right] \\
        &\quad+ \frac{1}{2} \int_\Omega |\nabla u|^2 + \frac{1}{2} \int_\Omega  \\
        &= \epsilon(u) - \epsilon(v) + \frac{1}{2} \underbrace{\int_\Omega |\nabla u - \nabla v|^2}_{\ge 0}
      \end{align*}
    
      \(\epsilon(u) \le \epsilon(v)\), so \(u\) is a minimizer of \(\int_{v \in A} \epsilon(v)\). Moreover \(u\) is the unique minimizer on \(A\). Since \(\epsilon(u) = \epsilon(v)\) we have \(\int_\Omega|\nabla (u-v)^2 = 0\), so \(u-v = const.\), so \(u-v = 0\) in \(\bar \Omega\).

      \item[2. \(\Rightarrow\) 1.:] Assume that \(u\) is a minizer of \(\int_{v \in A} \epsilon(v)\). Then \(\epsilon(u) \le \epsilon(v)\) for all \(v \in A\). Take \(\phi \in C_c^\infty(\Omega)\), then \(u + t \phi \in A\) for all \(t \in \mathbb{R}\).
      \begin{enumerate}[label=\(\Rightarrow\)]
        \item \(\epsilon(u) \le \epsilon(u + t \phi)\) for all \(t \in \mathbb{R}\)
        \item \(t \mapsto \epsilon(u + t \phi)\) has a minimizer at \(t = 0\)
        \item \(\begin{aligned}[t]
          0 &= \frac{d}{dt} \epsilon(u + t \phi)|_{t = 0} = \frac{d}{dt} |_{t=0} \left(\frac{1}{2} \int_\Omega|\nabla u + t \nabla \phi|^2 - \int_{\Omega} f(u + t \phi)\right) \\
          &= \frac{d}{dt} |_{t=0} \left(\frac{1}{2} \int_\Omega |\nabla u|^2 + t^2 |\nabla \phi|^2 + 2 t \nabla u \nabla \phi - \int_{\Omega} f(u + t \phi)\right) \\
          &\int_\Omega \nabla u \nabla \phi - \int_\Omega f \phi = \int_\Omega (- \Delta u  f) \phi
        \end{aligned}\) \\
        for all \(\phi \in C_c^\infty(\Omega)\). So \(- \Delta u - f = 0\) in \(\Omega\) and \(u = g\) since \(u \in A\).
      \end{enumerate}
    \end{itemize}
    
    Direct method of calculus of variations. Think \(f: \mathbb{R} \to \mathbb{R}\), \(f \in C(\mathbb{R})\), \(f(x) \to \infty\) as \(|x| \to \infty\). There is a \(x_0 \in \mathbb{R}\) s.t. \(f(x_0) = \inf_{x \in\mathbb{R}} f(x)\).
    \begin{enumerate}[label=Step \arabic*:]
      \item \(E = \inf_{x \in \mathbb{R}} f(x) > - \infty\)
      \item Take a minizing sequence \(\{x_n\} \subseteq \mathbb{R}\), \(f(x_n) \to E\). Up to a subsequence \(x_n \to x_0\) in \(\mathbb{R}\) (compactness)
      \item Lower semicontinuity \(E = \liminf_{n \to \infty} f(x_n) \ge f(x_0)\)
    \end{enumerate}
    If we apply the direct method to \(\inf_{v \in A}E(v)\), 
    \begin{align*}
      E(v) = \frac{1}{2} \int_{\Omega} |\nabla v|^2 - \int_\Omega f v,
    \end{align*}
    \(A = \{v \in C^2(\bar \Omega), v=g \text{ on } \partial \Omega\}\)

    \begin{enumerate}[label=Step \arabic*:]
      \item Easy \(E = \int_{v \in A} E(v) > - \infty\)
      \item There is a minimizing sequence \(\{v_n\} \subseteq A\) s.t. \(E(v_n) \to E\). We don't know if there is a subsequence of \(\{v_n\}\) that converges to \(u \in A\). The lack of compactness is a serious problem! We need to find the rigt set \(A\)! Consider again \begin{align*}
        \begin{cases}
          - \Delta u = f & \text{in } \Omega \\ u = g &\text{on } \partial \Omega
        \end{cases}
      \end{align*}
      Consider the simple case \(g = 0\). 
      \(\Delta u -f \) in \(\Omega\) \(\Leftrightarrow\) \(\nabla u \nabla \phi\)...
      The right set \(A\) should be \(A = \{v \mid \int_\Omega |\nabla v|^2 < \infty, v = 0 \text{ on } \partial \Omega\}.\) Rigorously we take \(W_0^{1,2}(\Omega) = \overline{C_c^\infty(\Omega)}W^{1,2}(\Omega)\) (Notation: \(H_0^1 = W_0^{1,2}, H^1 = W^{1,2}\)) Recall that \(W^{1,p}\) is a banach space with norm \(\|f\|_{W^{1,p}(\Omega)} = \|f\|_{L^p(\Omega)} + \|\nabla f\|_{L^p(\Omega)}\). We know that \(C_c^\infty(\Omega)\) is dense in \(W_{loc}^{1,p}(\Omega)\), i.e. for all \(u \in W^{1,p}_{loc}(\Omega)\) there is \(\|u_n\| \subseteq C_c^\infty\) s.t. \(u_n \to u\) in \(W^{1,p}(K)\) for all \(K \subseteq \Omega\) compact. However in general \(C_c^\infty(\Omega)\) is not dense in \(W^{1,p}(\Omega)\), i.e. \(W_0^{1,p}(\Omega) = \overline{C_c^\infty(\Omega)}W^{1,p}(\Omega) \subseteq W^{1,p}(\Omega)\). Clearly \(W_0^{1,p}\) is a closed subspace of \(W^{1,p}(\Omega) \to W_0^{1,p}(\Omega)\)  is a Banach space with \(\|\cdot\|_{W^{1,p}(\Omega)}\). Why does \(W_0^{1,p}(\Omega)\) encode the \(0\)-boundary condition? Note that by definition for all \(u \in W_0^{1,p}(\Omega)\) there is a sequence \(\{u_n\} \subseteq C_c^\infty(\Omega)\), \(u_n \to u\) in \(W^{1,p}(\Omega)\) up to a subsequence \(u_n(x) \to u(x)\) for almost every \(x \in \Omega\). Note \(u_n|_{\partial \Omega} = 0 \nrightarrow u|_{\partial \Omega} = 0\) since \(\partial \Omega\) must be of 0-measure. \qedhere
    \end{enumerate}
  \end{proof}

  \begin{thm}
    Let \(\Omega\) be open, bounded with \(C^1\)-boundary. Let \(u \in W^{1,p}(\Omega)\cap C(\bar \Omega)\). Then the following statements are equivalent:
    \begin{enumerate}
      \item \(u = 0\) on \(\partial \Omega\)
      \item \(u \in W_0^{1,p}(\Omega)\)
    \end{enumerate}
    (Later we will remove the condition \(C(\bar \Omega)\) by introducing the \emph{Trace operator}.)
  \end{thm}


  \begin{proof}\
    \begin{itemize}
      \item [(a) \(\Rightarrow\) (b):]
      \begin{lem}
        If \(u \in W^{1,p}(\Omega)\) and \(\supp u \subseteq \Omega\), then \(u \in W_0^{1,p}(\Omega)\).
      \end{lem}
      \begin{proof}
        Since \(K \coloneqq \supp u\) is a compact subset in \(\Omega\), we can find a function \(\chi \in C_c^\infty(\Omega)\), \(\chi = 1\) on \(K\). Moreover since \(u \in W^{1,p}(\Omega)\), there is a sequence \(\{u_n\} \subseteq C_c^\infty(\Omega)\) s.t. \(u_n \to u\) in \(W_{loc}^{1,p}(\Omega)\). We claim that \(\chi u_n \to \chi u\) in \(W_{loc}^{1,p}(\Omega)\). (exercise, \(\nabla (\chi u) = \nabla \chi u + \chi \nabla u\)). This implies \(\chi u_n \to u\) in \(W^{1,p}(\supp \chi)\), thus \(\chi u_n \to u\) in \(W^{1,p}(\Omega)\), so \(u \in W_0^{1,p}(\Omega)\).
      \end{proof}
      Assume \(u \in W^{1,p}(\Omega) \cap C(\bar \Omega)\) and \(u = 0\) on \(\partial \Omega\). Take \(G \in C^1(\mathbb{R})\) s.t. \(|G(t) \le t\) for all \(t\), \(G(t) = t\) if \(t \ge 2\) and \(G(t) = 0\) if \(t \le 1\). Then
        \begin{align*}
          u_n(x) &= \frac{1}{n} G(n u(x)) \in W^{1,p}(\Omega) \\
          \text{(Chain-rule)} \quad \nabla u_n(x) &= \frac{1}{n} G'(nu(x)) n \nabla u(x) = G'(n u(x)) \nabla u(x)
        \end{align*}
        Moreover, \(u_n\) is compactly supported in \(\Omega\), so \(u_n \in W_0^{1,p}(\Omega)\) by the lemma and \(u_n \to u\) in \(W^{1,p}(\Omega)\), so \(u \in W_0^{1,p}(\Omega)\) since \(W_0^{1,p}\) is a closed space. Recall that \(u \in C(\bar \Omega)\) and \(u = 0\) on \(\partial \Omega\). Thus for all \(\epsilon > 0\) there is a compact \(K_\epsilon \subseteq \Omega\) s.t. \(\sup_{x \in \Omega \setminus K_\epsilon} |u(x)| \le \epsilon\). For any given \(n \in \mathbb{N}\), \(u_n(x) \ne 0\), so \(G(nu(x)) \ne 0\). This implies \(n|u(x)| > 1\), hence \(|u(x)| > \frac{1}{n}\). Thus \(u_n(x) = 0\) for all \(x\) such that \(|u(x)| \le \frac{1}{n}\), so \(\supp u_n \subseteq K_{\frac{1}{n}}\) compact in \(\Omega\). Next, let us check \(u_n \to u\) in \(W^{1,p}(\Omega)\).
        \begin{align*}
          \int_\Omega |u_n(x) - u(x)|^p \, dx \to 0
        \end{align*}
        since \(u_n(x) = \frac{1}{n} G(nu(x)) \xrightarrow{n \to \infty} u(x)\) for all \(x \in \Omega\) and \(|u_n(x)| \le \frac{1}{n} |G(nu(x))| \le \frac{1}{n} |nu(x)| \le |u(x)| \in L^p(\Omega)\).
        \begin{align*}
          \int_\Omega|\nabla u_n(x) - \nabla u(x)|^p \, dx 
          &= \int_\Omega |G'(nu(x)) - 1|^p |\nabla u(x)|^p \, dx \to 0
        \end{align*}
        as \(|G'(nu(x))-1| \to 0\) for all \(x\) s.t. \(u(x) \ne 0\) and \(\nabla u(x) = 0\) on \(\{x \mid u(x) = 0\}\).  (exercise)
    \end{itemize}
    \item [(b) \(\Rightarrow\) (a):] Let \(u \in W^{1,p}(\Omega) \cap C(\bar \Omega)\) and \(u \in W_0^{1,p}(\Omega)\). Then we prove \(u = 0\) on \(\partial \Omega\). Lets regard the case \(\Omega = Q_+ = \{(x',x_d) \mid \mathbb{R}^{d-1} \times \mathbb{R} \mid |x'|<1, 0 < x_d < 1\}\). 
    We prove that if \(u \in W_0^{1,p} \)
    \((Q_+) \cap C(\overline {Q_+)}\), then \(u = 0\) on \(Q_0 = \{(x', 0) \mid x' \in \mathbb{R}^{d-1}, |x'| < 1\}\). Since \(u \in W_0^{1,p}(Q_+)\) there is \(\{u_n\} \subseteq C_c^\infty(Q_+)\) s.t. \(u_n \to u\) in \(W^{1,p}(Q_+)\) for all \(x = (x', x_d) \in Q_+\), then:
    \begin{align*}
      u_n(x', x_d) = \underbrace{u_n(x', 0)}_{= 0} + \int_0^{x_d} \partial_d u_n(x', t) \, dt
    \end{align*}
    Hence 
    \begin{align*}
      |u_n(x', x_d)| &\le \int_0^{x_d} |\partial_d u_n(x', t) \, dt
    \end{align*}
    This implies:
    \begin{align*}
      &\int_{0 < x_d < \epsilon} \int_{|x'| \le 1} |u_n(x', x_d)| \, dx' \, dx_d \\
      &\quad \le \int_{0 < x_d < \epsilon} \int_{|x'| < 1} \left(\int_0^{x_d}|\partial_d u_n(x', t)| \, dt\right) \, dx' \, dx_d \\
      &\quad \le \epsilon \int_{|x'| < 1} \int_0^\epsilon |\partial_d u_n(x', t)| \, dx' \, dt
    \end{align*}
    \begin{align*}
      \Rightarrow \frac{1}{\epsilon} \int_0^\epsilon \int_{|x'| \le 1} |u_n(x', x_d)| \, dx' \, dx_d 
      &\le \int_0^\epsilon \int_{|x'| < 1} |\partial_d u_n(x', x_d)| \, dx' \, dx_d
    \end{align*}
    for all \(n \in \mathbb{N}\), \(\epsilon > 0\). Take now \(n \to \infty\), use \(u_n \to u\) in \(W^{1,p}(\Omega)\). Then:
    \begin{align*}
      \frac{1}{\epsilon} \int_0^\epsilon \int_{|x'| \le 1} |u(x', x_d)| \, dx' \, dx_d
      &\le \int_0^\epsilon \int_{|x'| < 1} |\partial_x u_n(x', x_d)| \, dx' \, dy
    \end{align*}
    for all \(\epsilon > 0\). Take \(\epsilon \to 0\):
    \begin{align*}
      \int_{|x'| \le 1} |u(x', 0)| \, dx' \le 0
    \end{align*}
    here we use \(u \in C(\bar \Omega)\) for the left side and Dominated Convergence for the right side. Thus \(u(x', 0) = 0\) for all \(|x'| \le 1\), i.e. \(u = 0\) on \(\partial \Omega\). Let's regard the general case: Let \(\Omega\) be open, bounded and with \(C^1\)-boundary. Lets define \emph{local charts} By definition for all \(x \in \partial \Omega\), there is a \(U_x\) open, such there is a bijecitve map \(h: U_x \to Q\), and \(h, h^{-1}\) are \(C^1\). Then clearly \(\partial \Omega \subseteq \bigcup_{x \in \partial \Omega} U_x\). Since \(\partial \Omega\) is compact, there is a finite subcover \(\{U_i\}_{i=1}^N\) s.t. \(\partial \Omega \subseteq \bigcup_{i=1}^N U_i\). We can find \(U_0\) open s.t. \(\bar U_0 \subseteq \Omega\) and \(\Omega \subseteq \bigcup_{i=0}^N U_i\).

    \begin{lem}
      There is a sequence \(\{x_i\}_{i=0}^N \subseteq C^\infty(\mathbb{R}^d)\) s.t.
      \begin{enumerate}
        \item \(\chi_i \ge 0\), \(\sum_{i=0}^N \chi_i = 1\) in \(\mathbb{R}^d\) (\(\{\chi_i\}\) is a partition of unity)
        \item For all \(i=1, \dots, N\), \(\supp \chi_i\) is in \(U_i\), i.e. \(\chi_i \in C_c^\infty(U_i)\).
        \item \(i=0\), \(\supp \chi_0 \subseteq \mathbb{R}^d \setminus \partial \Omega\) and \(\chi_0 \setminus \Omega \in C_c^\infty(\Omega)\). (exercise)
      \end{enumerate}
      Given \(u \in W_0^{1,p}(\Omega) \cap C(\bar \Omega)\). Then \(u = \sum_{i=0}^N \chi_i u\), where \(\chi_i \ge 0\), \(\chi_0 \in C_c^\infty(\Omega)\), \(\chi_i \in C_c^\infty(U_i)\). Since \(\chi_0 u\) is supported in a copact set inside \(\Omega\), \(\chi_0 u = 0\) on \(\partial \Omega\). It remains to show that for all \(i=1, \dots, N\), \(\chi_i u = 0\) on \(U_i \cap \partial \Omega\). Then \(\chi_i u(h^{-1}x) \in W_0^{1,p}(Q) \cap C(\bar \Omega)\). This implies \(\chi_i u (h^{-1}x) = 0\) on \(Q_0\), so \(\chi_i u(x) = 0\) on \(U_i \cap \partial \Omega\). 
      Why \(W_0^{1,p}(U_i \cap \Omega) \to W_0^{1,p}(Q_+)\). If \(v \in W_0^{1,p}(U_i \cap \Omega)\), then \(v_n \to v, v_n \in C_c^\infty\). \(v_n \circ h^{-1} \to v \circ h^{-1} \Rightarrow v \circ h^{-1} \in W_0^{1,p}(Q_+)\)
    \end{lem}
  \end{proof}

  \begin{ex}[E 8.1]
    Let \(u \in W_{loc}^{1,1}(\mathbb{R}^d)\). Let \(B = u^{-1}(\{0\})\). Prove that \(\nabla u(x) = 0\) for a.e. \(x \in B\). 
  \end{ex}

  \begin{proof}[Solution]
    We have already seen that if \(f, g \in W_{loc}^{1,1}(\mathbb{R}^d)\), then \(\max(f,g) \in W_{loc}^{1,1}\). This implies that if \(u = u^+ - u^- \in W^{1,1}_{loc}\), then \(u^+, v^+ \in W_{loc}^{1,1}\) since \(u^+ = \max(u, 0)\) and \(u^- = \max(-u, 0)\). We have that \(\nabla u = \nabla u^+ - \nabla u^-\). Claim:
    \begin{align*}
      \nabla u^+ = \begin{cases}
        0 & u(x) \le 0 \\ \nabla u & u(x) > 0
      \end{cases} \quad 
      \nabla u^- = \begin{cases}
        0 & u(x) \ge 0 \\ \nabla u & u(x) < 0
      \end{cases}
    \end{align*}    
    \begin{align*}
      \int_{\mathbb{R}^d} (\partial_i u^+) \phi 
      &= - \int_{\mathbb{R}^d} u^+ \partial_i \phi 
      = -\int_{\{u(x) \le 0\}} 0 \partial_i \phi - \int_{\{u(x) > 0\}} u \partial_i \phi \\
      &= \int_{\{u(x) \le 0\}}0 \phi + \int_{\{u(x) > 0\}} \partial_i u \phi
    \end{align*}
    Alternative way: We showed for \(f \in W^{1,p}(\mathbb{R}^d)\), that 
    \begin{align*}
      \nabla |f|(x) &= \begin{cases}
        (\nabla f)(x) &f(x) > 0 \\ - (\nabla f)(x) & f(x) < 0 \\ 0 & f(x) = 0
      \end{cases}
    \end{align*}
    \(u_+ = \frac{1}{2}(u + |u|)\). Hence \(\nabla u_+ = \frac{1}{2}(\nabla u + \nabla |u|)\).
    Remark: If \(A \subseteq \mathbb{R}\) has measure zero, then \(\nabla u 1 _{\{u(x) \in A\}} = 0\) a.e. (Th. 6.19 Lieb-Loss Analysis)
  \end{proof}

  \begin{ex}[E 8.2]
    Let \(\Omega, U \subseteq \mathbb{R}^d\) be open, \(U \cap \Omega \ne \emptyset\), \(u \in W_0^{1,p}(\Omega)\), \(1 \le p < \infty\), \(\chi \in C_c^\infty(U)\). Prove: \(\chi u \in W_0^{1,p}(\Omega \cap U)\)
    Hint: Recall \(W_0^{1,p}(\Omega) = \overline{C_c^\infty(\Omega)}^{\|\cdot\|_{W^{1,p}}}\)
  \end{ex}

  \begin{proof}[Solution]
    By definition there is a sequence \((u_n)_{n \in \mathbb{N}} \subseteq C_c^\infty(\Omega)\) s.t. \(u_n \xrightarrow[n \to \infty]{\|\cdot\|_{W^{1,p}}} u\) , i.e.
    \begin{align*}
      \|u_n - u\|_p + \|\nabla u_n - \nabla u \|_{p} \xrightarrow{n \to \infty} 0.
    \end{align*}
    Define \(f_n: \mathbb{R}^d \to \mathbb{C}\), \(f_n(x) \coloneqq u_n(x) \chi(x)\). Note \(f_n \in C_c^\infty (\Omega \cap U)\) for all \(n \in \mathbb{N}\). Claim: \((f_n)_{n \in \mathbb{N}}\) is Cauchy with respect to \(\|\cdot \|_{W^{1,p}}\). Proof: 
    \begin{align*}
      \|f_n - f_m\|_p = \|\chi(u_n - u_m)\|_p \le \|\chi\|_\infty \underbrace{\|u_n - u_m\|_p}_{\xrightarrow{n,m \to \infty} 0} \xrightarrow{n,m \to \infty} 0 
    \end{align*}
    \(\nabla f_n = \nabla (\chi u_n) = (\nabla \chi) u_n + \chi \nabla u_n\)
    \begin{align*}
      \|\nabla f_n - \nabla f_m\|_p 
      &\le \|\nabla \chi(u_n - u_m)\|_p + \|\chi(\nabla u_n - \nabla u_m)\|_p \\
      &\le \|\nabla \chi\|_\infty \underbrace{\|u_n - u_m\|_p}_{\xrightarrow{n,m \to \infty} 0} + \underbrace{\|\chi\|}_{< \infty} \underbrace{\|\nabla u_n - \nabla u_m\|_p}_{\xrightarrow{n,m \to \infty}0}\xrightarrow{n,m \to \infty)} 0
    \end{align*}
    Thus, there is a \(f \in W_0^{1,p}(\Omega \cap U)\) s.t. \(\|f_n - f\|_{W^{1,p}} \xrightarrow{n \to \infty} 0\). We know:
    \begin{align*}
      \|f_n - \chi u\|_{L^p} &= \|\chi u_n - \chi u\|_p \\
      &\le \|\chi\|_\infty \underbrace{\|u_n - u\|_p}_{\to 0} \xrightarrow{n \to \infty} 0
    \end{align*}
    Since limits in \(L^p\) are unique, we get \(\chi u = f \in W_0^{1,p}(\Omega \cup U)\).
  \end{proof}

  \begin{ex}[E 8.3]
    Let \(\Omega, U \subseteq \mathbb{R}^d\) open and bounded, \(h: \bar U \to \bar \Omega\) \(C^1\)-diffeomorphisms, \(u \in W_0^{1,p}(\Omega)\), \(1 \le p < \infty\). Prove (\(x \mapsto u(h(x)) \in W_0^{1,p}(U)\).
  \end{ex}
  
  \begin{proof}[Solution]
    Since \(u \in W_0^{1,p}(\Omega)\) there is a sequence \((u_n)_{n \in \mathbb{N}} \subseteq C_c^\infty(\Omega)\) s.t. \begin{align*}
      \|u - u_n\|_p + \|\nabla u - \nabla u_n\|_p \xrightarrow{n \to \infty} 0
    \end{align*}
    Define for all \(n \in \mathbb{N}\) \(f_n: U \to \mathbb{C}\), \(f_n(x) = u_n(h(x))\). Note \(f_n \in C_c^1(U)\).
    Claim 1: \((f_n)_{n \in \mathbb{N}}\) is Cauchy wrt. \(\|\cdot\|_{W^{1,p}}\). \begin{align*}
      \|f_n - f_m\|_p^p &= \int_U |u_n(h(x)) - u_m(h(x))|^p \, dx \\
      &= \int_\Omega |u_n(y) - u_m(y)|^p \, dy \underbrace{|\det(Dh^{-1})(y)|}_{\le C < \infty} \xrightarrow{n,m \to \infty} 0 \\
      (\nabla f_n)(x) &= \nabla (u_n(h(x))) = (\nabla u_n) (h(x)) (Dh)(x)
    \end{align*}
    \begin{align*}
      \|\nabla f_n - \nabla f_m\|_p^p &= \int_U \left|\left[(\nabla u_n)(h(x)) - (\nabla u_m)(h(x))\right]\smash{\underbrace{(Dh)(x)}_{bdd.}}\right|^p \, dx \\
      &\le C \int_U \left| (\nabla u_n)(h(x)) - (\nabla u_m)(h(x)) \right|^p \, dx \\
      &= C \int_\Omega \left|(\nabla u_n)(y) - (\nabla u_m)(y)\right|^p \underbrace{|\det Dh^{-1}(y)|}_{\le \tilde C} \, dx
      \xrightarrow{n,m \to 0}0
    \end{align*}
    Claim 2: \(\|f_n - u \circ h\|_p \xrightarrow{n \to \infty} 0\).
    \begin{align*}
      \|f_n - u\circ h\|_p 
      &= \int_U |u_n(h(x)) - u(h(x))|^p \, dx \\
      &= \int_\Omega |u_n(y)- u(y)|^p \underbrace{|\det Dh^{-1}(y)|}_{\le C}\, dy \xrightarrow{n \to \infty} 0
    \end{align*}
    Conclusion: Since \((f_n)_{n \in \mathbb{N}} \subseteq C_c^1(U)\) is Cauchy with respect to \(\|\cdot\|_{W^{1,p}}\), there is a \(f \in W_0^{1,p}(U)\) s.t. \(f_n \smash{\xrightarrow[\|\cdot\|_{W^{1,p}}]{n \to \infty}f}\). Since limits in \(L^p\) are unique by claim 2 we get \(u \circ h = f \in W_0^{1,p}(U)\).
  \end{proof}

  \begin{ex}[E 8.4]
    Let \(\Gamma \subseteq \mathbb{R}^d\) be compact, \(\{U_i\}_{i=1}^N\) open s.t. \(\Gamma \subseteq \bigcup_{i=1}^N U\). Prove: There exists \(\{\chi_i\}_{i=0}^N \subseteq C^\infty(\mathbb{R}^d)\) s.t. \begin{enumerate}
      \item \(\chi_i \ge 0\) for all \(i\), \(\sum_{i=0}^N \chi_i = 1\) 
      \item \(\supp(\chi_i) \subseteq U_i\) for all \(i \in \{1, \dots, N\}\)
      \item \(\supp(\chi_0) \subseteq \mathbb{R}^d \setminus \Gamma\)
    \end{enumerate}
  \end{ex}

  \begin{proof}
    WLOG assume that \(U_i \ne \emptyset\) for all \(i\). If \(\Gamma \ne 0\), then \(\chi_0 = 1\) does the job. Now suppose \(\Gamma \ne \emptyset\). Let \(\psi \in C_c^\infty(B_1(0))\), \(\psi \ge 0\), \(\int \psi = 1\), \(\psi|_{B_{\frac{1}{2}}(0)} > 0\) and for \(\epsilon > 0\) let \(\psi_\epsilon(x) = \frac{1}{\epsilon^d} \psi \left(\frac{x}{\epsilon}\right)\), so \(\int \psi_\epsilon = 1\). Define \begin{align*}
      \tilde d \coloneqq \sup \{\tilde{\tilde d} > 0 \mid \forall x \in \Gamma \exists i \in \{1, \dots, N\} s.t. \dist(x, U_i^c) \ge \tilde{\tilde d}\}
    \end{align*}
    Claim 1: \(\tilde d  > 0\) Suppose this was not true. Then there is a sequence \((x_n)_{n \in \mathbb{N}} \subseteq \Gamma\) s.t. for all \(i \in \{1, \dots, N\}\), 
    \begin{align*}
      \dist(x_n, U_i^c) < \frac{1}{n}
    \end{align*}
    Since \(\Gamma\) is compact, there is a subsequence, which we call \(x_n\) again, s.t. \(x_n \xrightarrow{n \to \infty} \bar x\) for asome \(\Gamma\). By \(\Gamma \subseteq \bigcup_{i=1}^N U_i\) there is a \(\epsilon_{\bar x} > 0\) and \(i \in \{1, \dots, N\}\) s.t. \(B_{\epsilon_{\bar x}}(\bar x) \subseteq U_i\ \lightning\).
    Define \(d \coloneqq \min\{\tilde d, 1\} > 0\). For all \(\epsilon > 0\), for all \(A \subseteq \mathbb{R}^d\): \((A)_\epsilon \coloneqq \{x \in A \mid \dist(x, A^c) \ge \epsilon\}\). for every \(i \in \{1, \dots, N\}\) define \(\phi_i: U_i \to [0,\infty)\) by
    \begin{align*}
      \phi_i(x) \coloneqq \mathbb{1}_{(U_i \cap B_R(0))_{\frac{d}{4}}} \star \phi_{\frac{d}{4}}
    \end{align*}
    Note \(\phi_i \in C_c^\infty(U_i)\) and \((U_i \cap B_R(0))_{\frac{d}{4}} \subseteq (\supp(\phi_i))^0\). Define \(\phi_0: \mathbb{R}^d \setminus \Gamma \to [0, \infty)\) by \(\phi_0(x) = \mathbb{1}_{(\mathbb{R}^1 \setminus \Gamma)_{\frac{d}{4}}} \star \psi_{\frac{d}{4}}\). Again, \(\phi_0 \in C^\infty(\mathbb{R}^d \setminus \Gamma)\), \(\supp(\phi_0))^0 \supseteq (\mathbb{R}^d \setminus \Gamma)_{\frac{d}{4}}\), \(\supp(\phi_0) \subseteq \mathbb{R}^d \setminus \Gamma\). 
    Claim 2: For all \(x \in \mathbb{R}^d\) there is a \(i \in \{0, 1, \dots, N\}: \phi_i (x) > 0\). Proof: By construction, we know for \(i \in \{1, \dots, N\}\) that \(\phi_i\) is \(>0\) on \((U_i \cap B_R(0))_{\frac{d}{4}}\). Moreover \(\phi_0 > 0\) on \((\mathbb{R}^d \setminus \Gamma)_{\frac{d}{4}}\). thus, we are done if we can show taht \(\bigcup_{i=1}^N (U_i \cap B_R(0))_{\frac{d}{4}} \cup (\mathbb{R}^d \setminus \Gamma)_{\frac{d}{4}} = \mathbb{R}^d\). Suppose there is a \(x \in \mathbb{R}^d \setminus A\). Then \(\dist(x, \Gamma) < \frac{d}{4}\). Since \(\Gamma \subseteq B_{\frac{R}{2}}(0)\) and \(R > 2\) and \(d \le 1\).
    \begin{align*}
      |x-0|
      &\le \dist(x, \Gamma) + \frac{R}{2}
      < \frac{d}{4} + \frac{R}{2} = R - \frac{d}{4} - \frac{R}{2} + \frac{d}{2} < R - \frac{d}{4} - \frac{2}{2} + \frac{1}{2} < R - \frac{d}{4}
    \end{align*}
    Thus \(x \in (B_R(c))_{\frac{d}{4}}\). Thus, we are done if we can show that \(x \in (U_i)_{\frac{d}{4}}\) for some \(i \in \{1, \dots, N\}\). Since \(\dist(x, \Gamma) < \frac{d}{4}\), there is a \(y \in \Gamma\) s.t. \(|x-y| < \frac{d}{4}\). By definition of \(\tilde d\) there is a \(i \in \{1, \dots, N\}\) s.t. \(\dist(y, U_i^c) \ge \tilde d \ge d\), i.e. for all \(z \in U_i^c\) we have \(|y-z| \ge d\). We get 
    \begin{align*}
      |x-z| \ge |\underbrace{|x-y|}_{< \frac{d}{4}}-\underbrace{|y-z|}_{\ge d}| \ge \frac{3d}{4} < \frac{d}{4}
    \end{align*}
    This implies \(\dist(x, U_i^c) > \frac{d}{4}\), so \(x \in (U_i)_{\frac{d}{4}}\) \(\lightning\).
    Define for all \(i \in \{0, \dots, N\}: \chi_i: \mathbb{R}^d \to [0, \infty)\) by 
    \begin{align*}
      \chi_i(x) &= \frac{\phi_i(x)}{\sum_{j=0}^N \phi_j(x)}
    \end{align*}
    \(\chi_i\) is well-defined by Claim 2 and \(\chi_i \in C^\infty(\mathbb{R}^d)\). Also note that \(\sum \chi_i = 1\), \(\chi_i \ge 0\), which implies 1. Furthermore, since \(\supp(\phi_i) \subseteq U_i\), we have \(\supp(\chi_i) \subseteq U_i\) for all \(i \in \{1, \dots, N\}\), which implies 2. Finally, since \(\supp(\phi_0) \subseteq \mathbb{R}^d \setminus \Gamma\), we get \(\supp(\chi_0) \subseteq \mathbb{R}^d \setminus \Gamma\). This implies 3.
  \end{proof}
\end{document}